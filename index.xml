<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>&lt;b&gt;Home&lt;/b&gt;</title>
<link>https://vuqv.github.io/</link>
<atom:link href="https://vuqv.github.io/index.xml" rel="self" type="application/rss+xml"/>
<description>My blog</description>
<generator>quarto-1.5.54</generator>
<lastBuildDate>Sat, 14 Oct 2023 00:00:00 GMT</lastBuildDate>
<item>
  <title>Download Protein Ensemble Database entries</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/2023/October/download_PED_entries.html</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The Protein Ensemble Database (PED) is a freely accessible repository designed for the submission of structural collections, which include intrinsically disordered proteins (IDPs). PED contains manually curated records of structural collections measured through techniques such as nuclear magnetic resonance spectroscopy, small-angle X-ray scattering, and fluorescence resonance energy transfer. These structural coordinates can be utilized to assess these collections, thereby aiding the development of novel modeling approaches aimed at enhancing our ability to establish links between the inherent “absence of a fixed structure” in IDPs and their functions. Each PED entry corresponds to the primary experimental data and the structural collections associated with these datasets.</p>
</section>
<section id="download-entry-file-as-tar.gz" class="level1">
<h1>Download Entry file as <code>tar.gz</code></h1>
<p><u><b> Note:</b></u> The following code works with the new version of PED. For the old version, please refer to this page: <a href="https://old.proteinensemble.org/help" target="_blank">https://old.proteinensemble.org/help</a></p>
<p>PED provides many ensembles of various proteins. We can write a simple code to automatically download <code>tar.gz</code> file then extract them for analysis.</p>
<div id="060de98b" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for extracting, moving and so on</span></span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tarfile</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pathlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Path</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> shutil</span></code></pre></div>
</div>
<div id="dd6086c5" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> download_entry(PEDID):</span>
<span id="cb2-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Download structural ensemble data for a given Protein Ensemble Database (PED) entry.</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Parameters:</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    - PEDID (int): The unique identifier of the PED entry to download.</span></span>
<span id="cb2-7"></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Returns:</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    - None</span></span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This function fetches and downloads structural ensemble data for a specific PED entry</span></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    identified by its unique PEDID. It connects to the PED API to retrieve information</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    about the entry and its associated ensembles, then downloads the corresponding</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    structural data in the form of compressed tar.gz files.</span></span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Example Usage:</span></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    download_entry(123)  # Downloads structural ensemble data for PED entry 123.</span></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb2-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the PED entry ID with leading zeros (e.g., PED00001)</span></span>
<span id="cb2-20">    ped_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"PED</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>PEDID<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:05d}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-21">    </span>
<span id="cb2-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check and create the 'single' and 'multiple' folders if they don't exist</span></span>
<span id="cb2-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> os.path.exists(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'single'</span>):</span>
<span id="cb2-24">        os.makedirs(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'single'</span>)</span>
<span id="cb2-25">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> os.path.exists(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'multiple'</span>):</span>
<span id="cb2-26">        os.makedirs(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'multiple'</span>)</span>
<span id="cb2-27"></span>
<span id="cb2-28">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construct the URL for fetching PED entry information</span></span>
<span id="cb2-29">    url <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://deposition.proteinensemble.org/api/v1/entries/"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ped_id</span>
<span id="cb2-30"></span>
<span id="cb2-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Send a GET request to the PED API</span></span>
<span id="cb2-32">    res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(url)</span>
<span id="cb2-33"></span>
<span id="cb2-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check the response status code</span></span>
<span id="cb2-35">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> res.status_code <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>:</span>
<span id="cb2-36">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parse the response as JSON</span></span>
<span id="cb2-37">        res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> res.json()</span>
<span id="cb2-38"></span>
<span id="cb2-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the PED entry ID and its title/description</span></span>
<span id="cb2-40">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(ped_id)</span>
<span id="cb2-41">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(res[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'description'</span>].get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'title'</span>))</span>
<span id="cb2-42"></span>
<span id="cb2-43">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Determine the folder to save the downloaded files</span></span>
<span id="cb2-44">        n_constructs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(res[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'construct_chains'</span>])</span>
<span id="cb2-45">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> n_constructs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb2-46">            folder <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'single/'</span></span>
<span id="cb2-47">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb2-48">            folder <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'multiple/'</span></span>
<span id="cb2-49"></span>
<span id="cb2-50">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract ensemble IDs</span></span>
<span id="cb2-51">        ensembles_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [ensemble[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ensemble_id"</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> ensemble <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> res[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ensembles"</span>]]</span>
<span id="cb2-52"></span>
<span id="cb2-53">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the ensemble IDs</span></span>
<span id="cb2-54">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(ensembles_ids)</span>
<span id="cb2-55"></span>
<span id="cb2-56">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the base download link template</span></span>
<span id="cb2-57">        download_link <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://deposition.proteinensemble.org/api/v1/entries/ENTRYID/ensembles/ENSID/ensemble-pdb?response_format=json&amp;only_features=true"</span></span>
<span id="cb2-58"></span>
<span id="cb2-59">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate through ensemble IDs and download each ensemble's data</span></span>
<span id="cb2-60">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> ensemble_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ensembles_ids:</span>
<span id="cb2-61">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace placeholders in the download link with actual PED and ensemble IDs</span></span>
<span id="cb2-62">            u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> download_link.replace(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ENTRYID'</span>, ped_id)</span>
<span id="cb2-63">            u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> u.replace(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ENSID"</span>, ensemble_id)</span>
<span id="cb2-64"></span>
<span id="cb2-65">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Download the ensemble data and save it as a tar.gz file</span></span>
<span id="cb2-66">            res_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(u)</span>
<span id="cb2-67">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>folder<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}{</span>ped_id<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}{</span>ensemble_id<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.tar.gz"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wb"</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb2-68">                f.write(res_file.content)</span>
<span id="cb2-69"></span>
<span id="cb2-70">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> res.status_code <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">404</span>:</span>
<span id="cb2-71">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle the case where the PED entry does not exist</span></span>
<span id="cb2-72">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ped_id<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> does not exist in the database."</span>)</span></code></pre></div>
</div>
<p>In this function, we will download and handle two cases: 1) entry contains single chain <code>n_constructs = 1</code> and 2) entry contains multiple chains <code>n_constructs &gt; 1</code> (which we will separate them later).</p>
<p>Each type of entry will be saved in separate folder: <code>single</code> and <code>multiple</code> - we first check if folder exists, if not we will create them.</p>
<div id="6f4f1702" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># in case of missing something, can run download function one by one</span></span>
<span id="cb3-2">download_entry(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">226</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PED00226
N-terminal domain of dimeric eIF4G1 (1-249) from S. cerevisieae
['e001']</code></pre>
</div>
</div>
</section>
<section id="extract-tar-file" class="level1">
<h1>Extract TAR file</h1>
<p>Now, extract tar file and change the filename, move to proper folders …</p>
<div id="400fd8c1" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> extract_and_move_files(input_path, output_path):</span>
<span id="cb5-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Extract and move files from tar.gz archives or a folder containing tar.gz archives.</span></span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Parameters:</span></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    - input_path (str): The path to the tar.gz file or folder containing tar.gz archives.</span></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    - output_path (str): The path where extracted files will be moved.</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Returns:</span></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    - None</span></span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This function iterates through tar.gz files in the specified input path or folder, extracts their contents,</span></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    and moves the extracted files to the specified output path with appropriate naming.</span></span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Example Usage:</span></span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    extract_and_move_files('input.tar.gz', 'output_folder/')</span></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    extract_and_move_files('archive_folder/', 'output_folder/')</span></span>
<span id="cb5-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb5-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> os.path.isfile(input_path) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> input_path.endswith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".tar.gz"</span>):</span>
<span id="cb5-20">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle the case where the input path is a tar.gz file</span></span>
<span id="cb5-21">        entry_ensemble_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.splitext(os.path.basename(input_path))[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb5-22">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> tarfile.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(input_path, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> tf:</span>
<span id="cb5-23">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Input tar file: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>input_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, pdb files in this archive file: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>getnames()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-24">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract all files</span></span>
<span id="cb5-25">            tf.extractall(path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>output_path)</span>
<span id="cb5-26">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Move extracted file to a filename of PED_ENTRY+.pdb</span></span>
<span id="cb5-27">            src <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.join(output_path, tf.getnames()[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb5-28">            dst <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.join(output_path, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>entry_ensemble_name[:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.pdb'</span>)</span>
<span id="cb5-29">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"source file: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>src<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, destination file: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dst<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-30">            shutil.move(src, dst)</span>
<span id="cb5-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> os.path.isdir(input_path):</span>
<span id="cb5-32">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle the case where the input path is a folder containing tar.gz files</span></span>
<span id="cb5-33">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> tar_file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> os.listdir(input_path):</span>
<span id="cb5-34">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> tar_file.endswith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".tar.gz"</span>):</span>
<span id="cb5-35">                entry_ensemble_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tar_file.rsplit(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'.'</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb5-36">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> tarfile.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(os.path.join(input_path, tar_file), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> tf:</span>
<span id="cb5-37">                    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Input tar file: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tar_file<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, pdb files in this archive file: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>getnames()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-38">                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract all files</span></span>
<span id="cb5-39">                    tf.extractall(path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>output_path)</span>
<span id="cb5-40">                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Move extracted file to a filename of PED_ENTRY+.pdb</span></span>
<span id="cb5-41">                    src <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.join(output_path, tf.getnames()[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb5-42">                    dst <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.join(output_path, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>entry_ensemble_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.pdb'</span>)</span>
<span id="cb5-43">                    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"source file: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>src<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, destination file: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dst<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-44">                    shutil.move(src, dst)</span>
<span id="cb5-45">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb5-46">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Invalid input_path. Please provide a valid path to a tar.gz file or a folder containing tar.gz archives."</span>)</span></code></pre></div>
</div>
<p>Here, we use <code>shutil.move</code> function to rename ensemble because some entries has ensemble name in <code>tar.gz</code> and the actual ensemble name are different (e.g <code>PED00216</code> which <code>tar.gz</code> file is <code>e001</code> but pdb is named <code>e000</code>, many other entries have pdb file is just <code>pdbfile.pdb</code>).</p>
<div id="7c7d94f2" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example Usage:</span></span>
<span id="cb6-2">extract_and_move_files(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'single'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pdb_single/'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Input tar file: PED00001e003.tar.gz, pdb files in this archive file: ['PED00001e003.pdb']
source file: pdb_single/PED00001e003.pdb, destination file: pdb_single/PED00001e003.pdb
Input tar file: PED00001e002.tar.gz, pdb files in this archive file: ['PED00001e002.pdb']
source file: pdb_single/PED00001e002.pdb, destination file: pdb_single/PED00001e002.pdb
Input tar file: PED00001e001.tar.gz, pdb files in this archive file: ['PED00001e001.pdb']
source file: pdb_single/PED00001e001.pdb, destination file: pdb_single/PED00001e001.pdb</code></pre>
</div>
</div>
<div id="43eb7316" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">extract_and_move_files(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'single/PED00001e003.tar.gz'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pdb_single/'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Input tar file: single/PED00001e003.tar.gz, pdb files in this archive file: ['PED00001e003.pdb']
pdb_single/PED00001e003.pdb pdb_single/PED00001e003.pdb</code></pre>
</div>
</div>
<div id="4c34674b" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">extract_and_move_files(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'multiple'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pdb_multiple'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Input tar file: PED00226e001.tar.gz, pdb files in this archive file: ['PED00226e000.pdb']
source file: pdb_multiple/PED00226e000.pdb, destination file: pdb_multiple/PED00226e001.pdb</code></pre>
</div>
</div>
<section id="separate-chains-and-fix-pdb-if-necessary" class="level2">
<h2 class="anchored" data-anchor-id="separate-chains-and-fix-pdb-if-necessary">Separate chains and fix PDB if necessary</h2>
<p>For the entry with multiple chains, before we can perform entanglement analysis, we need additional step is seperate individual chain.</p>
<div id="8b548b9e" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> separate_chains(original_pdb, output_folder):</span>
<span id="cb12-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb12-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Separate chains from a Protein Data Bank (PDB) file and save them as individual files.</span></span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Parameters:</span></span>
<span id="cb12-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    - original_pdb (str): The path to the original PDB file to process.</span></span>
<span id="cb12-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    - output_folder (str): The folder where the separated chain files will be saved.</span></span>
<span id="cb12-8"></span>
<span id="cb12-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Returns:</span></span>
<span id="cb12-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    - None</span></span>
<span id="cb12-11"></span>
<span id="cb12-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This function reads an original PDB file and separates its contents into individual chain-specific</span></span>
<span id="cb12-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    PDB files. Each chain-specific file contains only the alpha carbon (CA) atom records for a particular chain.</span></span>
<span id="cb12-14"></span>
<span id="cb12-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    If the specified output folder does not exist, it will be created.</span></span>
<span id="cb12-16"></span>
<span id="cb12-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Example Usage:</span></span>
<span id="cb12-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    separate_chains("input.pdb", "output_folder/")</span></span>
<span id="cb12-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb12-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the base name without the file extension</span></span>
<span id="cb12-21">    base_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.splitext(os.path.basename(original_pdb))[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb12-22"></span>
<span id="cb12-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the output folder exists, and create it if it doesn't</span></span>
<span id="cb12-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> os.path.exists(output_folder):</span>
<span id="cb12-25">        os.makedirs(output_folder)</span>
<span id="cb12-26"></span>
<span id="cb12-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read content of the original PDB file</span></span>
<span id="cb12-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(original_pdb, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb12-29">        content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> f.readlines()</span>
<span id="cb12-30"></span>
<span id="cb12-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Collect unique chain identifiers and alternate location indicators</span></span>
<span id="cb12-32">    chain_identifiers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>()</span>
<span id="cb12-33">    alternate_location_indicators <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>()</span>
<span id="cb12-34"></span>
<span id="cb12-35">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> content:</span>
<span id="cb12-36">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> line.startswith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ATOM"</span>):</span>
<span id="cb12-37">            chain_identifiers.add(line[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>])</span>
<span id="cb12-38">            alternate_location_indicators.add(line[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>])</span>
<span id="cb12-39"></span>
<span id="cb12-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create separate PDB files for each chain</span></span>
<span id="cb12-41">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> chain_identifier <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> chain_identifiers:</span>
<span id="cb12-42">        output_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.join(output_folder, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>base_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>chain_identifier<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.pdb"</span>)</span>
<span id="cb12-43"></span>
<span id="cb12-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(output_file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb12-45">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> content:</span>
<span id="cb12-46">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> line.startswith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MODEL"</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> line.startswith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ENDMDL"</span>):</span>
<span id="cb12-47">                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write entire MODEL and ENDMDL lines</span></span>
<span id="cb12-48">                    f.write(line)</span>
<span id="cb12-49">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> line.startswith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ATOM"</span>):</span>
<span id="cb12-50">                    atom_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> line[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>].strip()</span>
<span id="cb12-51">                    current_chain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> line[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>]</span>
<span id="cb12-52">                    alternate_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> line[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>]</span>
<span id="cb12-53"></span>
<span id="cb12-54">                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the line matches the criteria for the current chain</span></span>
<span id="cb12-55">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> atom_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CA"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> current_chain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> chain_identifier <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> alternate_location <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> alternate_location_indicators:</span>
<span id="cb12-56">                        f.write(line)</span></code></pre></div>
</div>
<div id="d2805975" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># separate_chains('pdb_multiple/PED00226e001.pdb', 'fixed_multiple')</span></span>
<span id="cb13-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example Usage:</span></span>
<span id="cb13-3">separate_chains(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pdb_multiple/PED00226e001.pdb'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output_folder/"</span>)</span></code></pre></div>
</div>
</section>
</section>
<section id="entanglement-analysis" class="level1">
<h1>Entanglement analysis</h1>
<p>Now, time to run entanglement analysis. For multiple chains in entry, we need to seperate chains before run analysis but now, just go ahead with single chain.</p>
<p>This general command works:</p>
<p><code>julia -t 8 /home/qvv5013/work3/code/entanglement_analysis/gauss_linking.jl -f pdb_single/PED00216e001.pdb -o .</code></p>
<p>A more detailed of this analysis will be provided later!</p>


</section>

 ]]></description>
  <category>IDP</category>
  <guid>https://vuqv.github.io/posts/2023/October/download_PED_entries.html</guid>
  <pubDate>Sat, 14 Oct 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Extracting information from IDP database and IDP classification</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/2023/October/Extracting_disorder_regions_from_MobiDB.html</link>
  <description><![CDATA[ 





<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Proteins are complex biomolecules crucial for the functioning of living organisms. They come in various shapes and sizes, each designed for specific functions within cells. Some proteins are well-structured, while others exhibit intrinsic disorder. Understanding the level of disorder in a protein is essential for unraveling its biological role. In this blog post, we’ll explore how we can determine if a protein is fully intrinsically disordered, contains structured regions with disordered loops, or is entirely structured, using insights from Necci et al.’s 2016 research (<span class="citation" data-cites="Necci2016">Necci, Piovesan, and Tosatto (2016)</span>). Given a protein sequence and structural ensemble, how do we know if it is fully IDP, protein with some IDR regions or it is fully structured with some loops?</p>
<section id="classifying-proteins-based-on-disorder" class="level2">
<h2 class="anchored" data-anchor-id="classifying-proteins-based-on-disorder">Classifying Proteins Based on Disorder:</h2>
<p>Necci and colleagues proposed a classification scheme for intrinsically disordered proteins (IDPs) based on the number of consecutive disordered residues:</p>
<ol type="1">
<li><p>Short IDR: Proteins with <img src="https://latex.codecogs.com/png.latex?5-19"> consecutive disordered residues.</p></li>
<li><p>Long IDR: Proteins with <img src="https://latex.codecogs.com/png.latex?%5Cge%2020"> consecutive disordered residues.</p></li>
<li><p>Fully Disordered Protein: Proteins with <img src="https://latex.codecogs.com/png.latex?%5Cge%2050"> consecutive disordered residues and more than 95% of their content being disordered.</p></li>
</ol>
<p>This classification scheme provides a straightforward way to categorize proteins based on their disorder characteristics, offering valuable insights into their potential functions.</p>
</section>
<section id="mapping-sequence-features" class="level2">
<h2 class="anchored" data-anchor-id="mapping-sequence-features">Mapping Sequence Features:</h2>
<p>To determine a protein’s disorder characteristics, we need to map sequence features from two primary resources: DISPROT and MobiDB. DISPROT is a database that provides information about where structured and disordered regions are located in a protein sequence, while MobiDB offers valuable data on protein mobility and disorder.</p>
<p>Using these resources, we can efficiently evaluate the disorder characteristics of a given protein entry in the PED (Protein Ensemble Database). By cross-referencing the information from DISPROT and MobiDB with the PED entries, we can gain a comprehensive understanding of a protein’s structural properties.</p>
</section>
</section>
<section id="what-is-mobidb" class="level1">
<h1>What is MobiDB?</h1>
<p>MobiDB comprises different types of disorder annotations and different quality levels of disorder evidence. (More information can be found here: <span class="citation" data-cites="Monzon2020">Monzon et al. (2020)</span>)</p>
<p>The source of evidence in MobiDB can be classified depending on the quality of evidence:</p>
<ol type="1">
<li><p><b>High-quality:</b> data are imported from manually curated external databases.</p></li>
<li><p><b>Intermediate-quality:</b> annotations are derived from experimental data such as X-ray diffraction, NMR, and NMR chemical shifts.</p></li>
<li><p><b>Lowest-quality:</b> Disorder predictions are provided by different computational methods and represent the lowest quality and confidence, even though they have by far the largest coverage by including all UniProt proteins</p></li>
</ol>
<p><u>In order to provide the most reliable disorder annotation for each protein, MobiDB combines all its data sources into a consensus annotation, prioritizing curated and indirect pieces of evidence over predictions.</u></p>
<p><b>Curated Data:</b> High-quality annotations in MobiDB come from external resources which provide manually curated evidence. Intrinsically disordered regions are extracted from three databases, DisProt, FuzDB, and UniProt. DisProt is the largest database which covers manually curated ID annotations. In the latest version of MobiDB, DisProt disordered regions are propagated by homology, exploiting GeneTree alignments with a similarity constraint of 80%.</p>
<p><b> Derived Data:</b> Indirect experimental data sources provide annotations from X-ray experiments, NMR three-dimensional models, and NMRchemical shift data. Indirect disorder information is derived from PDB in three different ways by considering (1) missing, (2) high temperature, and (3) mobile residues. Missing residues are those for which the detected electron density is not sharp enough to model the corresponding structure.</p>
<p><b>Predicted Data:</b> To define a residue as disordered, at least five out of eight predictors have to agree with the prediction.</p>
</section>
<section id="code-implementation" class="level1">
<h1>Code implementation</h1>
<section id="import-libraries" class="level2">
<h2 class="anchored" data-anchor-id="import-libraries">Import libraries</h2>
<div id="6b2eca66-1441-4a1c-b8fe-b788b97c5270" class="cell" data-is_executing="true" data-jupyter="{&quot;outputs_hidden&quot;:false}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># import library</span></span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colorama <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Fore, Back, Style</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> itertools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> groupby</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> operator <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> itemgetter</span></code></pre></div>
</div>
</section>
<section id="retrieve-disorder-information-from-mobidb" class="level2">
<h2 class="anchored" data-anchor-id="retrieve-disorder-information-from-mobidb">Retrieve disorder information from MobiDB</h2>
<p>Next, we define a function to retrieve disorder-related information for a protein using the DISPROT/MobiDB database.</p>
<p>Here, we only use data with highest confidence from MobiDB. All highest confidence sources of evidence are treated equally.</p>
<p>Specifically, the following categories will be used:</p>
<ol type="1">
<li><p><code>curated-disorder-priority</code>: Residues are annotated with the source with the highest of evidence from curated data</p></li>
<li><p><code>homology-disorder-priority</code>: Residues are annotated with the source with the highest of evidence from homology (see above for more information)</p></li>
<li><p><code>derived-missing_residues-priority</code>: Residues are annotated when at least 90% of the children are annotated</p></li>
<li><p><code>prediction-disorder-priority</code>: Residues are annotated with the source with the highest of evidence from prediction (see above for more information)</p></li>
<li><p><code>derived-mobile-th_90</code>: Mobile residues, residues are annotated when at least 90% of the children are annotated</p></li>
</ol>
<div id="5a739572-5cc5-4f3c-a57f-1a4d41364f5b" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> get_mobidb_disordered_data(uniprot):</span>
<span id="cb2-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Retrieve disorder-related information for a protein using the DISPROT/MobiDB database.</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This function takes a UniProt ID as input and queries the DISPROT/MobiDB database to retrieve disorder-related</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    information for the specified protein. It returns a list of intervals representing disordered regions based on</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    specific keywords, with a preference for "curated" disorder information.</span></span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Args:</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        uniprot (str): The UniProt ID of the protein for which disorder information is to be retrieved.</span></span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Returns:</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        list: A list of intervals representing disordered regions. Each interval is represented as a tuple (start, end).</span></span>
<span id="cb2-14"></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Example:</span></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        disordered_regions = get_mobidb_disordered_data("P12345")</span></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        print("Disordered Regions:")</span></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        for interval in disordered_regions:</span></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            print(f"[{interval[0]}, {interval[1]}]")</span></span>
<span id="cb2-20"></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Note:</span></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - The function queries the DISPROT/MobiDB database via its API.</span></span>
<span id="cb2-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - It prioritizes "curated" disorder information when available.</span></span>
<span id="cb2-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - Disorder information is returned based on specific keywords.</span></span>
<span id="cb2-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - If no disorder information is found, an empty list is returned.</span></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb2-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The information about these triplets can be found here: https://mobidb.org/help#vocabulary</span></span>
<span id="cb2-28">    keywords <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'curated-disorder-priority'</span>,</span>
<span id="cb2-29">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'homology-disorder-priority'</span>,</span>
<span id="cb2-30">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'derived-missing_residues-priority'</span>, </span>
<span id="cb2-31">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prediction-disorder-priority'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'derived-mobile-th_90'</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#, , 'derived-mobile_context_dependent-th_90'</span></span>
<span id="cb2-32"></span>
<span id="cb2-33">    url <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://mobidb.org/api/download?format=json&amp;acc='</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> uniprot</span>
<span id="cb2-34"></span>
<span id="cb2-35">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the ID exists in DISPROT/MOBIDB</span></span>
<span id="cb2-36">    res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(url)</span>
<span id="cb2-37"></span>
<span id="cb2-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> res.status_code <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>:</span>
<span id="cb2-39">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb2-40">            result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> res.json()</span>
<span id="cb2-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span>:</span>
<span id="cb2-42">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ID DOES NOT EXITS IN THE DATABASE"</span>)</span>
<span id="cb2-43">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> []  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Return an empty list if JSON parsing fails</span></span>
<span id="cb2-44"></span>
<span id="cb2-45">        disordered_regions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb2-46"></span>
<span id="cb2-47">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> key <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> keywords:</span>
<span id="cb2-48">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> key <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> result.keys():</span>
<span id="cb2-49">                regions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> result[key][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'regions'</span>]</span>
<span id="cb2-50">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(key, regions)</span></span>
<span id="cb2-51">                disordered_regions.append(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>(regions))</span>
<span id="cb2-52"></span>
<span id="cb2-53">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(disordered_regions)</span></span>
<span id="cb2-54">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(disordered_regions) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb2-55">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NO DISORDER REGION FOUND"</span>)</span>
<span id="cb2-56">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fully structured"</span></span>
<span id="cb2-57">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> disordered_regions</span>
<span id="cb2-58"></span>
<span id="cb2-59">    </span>
<span id="cb2-60">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> []  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Return an empty list if the ID does not exist in the database</span></span></code></pre></div>
</div>
<div id="6af8a79b-5b44-445c-ad8f-86c529256ccd" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example:</span></span>
<span id="cb3-2">get_mobidb_disordered_data(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P02751"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>[([1, 47], [272, 296], [2083, 2198], [2432, 2477]),
 ([153, 166], [702, 730], [2330, 2339])]</code></pre>
</div>
</div>
<p>As we can see, here the function only extracts disorder regions from various criterias and not doing anything. To be more clear, we need to sort out, combine continous regions in a compact form for more intuitative.</p>
</section>
<section id="merge-data-in-compact-continuous-region-form" class="level2">
<h2 class="anchored" data-anchor-id="merge-data-in-compact-continuous-region-form">Merge data in compact, continuous region form</h2>
<p>As an example, the <code>get_mobidb_disordered_data</code> prints all regions without sorting. This is quite messy. We will define a <code>merge_data</code> function to sort, combine the results and print in compact form:</p>
<div id="d7c124ab-4ca6-4306-8dc1-ba3aad9a0858" class="cell" data-jupyter="{&quot;outputs_hidden&quot;:false}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> merge_data(data_sets):</span>
<span id="cb5-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Merge and compact intervals from multiple data sets.</span></span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This function takes a list of data sets, where each data set consists of one or more intervals.</span></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    It combines intervals from all data sets, merges overlapping intervals, and further merges adjacent intervals.</span></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    The resulting merged intervals are printed in compact form.</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Args:</span></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        data_sets (list): A list of data sets, where each data set is represented as a tuple of intervals.</span></span>
<span id="cb5-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            Each interval is represented as a list with two elements: [start, end].</span></span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Returns:</span></span>
<span id="cb5-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        None: The function prints the merged intervals but does not return a value.</span></span>
<span id="cb5-15"></span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Example:</span></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        data_sets = [([1, 56],), ([1, 56],), ([59, 68],), ([57, 58], [150, 160])]</span></span>
<span id="cb5-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        merge_data(data_sets)</span></span>
<span id="cb5-19"></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Output:</span></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Compact Merged Intervals:</span></span>
<span id="cb5-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        [[1, 68], [150, 160]]</span></span>
<span id="cb5-23"></span>
<span id="cb5-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Note:</span></span>
<span id="cb5-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - Intervals within each data set are merged if they overlap.</span></span>
<span id="cb5-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - Intervals across different data sets are combined and merged.</span></span>
<span id="cb5-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - Adjacent intervals are further merged into compact intervals.</span></span>
<span id="cb5-28"></span>
<span id="cb5-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb5-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(data_sets)</span></span>
<span id="cb5-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(data_sets, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>):</span>
<span id="cb5-32">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if protein is fully structure, data_sets will be string- then do nothing</span></span>
<span id="cb5-33">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> []</span>
<span id="cb5-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(data_sets) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb5-35">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print("[ID does not exist in Database]")</span></span>
<span id="cb5-36">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> []</span>
<span id="cb5-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize an empty list to store all intervals</span></span>
<span id="cb5-38">    all_intervals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-39"></span>
<span id="cb5-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate through each data set and collect all intervals</span></span>
<span id="cb5-41">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> intervals <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data_sets:</span>
<span id="cb5-42">        all_intervals.extend(intervals)</span>
<span id="cb5-43"></span>
<span id="cb5-44">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort the intervals by their start values</span></span>
<span id="cb5-45">    all_intervals.sort(key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x: x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb5-46"></span>
<span id="cb5-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize a list to store the merged intervals</span></span>
<span id="cb5-48">    merged_intervals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-49"></span>
<span id="cb5-50">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate through the sorted intervals and merge overlapping intervals</span></span>
<span id="cb5-51">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> interval <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> all_intervals:</span>
<span id="cb5-52">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> merged_intervals <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> interval[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> merged_intervals[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]:</span>
<span id="cb5-53">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If the interval does not overlap with the last merged interval, add it as a new merged interval</span></span>
<span id="cb5-54">            merged_intervals.append(interval)</span>
<span id="cb5-55">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb5-56">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If the interval overlaps with the last merged interval, merge them</span></span>
<span id="cb5-57">            merged_intervals[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [merged_intervals[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(merged_intervals[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], interval[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])]</span>
<span id="cb5-58"></span>
<span id="cb5-59">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Further merge adjacent intervals</span></span>
<span id="cb5-60">    final_merged_intervals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-61">    current_interval <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> merged_intervals[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb5-62"></span>
<span id="cb5-63">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> interval <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> merged_intervals[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]:</span>
<span id="cb5-64">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> current_interval[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> interval[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]:</span>
<span id="cb5-65">            current_interval[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> interval[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-66">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb5-67">            final_merged_intervals.append(current_interval)</span>
<span id="cb5-68">            current_interval <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> interval</span>
<span id="cb5-69"></span>
<span id="cb5-70">    final_merged_intervals.append(current_interval)</span>
<span id="cb5-71"></span>
<span id="cb5-72">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print the merged intervals in compact form</span></span>
<span id="cb5-73">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print("Disorder regions:")</span></span>
<span id="cb5-74">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(tuple(final_merged_intervals))</span></span>
<span id="cb5-75">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>(final_merged_intervals)</span></code></pre></div>
</div>
</section>
<section id="count-how-many-disorder-residues-in-a-given-sequence" class="level2">
<h2 class="anchored" data-anchor-id="count-how-many-disorder-residues-in-a-given-sequence">Count how many disorder residues in a given sequence</h2>
<p>Alright, Now we have the information about where is the disorder regions of full sequence (MobiDB) and where is the sequence in PED mapping to MobiDB. Question is how many residues in PED sequence are disorder? For that purpose, we define a <code>count_overlap</code> function to do this job.</p>
<p>This function takes two arguments (as docs of function below)</p>
<p><code>first_range</code> is the region of PED sequence, as a tuple</p>
<p><code>second_ranges</code> is the disorder regions from MobiDB, is a tuple or list of tuples in case sequence contains many disorder regions and not continous.</p>
<div id="1658aed3-5364-41f6-9fed-9b5aaf1fd593" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> count_overlap(first_range, second_ranges):</span>
<span id="cb6-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Count the number of overlapping numbers between two range tuples.</span></span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Args:</span></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        first_range (tuple): A tuple representing the first range as (start, end).</span></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        second_ranges (tuple or list of tuples): A tuple or list of tuples representing the second ranges.</span></span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Returns:</span></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        list: A list of counts, where each count corresponds to the number of overlapping numbers for each region</span></span>
<span id="cb6-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            in the second_ranges.</span></span>
<span id="cb6-12"></span>
<span id="cb6-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Example:</span></span>
<span id="cb6-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        first_range = (57, 160)</span></span>
<span id="cb6-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        second_ranges = ([1, 68], [150, 160])</span></span>
<span id="cb6-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        overlaps = count_overlap(first_range, second_ranges)</span></span>
<span id="cb6-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        print(overlaps)  # Output: [12, 11]</span></span>
<span id="cb6-18"></span>
<span id="cb6-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb6-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(first_range, second_ranges)</span></span>
<span id="cb6-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(second_ranges, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>):</span>
<span id="cb6-22">        second_ranges <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(second_ranges)</span>
<span id="cb6-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(second_ranges)</span></span>
<span id="cb6-24">    overlaps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-25"></span>
<span id="cb6-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>(second_ranges):</span>
<span id="cb6-27">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># when disorder region is empty-fully structure-return an empty list</span></span>
<span id="cb6-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> []</span>
<span id="cb6-29">    </span>
<span id="cb6-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> second_range <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> second_ranges:</span>
<span id="cb6-31">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(second_range)</span></span>
<span id="cb6-32">        start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(first_range[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], second_range[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb6-33">        end <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(first_range[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], second_range[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb6-34"></span>
<span id="cb6-35">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> end:</span>
<span id="cb6-36">            overlap_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> end <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb6-37">            overlaps.append(overlap_count)</span>
<span id="cb6-38">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb6-39">            overlaps.append(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb6-40"></span>
<span id="cb6-41">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> overlaps</span>
<span id="cb6-42"></span></code></pre></div>
</div>
<div id="112dbe27-13a9-4a09-a487-c720e681f0cf" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example usage:</span></span>
<span id="cb7-2">first_range <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">57</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">160</span>)</span>
<span id="cb7-3">second_ranges <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">68</span>],)<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#, [150, 160]</span></span>
<span id="cb7-4">overlaps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> count_overlap(first_range, second_ranges)</span>
<span id="cb7-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(overlaps)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[12]</code></pre>
</div>
</div>
</section>
<section id="classify-protein-based-on-the-length-of-disorder-regions" class="level2">
<h2 class="anchored" data-anchor-id="classify-protein-based-on-the-length-of-disorder-regions">Classify protein based on the length of disorder regions</h2>
<p>We have the length of IDR regions, here we define a function to classify proteins into catagories as stated in the introduction:</p>
<ul>
<li><p>Fully IDP</p></li>
<li><p>Long IDR</p></li>
<li><p>Short IDR</p></li>
<li><p>Fully Structured</p></li>
</ul>
<div id="3be08918-0090-4398-a774-a6dc4f303830" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> classify_idr_regions(length_of_idr, length_in_ped):</span>
<span id="cb9-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Classifies Intrinsic Disorder Regions (IDR) based on specified criteria.</span></span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Args:</span></span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        length_of_idr (list of int): A list of integer values representing the lengths</span></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            of individual IDR regions.</span></span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        length_of_pdb (int): The total length of the Protein Data Bank (PDB) structure.</span></span>
<span id="cb9-9"></span>
<span id="cb9-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Returns:</span></span>
<span id="cb9-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        str: A classification string for the IDR regions based on the following criteria:</span></span>
<span id="cb9-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            - If any region has a length greater than or equal to 50 and accounts for</span></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">              more than 95% of the PDB length, it is classified as "Full IDP."</span></span>
<span id="cb9-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            - If any region has a length greater than or equal to 20, it is classified as</span></span>
<span id="cb9-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">              "Long IDR."</span></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            - If any region has a length between 5 and 19 (inclusive), it is classified as</span></span>
<span id="cb9-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">              "Short IDR."</span></span>
<span id="cb9-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            - If all regions have lengths less than 5, the entire structure is classified</span></span>
<span id="cb9-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">              as "Fully Structured."</span></span>
<span id="cb9-20"></span>
<span id="cb9-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Examples:</span></span>
<span id="cb9-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        &gt;&gt;&gt; length_of_idr = [1, 10, 69]</span></span>
<span id="cb9-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        &gt;&gt;&gt; length_of_pdb = 69</span></span>
<span id="cb9-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        &gt;&gt;&gt; classification = classify_idr_regions(length_of_idr, leng_of_pdb)</span></span>
<span id="cb9-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        &gt;&gt;&gt; print(classification)</span></span>
<span id="cb9-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        "Long IDR"</span></span>
<span id="cb9-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        </span></span>
<span id="cb9-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Note:</span></span>
<span id="cb9-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - If multiple criteria apply to different regions, the most strict criteria</span></span>
<span id="cb9-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">          are applied. The priority is "Full IDP" &gt; "Long IDR" &gt; "Short IDR" &gt; "Fully Structured."</span></span>
<span id="cb9-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - This function assumes that the input values are valid and correctly represent</span></span>
<span id="cb9-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">          the lengths of IDR regions and the PDB length.</span></span>
<span id="cb9-33"></span>
<span id="cb9-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb9-35">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> length_in_ped <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>:</span>
<span id="cb9-36">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Not Classified"</span></span>
<span id="cb9-37">    </span>
<span id="cb9-38">    classifications <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb9-39"></span>
<span id="cb9-40">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idr_length <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> length_of_idr:</span>
<span id="cb9-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> idr_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (idr_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> length_in_ped) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>:</span>
<span id="cb9-42">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the second condition should be sum(length_of_idr)/ length_in_ped it will make more sense</span></span>
<span id="cb9-43">            classifications.append(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Full IDP"</span>)</span>
<span id="cb9-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> idr_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>:</span>
<span id="cb9-45">            classifications.append(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Long IDR"</span>)</span>
<span id="cb9-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> idr_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span>:</span>
<span id="cb9-47">            classifications.append(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Short IDR"</span>)</span>
<span id="cb9-48">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb9-49">            classifications.append(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Undefined"</span>)</span>
<span id="cb9-50"></span>
<span id="cb9-51">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Determine the final classification based on priority</span></span>
<span id="cb9-52">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Full IDP"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> classifications:</span>
<span id="cb9-53">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fully IDP"</span></span>
<span id="cb9-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Long IDR"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> classifications:</span>
<span id="cb9-55">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Long IDR"</span></span>
<span id="cb9-56">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Short IDR"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> classifications:</span>
<span id="cb9-57">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Short IDR"</span></span>
<span id="cb9-58">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb9-59">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fully Structured"</span></span>
<span id="cb9-60"></span>
<span id="cb9-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example usage:</span></span>
<span id="cb9-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># length_of_idr = [3, 4]</span></span>
<span id="cb9-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># length_in_ped = 18</span></span>
<span id="cb9-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># classification = classify_idr_regions(length_of_idr, length_in_ped)</span></span>
<span id="cb9-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print("Classification:", classification)</span></span></code></pre></div>
</div>
</section>
<section id="combine-all-together" class="level2">
<h2 class="anchored" data-anchor-id="combine-all-together">Combine all together:</h2>
<p>Function to do the main task: get information from PED, pass uniprot to call MobiDB then do all other stuffs:</p>
<div id="fc402e42-b936-4e47-8c77-cf9522e3d87c" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">This function work very well. need some modifies for printing.</span></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb10-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> get_ped_stats(PEDID):</span>
<span id="cb10-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb10-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Retrieve and display protein ensemble deposition (PED) statistics for a given PED entry.</span></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This function queries the Protein Ensemble Deposition (PED) API to retrieve statistics and information for a</span></span>
<span id="cb10-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    specific PED entry identified by its PEDID. It provides details such as the entry ID, title, and information</span></span>
<span id="cb10-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    about chains and fragments within the entry. Additionally, it calculates the number of overlapping residues</span></span>
<span id="cb10-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    between fragment positions and disordered regions retrieved from the DISPROT/MobiDB database.</span></span>
<span id="cb10-12"></span>
<span id="cb10-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Args:</span></span>
<span id="cb10-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        PEDID (str): The PED entry ID for the entry to retrieve statistics.</span></span>
<span id="cb10-15"></span>
<span id="cb10-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Returns:</span></span>
<span id="cb10-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        None: The function prints the PED statistics and overlap counts but does not return a value.</span></span>
<span id="cb10-18"></span>
<span id="cb10-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Example:</span></span>
<span id="cb10-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        get_ped_stats("PED12345")</span></span>
<span id="cb10-21"></span>
<span id="cb10-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Note:</span></span>
<span id="cb10-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - This function requires the 'requests' library for HTTP requests and 'colorama' for colored output.</span></span>
<span id="cb10-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - It queries the PED API to obtain entry information.</span></span>
<span id="cb10-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - It retrieves disordered region information using the DISPROT/MobiDB database.</span></span>
<span id="cb10-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        - Overlapping residues between fragment positions and disordered regions are calculated and displayed.</span></span>
<span id="cb10-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb10-28">    url <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://deposition.proteinensemble.org/api/v1/entries/"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> PEDID</span>
<span id="cb10-29">    res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(url)</span>
<span id="cb10-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> res.status_code <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>:</span>
<span id="cb10-31">        res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> res.json()</span>
<span id="cb10-32">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PED ID</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"># chains in entry</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Protein name</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Length in PED (tag counted)</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\"\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">UniProt</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Length UniProt</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Disordered region from MobiDB/DisProt</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\"\t\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PDB region (align to Uniprot)</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\"\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Length of IDR</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> Classification"</span>)</span>
<span id="cb10-33"></span>
<span id="cb10-34">        construct_chains <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> res[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'construct_chains'</span>]</span>
<span id="cb10-35"></span>
<span id="cb10-36">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> chain <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> construct_chains:</span>
<span id="cb10-37">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(construct_chains) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb10-38">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># chain_name = chain['chain_name']</span></span>
<span id="cb10-39">                entry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PEDID</span>
<span id="cb10-40">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb10-41">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># chain_name = res['entry_id'] + '_' + chain['chain_name']</span></span>
<span id="cb10-42">                entry<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PEDID <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> chain[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'chain_name'</span>]</span>
<span id="cb10-43"></span>
<span id="cb10-44">            n_fragments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(chain[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fragments'</span>])</span>
<span id="cb10-45">            fragments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> chain[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fragments'</span>]</span>
<span id="cb10-46"></span>
<span id="cb10-47">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fragment, fragment_stats <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(fragments, chain[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fragments_stats'</span>]):</span>
<span id="cb10-48">                protein_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fragment[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'description'</span>]</span>
<span id="cb10-49">                length_in_ped <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fragment_stats[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'length_total_pdb'</span>]</span>
<span id="cb10-50">                uniprot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fragment_stats[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'uniprot'</span>]</span>
<span id="cb10-51">                length_uniprot <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fragment_stats[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'length_total_uniprot'</span>]</span>
<span id="cb10-52"></span>
<span id="cb10-53">                mobi_disorder_regions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>()</span>
<span id="cb10-54">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> fragment_stats[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'uniprot'</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb10-55">                    mobi_disorder_regions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> merge_data(get_mobidb_disordered_data(fragment_stats[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'uniprot'</span>]))</span>
<span id="cb10-56"></span>
<span id="cb10-57">                pdb_region <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>([fragment[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'start_position'</span>], fragment[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'end_position'</span>]])</span>
<span id="cb10-58">                length_of_idr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> count_overlap(pdb_region, mobi_disorder_regions)</span>
<span id="cb10-59">                classification <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> classify_idr_regions(length_of_idr, length_in_ped)</span>
<span id="cb10-60"></span>
<span id="cb10-61">                <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>entry<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(construct_chains)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>protein_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>length_in_ped<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>uniprot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>length_uniprot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>mobi_disorder_regions<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>pdb_region<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>length_of_idr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>classification<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb10-62">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> res.status_code <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">404</span>:</span>
<span id="cb10-63">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Entry </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>PEDID<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> does not exist"</span>)</span>
<span id="cb10-64">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span></span></code></pre></div>
</div>
</section>
</section>
<section id="example-usage" class="level1">
<h1>Example usage:</h1>
<div id="f46f2622-2c5d-432b-9553-50f12079b961" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">ID<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span></span>
<span id="cb11-2">PEDID<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PED'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ID<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:05d}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb11-3">get_ped_stats(PEDID)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PED ID  # chains in entry   Protein name    "Length in PED (tag counted)"   UniProt Length UniProt  "Disordered region from MobiDB/DisProt" "PDB region (align to Uniprot)" Length of IDR    Classification
PED00019_A  2   None    160 O14558  160 ([1, 68], [150, 160])   (1, 160)    [68, 11]    Long IDR
PED00019_B  2   Heat shock protein beta-6   160 O14558  160 ([1, 68], [150, 160])   (1, 160)    [68, 11]    Long IDR</code></pre>
</div>
</div>
<section id="explanation-of-the-example" class="level2">
<h2 class="anchored" data-anchor-id="explanation-of-the-example">Explanation of the example</h2>
<p>Here, we are looking at the PED entry <code>PED00019</code>.</p>
<p>This entry comprises two chains: Chain <code>A</code> and Chain <code>B</code>. To enhance clarity, we opt to represent the name as <code>ENTRY+CHAIN</code> for both.</p>
<p>Chain A consists of 160 residues and can be traced back to the UniProt ID O14558, which is also characterized by 160 residues.</p>
<p>The disorder regions, as identified by MobiDB, are situated at positions <code>[1, 68]</code> and <code>[150, 160]</code>.</p>
<p>In the PDB data within PED, the entire sequence, spanning positions <code>[1, 160]</code>, is cataloged.</p>
<p>Upon a careful comparison of PED PDB data and the disorder regions, we observe the presence of two distinct disorder regions, one spanning 68 residues and the other 11 residues in length.</p>
<p>Similar explaination for chain B.</p>
</section>
</section>
<section id="notes" class="level1">
<h1>Notes:</h1>
<p>In some cases, PED PDB can be complicated such as single chain is combined of multiple segment from multiple UniProt sequence, we need to manually combine information from that.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-Monzon2020" class="csl-entry">
Monzon, Alexander Miguel, András Hatos, Marco Necci, Damiano Piovesan, and Silvio C. E. Tosatto. 2020. <span>“Exploring Protein Intrinsic Disorder with MobiDB.”</span> In <em>Intrinsically Disordered Proteins: Methods and Protocols</em>, edited by Birthe B. Kragelund and Karen Skriver, 127–43. New York, NY: Springer US. <a href="https://doi.org/10.1007/978-1-0716-0524-0_6">https://doi.org/10.1007/978-1-0716-0524-0_6</a>.
</div>
<div id="ref-Necci2016" class="csl-entry">
Necci, Marco, Damiano Piovesan, and Silvio C. E. Tosatto. 2016. <span>“<span class="nocase">Large‐scale analysis of intrinsic disorder flavors and associated functions in the protein sequence universe</span>.”</span> <em>Protein Science</em> 25 (12): 2164–74. <a href="https://doi.org/10.1002/pro.3041">https://doi.org/10.1002/pro.3041</a>.
</div>
</div></section></div> ]]></description>
  <category>IDP</category>
  <category>PED</category>
  <category>MobiDB</category>
  <category>DisProt</category>
  <guid>https://vuqv.github.io/posts/2023/October/Extracting_disorder_regions_from_MobiDB.html</guid>
  <pubDate>Sun, 01 Oct 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>All-Atom simulations of IDP</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/Research/All-Atom_simulations_IDPs.html</link>
  <description><![CDATA[ 





<section id="list-of-simulation-works-using-all-atom-resolution-and-force-field-used" class="level3">
<h3 class="anchored" data-anchor-id="list-of-simulation-works-using-all-atom-resolution-and-force-field-used">List of simulation works using all-atom resolution and force field used:</h3>
<ul>
<li><p><span class="citation" data-cites="Galvanetto2023">Galvanetto et al. (2023)</span> used Amber99SBws force field with the TIP4P/2005s water model. Their FFs for Gromacs can be download from: <a href="https://github.com/bestlab/force_fields">https://github.com/bestlab/force_fields</a>. This folder contains various FFs with an explaination. I have made a fork from their repo for backup to my own account.</p></li>
<li><p><span class="citation" data-cites="Priyesh2023">Mohanty et al. (2023)</span> used AMBER99SBws-STQ force field with TIP4P/2005. Download from <a href="https://bitbucket.org/jeetain/all-atom_ff_refinements/src/master/amber99sbws-stq.ff/">HERE</a>. A backup version is located in: <code>Research/IDP_AA_FFs/</code></p></li>
</ul>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-Galvanetto2023" class="csl-entry">
Galvanetto, Nicola, Miloš T. Ivanović, Aritra Chowdhury, Andrea Sottini, Mark F. Nüesch, Daniel Nettels, Robert B. Best, and Benjamin Schuler. 2023. <span>“<span class="nocase">Extreme dynamics in a biomolecular condensate</span>.”</span> <em>Nature</em> 25 (February). <a href="https://doi.org/10.1038/s41586-023-06329-5">https://doi.org/10.1038/s41586-023-06329-5</a>.
</div>
<div id="ref-Priyesh2023" class="csl-entry">
Mohanty, Priyesh, Jayakrishna Shenoy, Azamat Rizuan, José F. Mercado-Ortiz, Nicolas L. Fawzi, and Jeetain Mittal. 2023. <span>“A Synergy Between Site-Specific and Transient Interactions Drives the Phase Separation of a Disordered, Low-Complexity Domain.”</span> <em>Proceedings of the National Academy of Sciences</em> 120 (34): e2305625120. <a href="https://doi.org/10.1073/pnas.2305625120">https://doi.org/10.1073/pnas.2305625120</a>.
</div>
</div></section></div> ]]></description>
  <category>Research</category>
  <category>IDP</category>
  <category>LLPS</category>
  <guid>https://vuqv.github.io/posts/Research/All-Atom_simulations_IDPs.html</guid>
  <pubDate>Thu, 17 Aug 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Some Conda Commands Frequently Used</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/python/conda-commands.html</link>
  <description><![CDATA[ 





<p><code>conda</code> is a great python package environment.</p>
<section id="here-is-some-frequently-used-commands" class="level1">
<h1>Here is some frequently used commands:</h1>
<section id="post-under-construction" class="level2">
<h2 class="anchored" data-anchor-id="post-under-construction">(Post under construction)</h2>
<ol type="1">
<li>Create a new environment: <code>conda create -n ENV_NAME python=PYTHON_VERSION</code></li>
<li>List all env: <code>conda env list</code></li>
<li>Delete environment: <code>conda env remove -n ENV_NAME</code></li>
<li>List all packages in the current env to text file so that can create new env later: <code>conda list -e &gt; requirements.txt</code></li>
<li>Create new env from text file generated in step (4): <code>conda create --name &lt;ENV_NAME&gt; --file requirements.txt</code></li>
</ol>


</section>
</section>

 ]]></description>
  <category>Python</category>
  <guid>https://vuqv.github.io/posts/python/conda-commands.html</guid>
  <pubDate>Fri, 24 Feb 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Simple OpenMM system for testing code development</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/openMM/openmm_code_snippet.html</link>
  <description><![CDATA[ 





<p>This post contains a simple system definition of two beads with custom nonbonded for testing</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python numberLines lineAnchors code-with-copy"><code class="sourceCode python"><span id="cb1-1"></span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> openmm <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> mm</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> openmm.app <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> app</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(mm.__version__)</span>
<span id="cb1-7">sys <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mm.System()</span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2 GLY</span></span>
<span id="cb1-9">sys.addParticle(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">57.05</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>mm.unit.amu)</span>
<span id="cb1-10">sys.addParticle(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">57.05</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>mm.unit.amu)</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># build topology</span></span>
<span id="cb1-13">top<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>mm.app.topology.Topology()</span>
<span id="cb1-14">top.addChain(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prot'</span>)</span>
<span id="cb1-15">prot_chain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(top.chains())[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-16">top.addResidue(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GLY'</span>, prot_chain)</span>
<span id="cb1-17">res1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(top.residues())[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-18">top.addAtom(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CA'</span>, app.Element.getBySymbol(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>), res1)</span>
<span id="cb1-19"></span>
<span id="cb1-20">top.addResidue(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GLY'</span>, prot_chain)</span>
<span id="cb1-21">res2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(top.residues())[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-22">top.addAtom(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CA'</span>, app.Element.getBySymbol(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>), res2)</span>
<span id="cb1-23"></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # first implementation</span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># energy_function = '((rc/r)^(4)-1)^(2)'</span></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wang_frenkel_force = mm.CustomNonbondedForce(energy_function)</span></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wang_frenkel_force.addGlobalParameter('rc', 1.408533*mm.unit.nanometer)</span></span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># second implementation</span></span>
<span id="cb1-30">energy_function <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'step(rc-r)*((rc/r)^(2*mu)-1)^(2*nu);'</span></span>
<span id="cb1-31">wang_frenkel_force <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mm.CustomNonbondedForce(energy_function)</span>
<span id="cb1-32">wang_frenkel_force.addGlobalParameter(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rc'</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.408533</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>mm.unit.nanometer)</span>
<span id="cb1-33">wang_frenkel_force.addGlobalParameter(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mu'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-34">wang_frenkel_force.addGlobalParameter(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nu'</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-35"></span>
<span id="cb1-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # # third implementation</span></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># energy_function = '((rc/r)^(4)-1)^(2*nu);'</span></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wang_frenkel_force = mm.CustomNonbondedForce(energy_function)</span></span>
<span id="cb1-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wang_frenkel_force.addGlobalParameter('rc', 1.408533*mm.unit.nanometer)</span></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # wang_frenkel_force.addGlobalParameter('mu', 2)</span></span>
<span id="cb1-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wang_frenkel_force.addGlobalParameter('nu', 1)</span></span>
<span id="cb1-42"></span>
<span id="cb1-43"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> top.atoms():</span>
<span id="cb1-44">    wang_frenkel_force.addParticle(())</span>
<span id="cb1-45"></span>
<span id="cb1-46">sys.addForce(wang_frenkel_force)</span>
<span id="cb1-47"></span>
<span id="cb1-48">integrator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mm.LangevinIntegrator(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>mm.unit.kelvin, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>mm.unit.picosecond, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.000001</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>mm.unit.picosecond)</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # CPU</span></span>
<span id="cb1-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># platform = mm.Platform.getPlatformByName('CPU')</span></span>
<span id="cb1-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># properties = {'Threads': str(8)}</span></span>
<span id="cb1-53"></span>
<span id="cb1-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GPU</span></span>
<span id="cb1-55">platform <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mm.Platform.getPlatformByName(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CUDA'</span>)</span>
<span id="cb1-56">properties <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CudaPrecision'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'single'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DeviceIndex"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span>}</span>
<span id="cb1-57">sim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mm.app.Simulation(top, sys, integrator, platform, properties)</span>
<span id="cb1-58"></span>
<span id="cb1-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pos=np.array([[0,0,0],[1.409,0,0]])</span></span>
<span id="cb1-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pos=np.array([[0,0,0],[1.4,0,0]])</span></span>
<span id="cb1-61">pos<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]])</span>
<span id="cb1-62"></span>
<span id="cb1-63">sim.context.setPositions(pos)</span>
<span id="cb1-64">state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sim.context.getState(getForces<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, getEnergy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-65"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(platform)</span>
<span id="cb1-66"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(properties)</span>
<span id="cb1-67"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(state.getPotentialEnergy())</span>
<span id="cb1-68"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(state.getForces())</span></code></pre></div>



 ]]></description>
  <category>OpenMM</category>
  <guid>https://vuqv.github.io/posts/openMM/openmm_code_snippet.html</guid>
  <pubDate>Thu, 09 Feb 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>COSMO tutorial</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/openMM/cosmo_tutorial.html</link>
  <description><![CDATA[ 





<p>This tutorial guide you how to use cosmo package to perform coarse-grained simulations of IDPs</p>
<p><img src="https://vuqv.github.io/posts/openMM/hpsOpenMM.png" class="img-fluid"></p>
<section id="installation-cosmo" class="level1">
<h1>Installation <code>Cosmo</code></h1>
<p>First, you need to follow the <a href="https://github.com/qvv5013/hpsOpenMM#how-to-use-hpsopenmm">Readme file here</a> to install the package.</p>
</section>
<section id="generate-initial-structure" class="level1">
<h1>Generate initial structure:</h1>
<p>To generate initial structure, we can use a provided script: <code>scripts/generate_structure_from_fasta/generate_structure.py</code></p>
<p>In this script, there are some parameters need to be changed:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python numberLines lineAnchors code-with-copy"><code class="sourceCode python"><span id="cb1-1">seq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MRTQWPSPAKLNLFLYITGQRADGYHTLQTLFQFLDYGDTISIELRDDGDIRLLTPVEGVEHEDNLIVRAARLLMKTAADSGRLPTGSGANISIDKRLPMGGGLGGGSSNAATVLVALNHLWQCGLSMDELAEMGLTLGADVPVFVRGHAAFAEGVGEILTPVDPPEKWYLVAHPGVSIPTPVIFKDPELPRNTPKRSIETLLKCEFSNDCEVIARKRFREVDAVLSWLLEYAPSRLTGTGACVFAEFDTESEARQVLEQAPEWLNGFVAKGANLSPLHRAML'</span></span>
<span id="cb1-2">protein_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2ww4"</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of chains = nx*ny</span></span>
<span id="cb1-4">nx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-5">ny <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span></code></pre></div>
<p>The long axis of molecule will be aligned along z-axis, we will expand the system along x-y plane.</p>
<ul>
<li>line 1: the fasta sequence of protein we are studying</li>
<li>line 2: name of protein, will be used to write pdb output file name</li>
<li>lines 3-4: number of copies in x-y dimension, in case simulation of multichains</li>
</ul>
</section>
<section id="simulation-control-file" class="level1">
<h1>Simulation control file:</h1>
<p>Simulation control parameters are saved in *ini file format (python file format): here, I will named it as md.ini</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python numberLines lineAnchors code-with-copy"><code class="sourceCode python"><span id="cb2-1">[OPTIONS]</span>
<span id="cb2-2">md_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10_000</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of steps</span></span>
<span id="cb2-3">dt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> time step <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ps</span>
<span id="cb2-4">nstxout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> number of steps to write checkpoint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nstxout</span>
<span id="cb2-5">nstlog <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> number of steps to <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span> log</span>
<span id="cb2-6">nstcomm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> frequency <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> center of mass motion removal</span>
<span id="cb2-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> select HPS model, available options: hps_kr, hps_urry, hps_ss, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> mpipi</span>
<span id="cb2-8">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mpipi</span>
<span id="cb2-9"></span>
<span id="cb2-10"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> control temperature coupling</span>
<span id="cb2-11">tcoupl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> yes</span>
<span id="cb2-12">ref_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">310</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> Kelvin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> reference temperature</span>
<span id="cb2-13">tau_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> ps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-14"></span>
<span id="cb2-15"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>pressure coupling</span>
<span id="cb2-16">pcoupl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> no</span>
<span id="cb2-17">ref_p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-18">frequency_p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb2-19"></span>
<span id="cb2-20"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> Periodic boundary condition: <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> pcoupl <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> yes then pbc must be yes.</span>
<span id="cb2-21">pbc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> yes</span>
<span id="cb2-22"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> pbc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>yes, then use box_dimension option to specify box_dimension <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> [x, y, z], unit of nanometer</span>
<span id="cb2-23"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> otherwise, box_dimension <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> required <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> does <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> take <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">any</span> effect.</span>
<span id="cb2-24">box_dimension <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>]</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span></span>
<span id="cb2-27">protein_code <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ASYN</span>
<span id="cb2-28">pdb_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> asyn.pdb</span>
<span id="cb2-29"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> output</span>
<span id="cb2-30">checkpoint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> asyn.chk</span>
<span id="cb2-31"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>Use GPU<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>CPU</span>
<span id="cb2-32">device <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GPU</span>
<span id="cb2-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> If CPU <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> specified, then use ppn variable</span>
<span id="cb2-34">ppn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb2-35"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>Restart simulation</span>
<span id="cb2-36">restart <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> no</span>
<span id="cb2-37">minimize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> yes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> restart, then minimize will be loaded, otherwise, minimize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span></code></pre></div>
<p>This control file is almost self-explaination if you are familiar with other MD simulation packages.</p>
</section>
<section id="running-simulation" class="level1">
<h1>Running simulation</h1>
<p>To run simulation, there are two options:</p>
<ol type="1">
<li><p>Normal canonical simulation using Langevin dynamics: <code>hps-simulation -f md.ini</code></p></li>
<li><p>If you want to customize your simulation to use some advanced methods, make a copy of <code>examples/standard_example/run_simulation.py</code> Customize the content of this script then execute the command: <code>python run_simulation -f md.ini</code></p></li>
</ol>
</section>
<section id="analyze-simulation-trajectory" class="level1">
<h1>Analyze simulation trajectory</h1>
<p>Simulation will generate a psf file for topology and dcd file for trajectory, in addition, a log file that contains potential energy, kinetics energy, total energy and time remain to run simulations. But mainly you will need to analyze the trajectory to extract the information you need.</p>
<p>In the scripts/ directory, I provided some scripts I used in my study but you may need to develop for yours.</p>


</section>

 ]]></description>
  <category>IDP</category>
  <category>OpenMM</category>
  <guid>https://vuqv.github.io/posts/openMM/cosmo_tutorial.html</guid>
  <pubDate>Sat, 04 Feb 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Implementation of Mpipi model in OpenMM</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/openMM/mpipi_model.html</link>
  <description><![CDATA[ 





<p><img src="https://vuqv.github.io/posts/openMM/WF_LJ.jpg" class="img-fluid"></p>
<p><b>Mpipi model is a coarse-grain model for simulating IDP.</b> The original code is implemented in LAMMPS but I am not familiar with LAMMPS either.</p>
<p>The original paper: <code>Physics-driven coarse-grained model for biomolecular phase separation with near-quantitative accuracy.</code> <code>Nature Computational Science volume 1, pages 732–743 (2021).</code> PDF file can be accessed from <a href="https://www.nature.com/articles/s43588-021-00155-3.epdf?sharing_token=EFzbweM1tOcYysI9oqUf9tRgN0jAjWel9jnR3ZoTv0OS6pLrbg60YiLYD1_wVdGp2Eu-H3ug5R37GhptvP-gObky-AytK6zbXFSGemcfdNg2kiUHIMYOv2d1wMOnNfHohUITqWql4RDHZjLEnHFs365Wh9a4RcPzXXly-vH42d8%3D">here</a></p>
<p>This model is different from other hps-based model is instead of using LJ12-6 potential, it used Wang-Frenkel potential.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cphi_%7Bi,j%7D(r)%20=%20%5Cepsilon_%7Bi,j%7D%20%20%5Calpha_%7Bij%7D%20%20%5Cleft%5B%5Cleft(%5Cfrac%7B%5Csigma_%7Bij%7D%7D%7Br%7D%5Cright)%5E%7B2%5Cmu_%7Bij%7D%7D-1%20%5Cright%5D%20%20%5Cleft%5B%20%5Cleft(%5Cfrac%7BR_%7Bij%7D%7D%7Br%7D%5Cright)%5E%7B2%5Cmu_%7Bij%7D%7D-1%5Cright%5D%5E%7B2%5Cnu_%7Bij%7D%7D"></p>
<p>where,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Calpha_%7Bij%7D=%202%5Cnu_%7Bij%7D%20%5Ctimes%20%5Cleft(%5Cfrac%7BR_%7Bij%7D%7D%7B%5Csigma_%7Bij%7D%7D%5Cright)%5E%7B2%5Cmu_%7Bij%7D%7D%20%5Ctimes%20%5Cleft%5B%20%5Cfrac%7B(2%5Cnu_%7Bij%7D+1)%7D%7B2%5Cnu_%7Bij%7D%20%5Cleft(%20%5Cleft(%5Cfrac%7BR_%7Bij%7D%7D%7B%5Csigma_%7Bij%7D%7D%5Cright)%5E%7B2%5Cmu_%7Bij%7D%7D-1%20%5Cright)%20%7D)%5Cright%5D%5E%7B2%5Cnu_%7Bij%7D+1%7D"></p>
<p>They used: <img src="https://latex.codecogs.com/png.latex?%5Cnu_%7Bij%7D=1"> and <img src="https://latex.codecogs.com/png.latex?R_%7Bij%7D=3%5Csigma_%7Bij%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csigma_%7Bij%7D,%20%5Cepsilon_%7Bij%7D,%20%5Cmu_%7Bij%7D"> are parameters specified for each pair of interacting beads.</p>
<section id="implementation" class="level1">
<h1>Implementation</h1>
<p>To implement this functional form. We used TabulatedFunction in OpenMM.</p>
<p>First, we need to define the atom type of each residue, this definition is implemented in <code>hps/parameters/model_parameters.py</code> file as a dictionary, or github: <a href="https://raw.githubusercontent.com/qvv5013/hpsOpenMM/main/hps/parameters/model_parameters.py">here</a></p>
<hr>
<p>Function is defined in <code>hps/core/system.py</code>. Here is the copied function:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource python numberLines lineAnchors code-with-copy"><code class="sourceCode python"><span id="cb1-1">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> add_Wang_Frenkel_Forces(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, use_pbc: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>):</span>
<span id="cb1-2">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        MPIPI model. using TabulatedFunction for pair interaction.</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        More information about TabulatedFUnction can be found here:</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        http://docs.openmm.org/7.2.0/api-c++/generated/OpenMM.Discrete2DFunction.html</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb1-7">        wang_frenkel_cutoff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> unit.nanometer</span>
<span id="cb1-8"></span>
<span id="cb1-9">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        In the model module, we only call this function when the model is mpipi so the following condition likely to be</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        true. But to be sure, we still check here.</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb1-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.model <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mpipi'</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wang-Frenkel is only used in Mpipi model."</span></span>
<span id="cb1-14"></span>
<span id="cb1-15">        table_eps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model_parameters.parameters[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.model][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eps_ij'</span>]</span>
<span id="cb1-16">        table_eps_ravel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table_eps.ravel().tolist()</span>
<span id="cb1-17"></span>
<span id="cb1-18">        table_sigma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model_parameters.parameters[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.model][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sigma_ij'</span>]</span>
<span id="cb1-19">        table_sigma_ravel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table_sigma.ravel().tolist()</span>
<span id="cb1-20"></span>
<span id="cb1-21">        table_nu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model_parameters.parameters[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.model][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nu_ij'</span>]</span>
<span id="cb1-22">        table_nu_ravel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table_nu.ravel().tolist()</span>
<span id="cb1-23"></span>
<span id="cb1-24">        table_mu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model_parameters.parameters[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.model][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mu_ij'</span>]</span>
<span id="cb1-25">        table_mu_ravel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table_mu.ravel().tolist()</span>
<span id="cb1-26"></span>
<span id="cb1-27">        table_rc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model_parameters.parameters[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.model][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rc_ij'</span>]</span>
<span id="cb1-28">        table_rc_ravel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table_rc.ravel().tolist()</span>
<span id="cb1-29"></span>
<span id="cb1-30">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of atom types in model. currently with protein, there are 20.</span></span>
<span id="cb1-31">        n_atom_types <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> table_sigma.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb1-32"></span>
<span id="cb1-33">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># eps, sigma, nu, mu, rc: load from tabular table</span></span>
<span id="cb1-34">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Note: here we use abs function in ((rc/r)^(2*mu)-1)^(2*nu) because otherwise, nu added by parameters is float.</span></span>
<span id="cb1-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        when r&gt;rc, produces this is negative and non-integer power of float is nan.</span></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb1-38">        energy_function <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eps * 2*nu*(rc/sigma)^(2*mu) * ((2*nu+1)/(2*nu*((rc/sigma)^(2*mu)-1)))^(2*nu+1)'</span></span>
<span id="cb1-39">        energy_function <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'* ((sigma/r)^(2*mu)-1 )* abs((rc/r)^(2*mu)-1)^(2*nu);'</span></span>
<span id="cb1-40">        energy_function <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eps = eps_table(id1, id2); sigma = sigma_table(id1, id2);'</span></span>
<span id="cb1-41">        energy_function <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nu = nu_table(id1, id2);'</span></span>
<span id="cb1-42">        energy_function <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mu = mu_table(id1, id2);'</span></span>
<span id="cb1-43">        energy_function <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rc=rc_table(id1, id2)'</span></span>
<span id="cb1-44"></span>
<span id="cb1-45">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mm.CustomNonbondedForce(energy_function)</span>
<span id="cb1-46">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.addTabulatedFunction(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eps_table'</span>, mm.Discrete2DFunction(n_atom_types, n_atom_types,</span>
<span id="cb1-47">                                                                                        table_eps_ravel))</span>
<span id="cb1-48">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.addTabulatedFunction(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sigma_table'</span>,</span>
<span id="cb1-49">                                                     mm.Discrete2DFunction(n_atom_types, n_atom_types,</span>
<span id="cb1-50">                                                                           table_sigma_ravel))</span>
<span id="cb1-51">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.addTabulatedFunction(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nu_table'</span>, mm.Discrete2DFunction(n_atom_types, n_atom_types,</span>
<span id="cb1-52">                                                                                       table_nu_ravel))</span>
<span id="cb1-53">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.addTabulatedFunction(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mu_table'</span>, mm.Discrete2DFunction(n_atom_types, n_atom_types,</span>
<span id="cb1-54">                                                                                       table_mu_ravel))</span>
<span id="cb1-55">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.addTabulatedFunction(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rc_table'</span>, mm.Discrete2DFunction(n_atom_types, n_atom_types,</span>
<span id="cb1-56">                                                                                       table_rc_ravel))</span>
<span id="cb1-57">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.addPerParticleParameter(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'id'</span>)</span>
<span id="cb1-58"></span>
<span id="cb1-59">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, atom <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.atoms):</span>
<span id="cb1-60">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.addParticle((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.particle_type_id[i],))</span>
<span id="cb1-61"></span>
<span id="cb1-62">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> use_pbc:</span>
<span id="cb1-63">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.setNonbondedMethod(mm.NonbondedForce.CutoffPeriodic)</span>
<span id="cb1-64">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb1-65">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.setNonbondedMethod(mm.NonbondedForce.CutoffNonPeriodic)</span>
<span id="cb1-66"></span>
<span id="cb1-67">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.setCutoffDistance(wang_frenkel_cutoff)</span>
<span id="cb1-68"></span>
<span id="cb1-69">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set exclusion rule</span></span>
<span id="cb1-70">        bonded_exclusions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(b[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].index, b[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].index) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> b <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.topology.bonds())]</span>
<span id="cb1-71">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wang_Frenkel_Force.createExclusionsFromBonds(bonded_exclusions, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bonded_exclusions_index)</span></code></pre></div>
<ul>
<li>line 15-28: read the numpy array define <img src="https://latex.codecogs.com/png.latex?%5Cepsilon_%7Bij%7D">, <img src="https://latex.codecogs.com/png.latex?%5Cnu_%7Bij%7D">, <img src="https://latex.codecogs.com/png.latex?%5Cmu_%7Bij%7D">, and <img src="https://latex.codecogs.com/png.latex?R_%7Bij%7D"></li>
<li>line 38-43: define the energy function to pass into <code>CustomNonbondedForce</code></li>
<li>line 46-55: let openMM knows where to get <code>eps_table</code> and other tabulated variables</li>
<li>the only Per-Particle-Parameter is the <code>id</code> of the particle, this is <code>id</code> of the residue type which is defined in <code>model_parameters.py</code></li>
<li>Other lines are self-explained.</li>
</ul>
<p>The above code used global cutoff for Wang-Frenkel potential is <code>2.5nm</code>. As stated in the paper, authors used the cutoff for each pair interaction is <img src="https://latex.codecogs.com/png.latex?3%5Csigma">. To do so, we can add the stepsize function before the energy function. <code>Step</code> function in openMM work as: <code>step(x)=0 if x&lt; 0 and 1 if x&gt;=0</code>.</p>
<p>We can add: <code>step(rc-r)*eps...</code> to the energy function. So, if <img src="https://latex.codecogs.com/png.latex?r%20%5Cgt%20rc%20%5CRightarrow%20rc-r%20%5Clt%200%20%5CRightarrow%20step(rc-r)%20=0"></p>
</section>
<section id="tabulatedfunction" class="level1">
<h1>TabulatedFunction:</h1>
<p>This is an interesting point from computational perpective.</p>
<p>More information about TabulatedFunction can be found in OpenMM documentation <a href="http://docs.openmm.org/7.2.0/api-c++/generated/OpenMM.Discrete2DFunction.html">here</a></p>
<p>Here, I will use 2D Discrete function.</p>
<p>The function works as follow: <code>Discrete2DFunction(xsize, ysize, val)</code></p>
<p>the tabulated values of the function <code>f(x,y)</code>, ordered so that <code>values[i+xsize*j] = f(i,j)</code>. This must be of length <code>xsize*ysize</code>.</p>
<p>This is the reason why I use <code>ravel()</code> function from python to covnert 2D array to 1D array above.</p>
<p>In this code, I call:<br>
<img src="https://latex.codecogs.com/png.latex?%5Cepsilon_%7Bij%7D"> = <code>eps</code>,<br>
<img src="https://latex.codecogs.com/png.latex?%5Cnu_%7Bij%7D"> = <code>nu</code>,<br>
<img src="https://latex.codecogs.com/png.latex?%5Cmu_%7Bij%7D"> = <code>mu</code>,<br>
<img src="https://latex.codecogs.com/png.latex?R_%7Bij%7D"> = <code>rc</code></p>
<p>Each particle has Per-Particle-Parameter: <code>id</code></p>
<p>Here, we define, i.e: <code>eps</code> is a tabulated function: <code>eps = eps_table(id1, id2)</code>. The value will be extracted from particle <code>id</code></p>
<p>In my computer, the last part of the energy function: <code>((rc/r)^(2*mu)-1)^(2*nu)</code> will be <code>nan</code> when <code>r&gt;rc</code>. This is very strange since <code>nu</code> is loaded as float but <code>2*nu</code> will always be an even number. My computer doesn’t know that by some rounding rules of floating point. when <code>r&gt;rc</code>: <code>rc/r&lt;1</code>, <code>rc/r-1&lt;0</code>, and non-integer number power of negative value is <code>NaN</code>.</p>
<p>That’s why I used the <code>abs</code> function before this part as the power is even so they are equivalent.</p>


</section>

 ]]></description>
  <category>IDP</category>
  <category>OpenMM</category>
  <guid>https://vuqv.github.io/posts/openMM/mpipi_model.html</guid>
  <pubDate>Wed, 11 Jan 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Make a beautiful plot using Matplotlib</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/python/Beautiful-plot-with-Matplotlib.html</link>
  <description><![CDATA[ 





<p>When writing a paper, a beautiful figure is very important. Before, I used Gnuplot or XMGRACE to make figures because it is easy to config.</p>
<p>Recently I moved to Matplotlib and used it in many of my projects, found it convenient to make plots and tweak them to produce beautiful figures.</p>
<p>Here are some snippet for reference to easily look back.</p>
<section id="import-library" class="level2">
<h2 class="anchored" data-anchor-id="import-library">Import library</h2>
<div id="cd08f8f5" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib</span>
<span id="cb1-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib notebook</span></code></pre></div>
</div>
<p>Config for matplotlib</p>
<div id="5d8da196" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># config for matplotlib</span></span>
<span id="cb2-2">font <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'family'</span> : <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'arial'</span>,</span>
<span id="cb2-3">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'weight'</span> : <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'normal'</span>,</span>
<span id="cb2-4">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'size'</span>   : <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>}</span>
<span id="cb2-5"></span>
<span id="cb2-6">matplotlib.rc(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font'</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>font)</span>
<span id="cb2-7">matplotlib.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'axes.spines.right'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb2-8">matplotlib.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'axes.spines.top'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb2-9">matplotlib.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'axes.linewidth'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#set the value globally</span></span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set tick width</span></span>
<span id="cb2-12">matplotlib.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xtick.major.size'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb2-13">matplotlib.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xtick.major.width'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb2-14">matplotlib.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ytick.major.size'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb2-15">matplotlib.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ytick.major.width'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span></code></pre></div>
</div>
<div id="070f68af" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a fake data:</span></span>
<span id="cb3-2">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.pi, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.pi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb3-3">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sin(x)</span>
<span id="cb3-4">y2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cos(x)</span></code></pre></div>
</div>
<div id="dab25df6" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">fig <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb4-2">plt.plot(x,y, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, lw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sin(x)'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb4-3">plt.plot(x,y2, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, lw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cos(x)'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot horizontal</span></span>
<span id="cb4-6">plt.axhline(y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>, linestyle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Config Legends and labels</span></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set yticks</span></span>
<span id="cb4-10">plt.yticks([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'first'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'second'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>])</span>
<span id="cb4-11"></span>
<span id="cb4-12">plt.legend(loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upper center'</span>, ncol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-13">plt.xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>np.pi)</span>
<span id="cb4-14">plt.ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-15">plt.ylabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$f_x$'</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#latex type</span></span>
<span id="cb4-16">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>)</span>
<span id="cb4-17"></span>
<span id="cb4-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To save figure with high DPI, uncomment following line: the more dpi, the clearer figure but large file</span></span>
<span id="cb4-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plt.savefig('Demo_matplotlib.png', dpi=1200)</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
/* Put everything inside the global mpl namespace */
/* global mpl */
window.mpl = {};

mpl.get_websocket_type = function () {
    if (typeof WebSocket !== 'undefined') {
        return WebSocket;
    } else if (typeof MozWebSocket !== 'undefined') {
        return MozWebSocket;
    } else {
        alert(
            'Your browser does not have WebSocket support. ' +
                'Please try Chrome, Safari or Firefox ≥ 6. ' +
                'Firefox 4 and 5 are also supported but you ' +
                'have to enable WebSockets in about:config.'
        );
    }
};

mpl.figure = function (figure_id, websocket, ondownload, parent_element) {
    this.id = figure_id;

    this.ws = websocket;

    this.supports_binary = this.ws.binaryType !== undefined;

    if (!this.supports_binary) {
        var warnings = document.getElementById('mpl-warnings');
        if (warnings) {
            warnings.style.display = 'block';
            warnings.textContent =
                'This browser does not support binary websocket messages. ' +
                'Performance may be slow.';
        }
    }

    this.imageObj = new Image();

    this.context = undefined;
    this.message = undefined;
    this.canvas = undefined;
    this.rubberband_canvas = undefined;
    this.rubberband_context = undefined;
    this.format_dropdown = undefined;

    this.image_mode = 'full';

    this.root = document.createElement('div');
    this.root.setAttribute('style', 'display: inline-block');
    this._root_extra_style(this.root);

    parent_element.appendChild(this.root);

    this._init_header(this);
    this._init_canvas(this);
    this._init_toolbar(this);

    var fig = this;

    this.waiting = false;

    this.ws.onopen = function () {
        fig.send_message('supports_binary', { value: fig.supports_binary });
        fig.send_message('send_image_mode', {});
        if (fig.ratio !== 1) {
            fig.send_message('set_device_pixel_ratio', {
                device_pixel_ratio: fig.ratio,
            });
        }
        fig.send_message('refresh', {});
    };

    this.imageObj.onload = function () {
        if (fig.image_mode === 'full') {
            // Full images could contain transparency (where diff images
            // almost always do), so we need to clear the canvas so that
            // there is no ghosting.
            fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height);
        }
        fig.context.drawImage(fig.imageObj, 0, 0);
    };

    this.imageObj.onunload = function () {
        fig.ws.close();
    };

    this.ws.onmessage = this._make_on_message_function(this);

    this.ondownload = ondownload;
};

mpl.figure.prototype._init_header = function () {
    var titlebar = document.createElement('div');
    titlebar.classList =
        'ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix';
    var titletext = document.createElement('div');
    titletext.classList = 'ui-dialog-title';
    titletext.setAttribute(
        'style',
        'width: 100%; text-align: center; padding: 3px;'
    );
    titlebar.appendChild(titletext);
    this.root.appendChild(titlebar);
    this.header = titletext;
};

mpl.figure.prototype._canvas_extra_style = function (_canvas_div) {};

mpl.figure.prototype._root_extra_style = function (_canvas_div) {};

mpl.figure.prototype._init_canvas = function () {
    var fig = this;

    var canvas_div = (this.canvas_div = document.createElement('div'));
    canvas_div.setAttribute(
        'style',
        'border: 1px solid #ddd;' +
            'box-sizing: content-box;' +
            'clear: both;' +
            'min-height: 1px;' +
            'min-width: 1px;' +
            'outline: 0;' +
            'overflow: hidden;' +
            'position: relative;' +
            'resize: both;'
    );

    function on_keyboard_event_closure(name) {
        return function (event) {
            return fig.key_event(event, name);
        };
    }

    canvas_div.addEventListener(
        'keydown',
        on_keyboard_event_closure('key_press')
    );
    canvas_div.addEventListener(
        'keyup',
        on_keyboard_event_closure('key_release')
    );

    this._canvas_extra_style(canvas_div);
    this.root.appendChild(canvas_div);

    var canvas = (this.canvas = document.createElement('canvas'));
    canvas.classList.add('mpl-canvas');
    canvas.setAttribute('style', 'box-sizing: content-box;');

    this.context = canvas.getContext('2d');

    var backingStore =
        this.context.backingStorePixelRatio ||
        this.context.webkitBackingStorePixelRatio ||
        this.context.mozBackingStorePixelRatio ||
        this.context.msBackingStorePixelRatio ||
        this.context.oBackingStorePixelRatio ||
        this.context.backingStorePixelRatio ||
        1;

    this.ratio = (window.devicePixelRatio || 1) / backingStore;

    var rubberband_canvas = (this.rubberband_canvas = document.createElement(
        'canvas'
    ));
    rubberband_canvas.setAttribute(
        'style',
        'box-sizing: content-box; position: absolute; left: 0; top: 0; z-index: 1;'
    );

    // Apply a ponyfill if ResizeObserver is not implemented by browser.
    if (this.ResizeObserver === undefined) {
        if (window.ResizeObserver !== undefined) {
            this.ResizeObserver = window.ResizeObserver;
        } else {
            var obs = _JSXTOOLS_RESIZE_OBSERVER({});
            this.ResizeObserver = obs.ResizeObserver;
        }
    }

    this.resizeObserverInstance = new this.ResizeObserver(function (entries) {
        var nentries = entries.length;
        for (var i = 0; i < nentries; i++) {
            var entry = entries[i];
            var width, height;
            if (entry.contentBoxSize) {
                if (entry.contentBoxSize instanceof Array) {
                    // Chrome 84 implements new version of spec.
                    width = entry.contentBoxSize[0].inlineSize;
                    height = entry.contentBoxSize[0].blockSize;
                } else {
                    // Firefox implements old version of spec.
                    width = entry.contentBoxSize.inlineSize;
                    height = entry.contentBoxSize.blockSize;
                }
            } else {
                // Chrome <84 implements even older version of spec.
                width = entry.contentRect.width;
                height = entry.contentRect.height;
            }

            // Keep the size of the canvas and rubber band canvas in sync with
            // the canvas container.
            if (entry.devicePixelContentBoxSize) {
                // Chrome 84 implements new version of spec.
                canvas.setAttribute(
                    'width',
                    entry.devicePixelContentBoxSize[0].inlineSize
                );
                canvas.setAttribute(
                    'height',
                    entry.devicePixelContentBoxSize[0].blockSize
                );
            } else {
                canvas.setAttribute('width', width * fig.ratio);
                canvas.setAttribute('height', height * fig.ratio);
            }
            canvas.setAttribute(
                'style',
                'width: ' + width + 'px; height: ' + height + 'px;'
            );

            rubberband_canvas.setAttribute('width', width);
            rubberband_canvas.setAttribute('height', height);

            // And update the size in Python. We ignore the initial 0/0 size
            // that occurs as the element is placed into the DOM, which should
            // otherwise not happen due to the minimum size styling.
            if (fig.ws.readyState == 1 && width != 0 && height != 0) {
                fig.request_resize(width, height);
            }
        }
    });
    this.resizeObserverInstance.observe(canvas_div);

    function on_mouse_event_closure(name) {
        return function (event) {
            return fig.mouse_event(event, name);
        };
    }

    rubberband_canvas.addEventListener(
        'mousedown',
        on_mouse_event_closure('button_press')
    );
    rubberband_canvas.addEventListener(
        'mouseup',
        on_mouse_event_closure('button_release')
    );
    rubberband_canvas.addEventListener(
        'dblclick',
        on_mouse_event_closure('dblclick')
    );
    // Throttle sequential mouse events to 1 every 20ms.
    rubberband_canvas.addEventListener(
        'mousemove',
        on_mouse_event_closure('motion_notify')
    );

    rubberband_canvas.addEventListener(
        'mouseenter',
        on_mouse_event_closure('figure_enter')
    );
    rubberband_canvas.addEventListener(
        'mouseleave',
        on_mouse_event_closure('figure_leave')
    );

    canvas_div.addEventListener('wheel', function (event) {
        if (event.deltaY < 0) {
            event.step = 1;
        } else {
            event.step = -1;
        }
        on_mouse_event_closure('scroll')(event);
    });

    canvas_div.appendChild(canvas);
    canvas_div.appendChild(rubberband_canvas);

    this.rubberband_context = rubberband_canvas.getContext('2d');
    this.rubberband_context.strokeStyle = '#000000';

    this._resize_canvas = function (width, height, forward) {
        if (forward) {
            canvas_div.style.width = width + 'px';
            canvas_div.style.height = height + 'px';
        }
    };

    // Disable right mouse context menu.
    this.rubberband_canvas.addEventListener('contextmenu', function (_e) {
        event.preventDefault();
        return false;
    });

    function set_focus() {
        canvas.focus();
        canvas_div.focus();
    }

    window.setTimeout(set_focus, 100);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'mpl-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'mpl-button-group';
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'mpl-button-group';
            continue;
        }

        var button = (fig.buttons[name] = document.createElement('button'));
        button.classList = 'mpl-widget';
        button.setAttribute('role', 'button');
        button.setAttribute('aria-disabled', 'false');
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));

        var icon_img = document.createElement('img');
        icon_img.src = '_images/' + image + '.png';
        icon_img.srcset = '_images/' + image + '_large.png 2x';
        icon_img.alt = tooltip;
        button.appendChild(icon_img);

        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    var fmt_picker = document.createElement('select');
    fmt_picker.classList = 'mpl-widget';
    toolbar.appendChild(fmt_picker);
    this.format_dropdown = fmt_picker;

    for (var ind in mpl.extensions) {
        var fmt = mpl.extensions[ind];
        var option = document.createElement('option');
        option.selected = fmt === mpl.default_extension;
        option.innerHTML = fmt;
        fmt_picker.appendChild(option);
    }

    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message';
    toolbar.appendChild(status_bar);
    this.message = status_bar;
};

mpl.figure.prototype.request_resize = function (x_pixels, y_pixels) {
    // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client,
    // which will in turn request a refresh of the image.
    this.send_message('resize', { width: x_pixels, height: y_pixels });
};

mpl.figure.prototype.send_message = function (type, properties) {
    properties['type'] = type;
    properties['figure_id'] = this.id;
    this.ws.send(JSON.stringify(properties));
};

mpl.figure.prototype.send_draw_message = function () {
    if (!this.waiting) {
        this.waiting = true;
        this.ws.send(JSON.stringify({ type: 'draw', figure_id: this.id }));
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    var format_dropdown = fig.format_dropdown;
    var format = format_dropdown.options[format_dropdown.selectedIndex].value;
    fig.ondownload(fig, format);
};

mpl.figure.prototype.handle_resize = function (fig, msg) {
    var size = msg['size'];
    if (size[0] !== fig.canvas.width || size[1] !== fig.canvas.height) {
        fig._resize_canvas(size[0], size[1], msg['forward']);
        fig.send_message('refresh', {});
    }
};

mpl.figure.prototype.handle_rubberband = function (fig, msg) {
    var x0 = msg['x0'] / fig.ratio;
    var y0 = (fig.canvas.height - msg['y0']) / fig.ratio;
    var x1 = msg['x1'] / fig.ratio;
    var y1 = (fig.canvas.height - msg['y1']) / fig.ratio;
    x0 = Math.floor(x0) + 0.5;
    y0 = Math.floor(y0) + 0.5;
    x1 = Math.floor(x1) + 0.5;
    y1 = Math.floor(y1) + 0.5;
    var min_x = Math.min(x0, x1);
    var min_y = Math.min(y0, y1);
    var width = Math.abs(x1 - x0);
    var height = Math.abs(y1 - y0);

    fig.rubberband_context.clearRect(
        0,
        0,
        fig.canvas.width / fig.ratio,
        fig.canvas.height / fig.ratio
    );

    fig.rubberband_context.strokeRect(min_x, min_y, width, height);
};

mpl.figure.prototype.handle_figure_label = function (fig, msg) {
    // Updates the figure title.
    fig.header.textContent = msg['label'];
};

mpl.figure.prototype.handle_cursor = function (fig, msg) {
    fig.rubberband_canvas.style.cursor = msg['cursor'];
};

mpl.figure.prototype.handle_message = function (fig, msg) {
    fig.message.textContent = msg['message'];
};

mpl.figure.prototype.handle_draw = function (fig, _msg) {
    // Request the server to send over a new figure.
    fig.send_draw_message();
};

mpl.figure.prototype.handle_image_mode = function (fig, msg) {
    fig.image_mode = msg['mode'];
};

mpl.figure.prototype.handle_history_buttons = function (fig, msg) {
    for (var key in msg) {
        if (!(key in fig.buttons)) {
            continue;
        }
        fig.buttons[key].disabled = !msg[key];
        fig.buttons[key].setAttribute('aria-disabled', !msg[key]);
    }
};

mpl.figure.prototype.handle_navigate_mode = function (fig, msg) {
    if (msg['mode'] === 'PAN') {
        fig.buttons['Pan'].classList.add('active');
        fig.buttons['Zoom'].classList.remove('active');
    } else if (msg['mode'] === 'ZOOM') {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.add('active');
    } else {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.remove('active');
    }
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Called whenever the canvas gets updated.
    this.send_message('ack', {});
};

// A function to construct a web socket function for onmessage handling.
// Called in the figure constructor.
mpl.figure.prototype._make_on_message_function = function (fig) {
    return function socket_on_message(evt) {
        if (evt.data instanceof Blob) {
            var img = evt.data;
            if (img.type !== 'image/png') {
                /* FIXME: We get "Resource interpreted as Image but
                 * transferred with MIME type text/plain:" errors on
                 * Chrome.  But how to set the MIME type?  It doesn't seem
                 * to be part of the websocket stream */
                img.type = 'image/png';
            }

            /* Free the memory for the previous frames */
            if (fig.imageObj.src) {
                (window.URL || window.webkitURL).revokeObjectURL(
                    fig.imageObj.src
                );
            }

            fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL(
                img
            );
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        } else if (
            typeof evt.data === 'string' &&
            evt.data.slice(0, 21) === 'data:image/png;base64'
        ) {
            fig.imageObj.src = evt.data;
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }

        var msg = JSON.parse(evt.data);
        var msg_type = msg['type'];

        // Call the  "handle_{type}" callback, which takes
        // the figure and JSON message as its only arguments.
        try {
            var callback = fig['handle_' + msg_type];
        } catch (e) {
            console.log(
                "No handler for the '" + msg_type + "' message type: ",
                msg
            );
            return;
        }

        if (callback) {
            try {
                // console.log("Handling '" + msg_type + "' message: ", msg);
                callback(fig, msg);
            } catch (e) {
                console.log(
                    "Exception inside the 'handler_" + msg_type + "' callback:",
                    e,
                    e.stack,
                    msg
                );
            }
        }
    };
};

// from https://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas
mpl.findpos = function (e) {
    //this section is from http://www.quirksmode.org/js/events_properties.html
    var targ;
    if (!e) {
        e = window.event;
    }
    if (e.target) {
        targ = e.target;
    } else if (e.srcElement) {
        targ = e.srcElement;
    }
    if (targ.nodeType === 3) {
        // defeat Safari bug
        targ = targ.parentNode;
    }

    // pageX,Y are the mouse positions relative to the document
    var boundingRect = targ.getBoundingClientRect();
    var x = e.pageX - (boundingRect.left + document.body.scrollLeft);
    var y = e.pageY - (boundingRect.top + document.body.scrollTop);

    return { x: x, y: y };
};

/*
 * return a copy of an object with only non-object keys
 * we need this to avoid circular references
 * https://stackoverflow.com/a/24161582/3208463
 */
function simpleKeys(original) {
    return Object.keys(original).reduce(function (obj, key) {
        if (typeof original[key] !== 'object') {
            obj[key] = original[key];
        }
        return obj;
    }, {});
}

mpl.figure.prototype.mouse_event = function (event, name) {
    var canvas_pos = mpl.findpos(event);

    if (name === 'button_press') {
        this.canvas.focus();
        this.canvas_div.focus();
    }

    var x = canvas_pos.x * this.ratio;
    var y = canvas_pos.y * this.ratio;

    this.send_message(name, {
        x: x,
        y: y,
        button: event.button,
        step: event.step,
        guiEvent: simpleKeys(event),
    });

    /* This prevents the web browser from automatically changing to
     * the text insertion cursor when the button is pressed.  We want
     * to control all of the cursor setting manually through the
     * 'cursor' event from matplotlib */
    event.preventDefault();
    return false;
};

mpl.figure.prototype._key_event_extra = function (_event, _name) {
    // Handle any extra behaviour associated with a key event
};

mpl.figure.prototype.key_event = function (event, name) {
    // Prevent repeat events
    if (name === 'key_press') {
        if (event.key === this._key) {
            return;
        } else {
            this._key = event.key;
        }
    }
    if (name === 'key_release') {
        this._key = null;
    }

    var value = '';
    if (event.ctrlKey && event.key !== 'Control') {
        value += 'ctrl+';
    }
    else if (event.altKey && event.key !== 'Alt') {
        value += 'alt+';
    }
    else if (event.shiftKey && event.key !== 'Shift') {
        value += 'shift+';
    }

    value += 'k' + event.key;

    this._key_event_extra(event, name);

    this.send_message(name, { key: value, guiEvent: simpleKeys(event) });
    return false;
};

mpl.figure.prototype.toolbar_button_onclick = function (name) {
    if (name === 'download') {
        this.handle_save(this, null);
    } else {
        this.send_message('toolbar_button', { name: name });
    }
};

mpl.figure.prototype.toolbar_button_onmouseover = function (tooltip) {
    this.message.textContent = tooltip;
};

///////////////// REMAINING CONTENT GENERATED BY embed_js.py /////////////////
// prettier-ignore
var _JSXTOOLS_RESIZE_OBSERVER=function(A){var t,i=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakMap,o=new Set;function s(e){if(!(this instanceof s))throw new TypeError("Constructor requires 'new' operator");i.set(this,e)}function h(){throw new TypeError("Function is not a constructor")}function c(e,t,i,n){e=0 in arguments?Number(arguments[0]):0,t=1 in arguments?Number(arguments[1]):0,i=2 in arguments?Number(arguments[2]):0,n=3 in arguments?Number(arguments[3]):0,this.right=(this.x=this.left=e)+(this.width=i),this.bottom=(this.y=this.top=t)+(this.height=n),Object.freeze(this)}function d(){t=requestAnimationFrame(d);var s=new WeakMap,p=new Set;o.forEach((function(t){r.get(t).forEach((function(i){var r=t instanceof window.SVGElement,o=a.get(t),d=r?0:parseFloat(o.paddingTop),f=r?0:parseFloat(o.paddingRight),l=r?0:parseFloat(o.paddingBottom),u=r?0:parseFloat(o.paddingLeft),g=r?0:parseFloat(o.borderTopWidth),m=r?0:parseFloat(o.borderRightWidth),w=r?0:parseFloat(o.borderBottomWidth),b=u+f,F=d+l,v=(r?0:parseFloat(o.borderLeftWidth))+m,W=g+w,y=r?0:t.offsetHeight-W-t.clientHeight,E=r?0:t.offsetWidth-v-t.clientWidth,R=b+v,z=F+W,M=r?t.width:parseFloat(o.width)-R-E,O=r?t.height:parseFloat(o.height)-z-y;if(n.has(t)){var k=n.get(t);if(k[0]===M&&k[1]===O)return}n.set(t,[M,O]);var S=Object.create(h.prototype);S.target=t,S.contentRect=new c(u,d,M,O),s.has(i)||(s.set(i,[]),p.add(i)),s.get(i).push(S)}))})),p.forEach((function(e){i.get(e).call(e,s.get(e),e)}))}return s.prototype.observe=function(i){if(i instanceof window.Element){r.has(i)||(r.set(i,new Set),o.add(i),a.set(i,window.getComputedStyle(i)));var n=r.get(i);n.has(this)||n.add(this),cancelAnimationFrame(t),t=requestAnimationFrame(d)}},s.prototype.unobserve=function(i){if(i instanceof window.Element&&r.has(i)){var n=r.get(i);n.has(this)&&(n.delete(this),n.size||(r.delete(i),o.delete(i))),n.size||r.delete(i),o.size||cancelAnimationFrame(t)}},A.DOMRectReadOnly=c,A.ResizeObserver=s,A.ResizeObserverEntry=h,A}; // eslint-disable-line
mpl.toolbar_items = [["Home", "Reset original view", "fa fa-home icon-home", "home"], ["Back", "Back to previous view", "fa fa-arrow-left icon-arrow-left", "back"], ["Forward", "Forward to next view", "fa fa-arrow-right icon-arrow-right", "forward"], ["", "", "", ""], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "fa fa-arrows icon-move", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "fa fa-square-o icon-check-empty", "zoom"], ["", "", "", ""], ["Download", "Download plot", "fa fa-floppy-o icon-save", "download"]];

mpl.extensions = ["eps", "jpeg", "pgf", "pdf", "png", "ps", "raw", "svg", "tif"];

mpl.default_extension = "png";/* global mpl */

var comm_websocket_adapter = function (comm) {
    // Create a "websocket"-like object which calls the given IPython comm
    // object with the appropriate methods. Currently this is a non binary
    // socket, so there is still some room for performance tuning.
    var ws = {};

    ws.binaryType = comm.kernel.ws.binaryType;
    ws.readyState = comm.kernel.ws.readyState;
    function updateReadyState(_event) {
        if (comm.kernel.ws) {
            ws.readyState = comm.kernel.ws.readyState;
        } else {
            ws.readyState = 3; // Closed state.
        }
    }
    comm.kernel.ws.addEventListener('open', updateReadyState);
    comm.kernel.ws.addEventListener('close', updateReadyState);
    comm.kernel.ws.addEventListener('error', updateReadyState);

    ws.close = function () {
        comm.close();
    };
    ws.send = function (m) {
        //console.log('sending', m);
        comm.send(m);
    };
    // Register the callback with on_msg.
    comm.on_msg(function (msg) {
        //console.log('receiving', msg['content']['data'], msg);
        var data = msg['content']['data'];
        if (data['blob'] !== undefined) {
            data = {
                data: new Blob(msg['buffers'], { type: data['blob'] }),
            };
        }
        // Pass the mpl event to the overridden (by mpl) onmessage function.
        ws.onmessage(data);
    });
    return ws;
};

mpl.mpl_figure_comm = function (comm, msg) {
    // This is the function which gets called when the mpl process
    // starts-up an IPython Comm through the "matplotlib" channel.

    var id = msg.content.data.id;
    // Get hold of the div created by the display call when the Comm
    // socket was opened in Python.
    var element = document.getElementById(id);
    var ws_proxy = comm_websocket_adapter(comm);

    function ondownload(figure, _format) {
        window.open(figure.canvas.toDataURL());
    }

    var fig = new mpl.figure(id, ws_proxy, ondownload, element);

    // Call onopen now - mpl needs it, as it is assuming we've passed it a real
    // web socket which is closed, not our websocket->open comm proxy.
    ws_proxy.onopen();

    fig.parent_element = element;
    fig.cell_info = mpl.find_output_cell("<div id='" + id + "'></div>");
    if (!fig.cell_info) {
        console.error('Failed to find cell for figure', id, fig);
        return;
    }
    fig.cell_info[0].output_area.element.on(
        'cleared',
        { fig: fig },
        fig._remove_fig_handler
    );
};

mpl.figure.prototype.handle_close = function (fig, msg) {
    var width = fig.canvas.width / fig.ratio;
    fig.cell_info[0].output_area.element.off(
        'cleared',
        fig._remove_fig_handler
    );
    fig.resizeObserverInstance.unobserve(fig.canvas_div);

    // Update the output cell to use the data from the current canvas.
    fig.push_to_output();
    var dataURL = fig.canvas.toDataURL();
    // Re-enable the keyboard manager in IPython - without this line, in FF,
    // the notebook keyboard shortcuts fail.
    IPython.keyboard_manager.enable();
    fig.parent_element.innerHTML =
        '<img src="' + dataURL + '" width="' + width + '">';
    fig.close_ws(fig, msg);
};

mpl.figure.prototype.close_ws = function (fig, msg) {
    fig.send_message('closing', msg);
    // fig.ws.close()
};

mpl.figure.prototype.push_to_output = function (_remove_interactive) {
    // Turn the data on the canvas into data in the output cell.
    var width = this.canvas.width / this.ratio;
    var dataURL = this.canvas.toDataURL();
    this.cell_info[1]['text/html'] =
        '<img src="' + dataURL + '" width="' + width + '">';
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Tell IPython that the notebook contents must change.
    IPython.notebook.set_dirty(true);
    this.send_message('ack', {});
    var fig = this;
    // Wait a second, then push the new image to the DOM so
    // that it is saved nicely (might be nice to debounce this).
    setTimeout(function () {
        fig.push_to_output();
    }, 1000);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'btn-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'btn-group';
    var button;
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'btn-group';
            continue;
        }

        button = fig.buttons[name] = document.createElement('button');
        button.classList = 'btn btn-default';
        button.href = '#';
        button.title = name;
        button.innerHTML = '<i class="fa ' + image + ' fa-lg"></i>';
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));
        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    // Add the status bar.
    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message pull-right';
    toolbar.appendChild(status_bar);
    this.message = status_bar;

    // Add the close button to the window.
    var buttongrp = document.createElement('div');
    buttongrp.classList = 'btn-group inline pull-right';
    button = document.createElement('button');
    button.classList = 'btn btn-mini btn-primary';
    button.href = '#';
    button.title = 'Stop Interaction';
    button.innerHTML = '<i class="fa fa-power-off icon-remove icon-large"></i>';
    button.addEventListener('click', function (_evt) {
        fig.handle_close(fig, {});
    });
    button.addEventListener(
        'mouseover',
        on_mouseover_closure('Stop Interaction')
    );
    buttongrp.appendChild(button);
    var titlebar = this.root.querySelector('.ui-dialog-titlebar');
    titlebar.insertBefore(buttongrp, titlebar.firstChild);
};

mpl.figure.prototype._remove_fig_handler = function (event) {
    var fig = event.data.fig;
    if (event.target !== this) {
        // Ignore bubbled events from children.
        return;
    }
    fig.close_ws(fig, {});
};

mpl.figure.prototype._root_extra_style = function (el) {
    el.style.boxSizing = 'content-box'; // override notebook setting of border-box.
};

mpl.figure.prototype._canvas_extra_style = function (el) {
    // this is important to make the div 'focusable
    el.setAttribute('tabindex', 0);
    // reach out to IPython and tell the keyboard manager to turn it's self
    // off when our div gets focus

    // location in version 3
    if (IPython.notebook.keyboard_manager) {
        IPython.notebook.keyboard_manager.register_events(el);
    } else {
        // location in version 2
        IPython.keyboard_manager.register_events(el);
    }
};

mpl.figure.prototype._key_event_extra = function (event, _name) {
    // Check for shift+enter
    if (event.shiftKey && event.which === 13) {
        this.canvas_div.blur();
        // select the cell after this one
        var index = IPython.notebook.find_cell_index(this.cell_info[0]);
        IPython.notebook.select(index + 1);
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    fig.ondownload(fig, null);
};

mpl.find_output_cell = function (html_output) {
    // Return the cell and output element which can be found *uniquely* in the notebook.
    // Note - this is a bit hacky, but it is done because the "notebook_saving.Notebook"
    // IPython event is triggered only after the cells have been serialised, which for
    // our purposes (turning an active figure into a static one), is too late.
    var cells = IPython.notebook.get_cells();
    var ncells = cells.length;
    for (var i = 0; i < ncells; i++) {
        var cell = cells[i];
        if (cell.cell_type === 'code') {
            for (var j = 0; j < cell.output_area.outputs.length; j++) {
                var data = cell.output_area.outputs[j];
                if (data.data) {
                    // IPython >= 3 moved mimebundle to data attribute of output
                    data = data.data;
                }
                if (data['text/html'] === html_output) {
                    return [cell, data, j];
                }
            }
        }
    }
};

// Register the function which deals with the matplotlib target/channel.
// The kernel may be null if the page has been refreshed.
if (IPython.notebook.kernel !== null) {
    IPython.notebook.kernel.comm_manager.register_target(
        'matplotlib',
        mpl.mpl_figure_comm
    );
}

</script>
</div>
<div class="cell-output cell-output-display">
<img src="https://vuqv.github.io/posts/python/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAH0CAYAAADFQEl4AAAAAXNSR0IArs4c6QAAIABJREFUeF7snQm4TdX/xl/zmKmUKEVSaKI/SqWBlAZknudZyTwlRZE5kXlMZlekohQaVUJRkYhfkTJW5tn/ede6x72uO5xz7j7n7HPO+30eT3H3XsNnrXvOfvf6DmkuXLhwATIREAEREAEREAEREAEREAERCAKBNBIgQaCsLkRABERABERABERABERABAwBCRBtBBEQAREQAREQAREQAREQgaARkAAJGmp1JAIiIAIiIAIiIAIiIAIiIAGiPSACIiACIiACIiACIiACIhA0AhIgQUOtjkRABERABERABERABERABCRAtAdEQAREQAREQAREQAREQASCRkACJGio1ZEIiIAIiIAIiIAIiIAIiIAEiPaACIiACIiACIiACIiACIhA0AhIgAQNtToSAREQAREQAREQAREQARGQANEeEAEREAEREAEREAEREAERCBoBCZCgoVZHIiACIiACIiACIiACIiACEiDaAyIgAiIgAiIgAiIgAiIgAkEjIAESNNTqSAREQAREQAREQAREQAREQAJEe0AEREAEREAEREAEREAERCBoBCRAgoZaHYmACIiACIiACIiACIiACEiAaA+IgAiIgAiIgAiIgAiIgAgEjYAESNBQqyMREAEREAEREAEREAEREAEJEO0BERABERABERABERABERCBoBGQAAkaanUkAiIgAiIgAiIgAiIgAiIgAaI9IAIiIAIiIAIiIAIiIAIiEDQCEiBBQ62OREAEREAEREAEREAEREAEJEC0B0RABERABERABERABERABIJGQAIkaKjVkQiIgAiIgAiIgAiIgAiIgASI9oAIiIAIiIAIiIAIiIAIiEDQCEiABA21OhIBERABERABERABERABEZAA0R4QAREQAREQAREQAREQAREIGgEJkKChVkciIAIiIAIiIAIiIAIiIAISINoDIiACIiACIiACIiACIiACQSMgARI01OpIBERABERABERABERABERAAkR7QAREQAREQAREQAREQAREIGgEJECChlodiYAIiIAIiIAIiIAIiIAISIBoD4iACIiACIiACIiACIiACASNgARI0FCrIxEQAREQAREQAREQAREQAQkQ7QEREAEREAEREAEREAEREIGgEZAACRpqdSQCIiACIiACIiACIiACIiABoj0gAiIgAiIgAiIgAiIgAiIQNAISIEFDrY5EQAREQAREQAREQAREQAQkQLQHREAEREAEREAEREAEREAEgkZAAiRoqNWRCIiACIiACIiACIiACIiABIj2gAiIgAiIgAiIgAiIgAiIQNAISIAEDbU6EgEREAEREAEREAEREAERkADRHhABERABERABERABERABEQgaAQmQoKFWRyIgAiIgAiIgAiIgAiIgAhIg2gMiIAIiIAIiIAIiIAIiIAJBIyABEjTU6kgEREAEREAEREAEREAEREACRHtABERABERABERABERABEQgaAQkQIKGWh2JgAiIgAiIgAiIgAiIgAhIgGgPiIAIiIAIiIAIiIAIiIAIBI2ABEjQUKsjERABERABERABERABERABCRDtAREQAREQAREQAREQAREQgaARkAAJGmp1JAIiIAIiIAIiIAIiIAIiIAGiPSACIiACIiACIiACIiACIhA0AhIgQUOtjkRABERABERABERABERABCRAtAdEQAREQAREQAREQAREQASCRkACJGio1ZEIiIAIiIAIiIAIiIAIiIAEiPaACIiACIiACIiACIiACIhA0AhIgAQNtToSAREQAREQAREQAREQARGQANEeEAEREAEREAEREAEREAERCBoBCZCgobYdjRw50vxJzPbt24esWbOiSJEiWLduXZBHpu5EQAREQAREQAREQAREIPAEJEACz/iSHl5++WX0798/2V4LZMiA3Xfc4d3IrrkGKFsWuPde+98cOby7T1eFPYHDhw/j22+/xddff421a9fi77/DuicrrvuOtx1110oW7Ys7rvvPuTQXgsobzUuAiIgAiIQQAKHDwPffAN89RXw/ffAnj2+daYXxb7xSnC1BEiq8Pl+c3InIH/99RfOnz+PAnnyYDdPSY4cAQ4dAg4eBP76C9i1CzhzJulO06YFbrsNeOwx4NFHgTx5fB+g7nA1gUOHDuHjjz/GRx99hJ9++snsl6QsQ4YMoGgoUKAA8uTJg1y5cpk/Pf06dMjXbp0OHXqFE6cOGH+HDx4EPv378fevXuxe/dunD59Osm206ZNi5IlS+LBBx/Eo48+irx587qamwYnAiIgAiIgAuZ56qOPgFWrgE2bgGS+Q5EhA3D99cC11wJXXmmfqfjiLVMm+6daNQFNBQEJkFTAc/pWPiz++eef5oGRD4CXGX9RqNB/RX4+Wfgp5/sn1OnLr+WYoQnIk8+CVSoAPOLJAtLAmfOnMHKlSvxwQcfmBOPxERHpkyZUKJECdx2220oXrw4ihUrhmuvvRYUCv7YuXPnzF787bffjND54YcfsHnzZnAsCY193HvvvXj66adRvnx5ZMyY0Z8udY8IiIAIiIAIOE+AL9M+/RR4/3174pGY6KCgKF4cuP12+yL3llus8PDzO9T5SUReixIgLlrTFAVIYmPlLxaPDr/+2h4j7tx5+VVU7TVq2D9XXeWiGWsoyRHgacQ777yDRYsWgScfCa1QoULGFapcuXLGNSrQD/48Efnxxx/x+eef47PPPktUJOfMmRM1a9ZE7dq1cSXfGMlEQAREQAREIBQEeNoRE2P/PPP5SO44QbgvvuA++8HSpbUi9ogr5EESJCBJ9edXwIkYYO/QZ8+KH9Q7et+JYuHVC5MtCihT1WlLmSwB9/IFp06Zh+fLl4ElEfMufPz8ef/xx86dw4cIhG/+FCxewc+dOrFixAu+/5l8Sd086pcuTIaNWoECiWZCIiACIiACASFwO+/A9On2+egs2cv7TJfPuCJJ+yzkL6bgrIcSXUiARJS/Jd27ogA8TR54YI9GZk/H1i9+tIjRx4pPv440LIlULCgiwhE91AoPKZMmYIPP/zwEjcrujg98sgj5lSBcRdp0qRxFSi6hDFr27vvvotPPvnkEtHEsVKItG7d2sSjyERABERABEQgIAQYJztlCrB8+eXPPBUrAtWrA6VKya0qIPB9b1QCxHdmAbvDUQESf5R79wKLFtljSGZ98BiFCIOo2rZVwHrAVjXlhuleNX78ePMAHz++g1mm6M7EP1dffXXKDbngCqaSnjdvnnEdO3r06MURMeC9atWqaNWqlQLWXbBOGoIIiIAIRAwBulqNHw8sXXqp8GDA+DPPALVrA8wYKnMVAQkQFy1HwASIZ47HjtkTkVmzLhUiWbPa05C6dQEFEAdtRzCmYu7cuZg6dSqOHz9+sV8Kj4YNG6JOnTrIli1b0MbjZEecT0xMDGbMmAGmC/YY69y0bNkS9erVM9m4fDG6oyUWBO9LG7pWBETANwL8PeULBJkIuI4AY2DnzbOnHvG+Q02mqsaNrfDg843MlQQkQFy0LAEXIJ658heVv7QzZlz6S1ugANC7N3DPPS6iEplD+eabb/Daa6+ZTFPxH86bNm2KunXrmoKUkWDHjh3D7NmzMWvWrEtEVsGCBdGtWzcTQJ+SMd6ENU7+++8/8P9lIiACwSNAN0oml8iXL5/r3D+DR0E9uY4Ak+4MH27LE3gse3agYUOgXj0gTF/euY5zAAckARJAuL42HTQB4hkYMytNmAAsWXLpsSUDtLp0AXLl8nUKuj4FAv/++y9YC2bZsmUXr2SMR7Vq1dC2bVtTryMSjfOeMGGCyegVX0RUqlQJPXr0MPVJkjLeyxo5rDXCEyG3xcBE4nppTiJAAvxd5UsEZuRjWu/kfk9FTASCQuDff4ERI2ych8cYF0lXq3btgNy5gzIMdZJ6AhIgqWfoWAtBFyCekW/bBgwbBmzYEDcXPhB262aLGros6Nkx4EFsiF/kLB44bNgw8ybfY6VKlUL37t1x8803B3E0oetq69atGDJkCDaxAFSs5c6dGz179kRFBgkmMHLbtm2bER6sjyMTAREIPgGe1FKI8HNKLwCCz189GjUMfPwxMHQoQBES9yVqn1WKFhWmMCMgAeKiBQuZACED/nIzgGvUKFuB3WOVKlm3rCuucBGp8BoKYyAGDx5sUtZ67IorrkCnTp1QpUqVqPtCp6hgUUWeBMWPD6lQoQJeeOEFMAbGY2fPnjUChL8bZCYTAREIPoEjR46Yuj8UIOnTpw/+ANRjdBNgHOHAgcDKlXEc+H1AT42nntJL0jDdHRIgLlq4kAoQDwdmk+BpyCefxJFh9ohXXrHp62Q+EVi/fj369euHvcxEFmuPPvqoiX+I9kJ9Bw8eNHEwn7JCbawx29err74KngzRTp48aeqN3HjjjciSJYtP7HWxCIiAMwROnDiB/3vf6amT+bMmZ1pVK2IgDcE6Jnx4otAvO9QPPII0LMnoGK33hB07TUSIC5aGlcIEA8Pvq1/7bW40xC6YTVvDrRpoxzaXuwZptNlzMP06dMvxjzwDX6fPn1AASKzBHga8vHHHxu3LI9rGmNimCmrRYsWJusVBYgefLRjRCB0BDwvAvR7GLo1iLqeWYR30iRg2jTroUHj6XifPkAi7rpRxycCJiwB4qJFdJUAIRe+cejXD1i/Po5SmTL2KFSBXknunH/++ce4Eq1du/biNXfffTcGDBiAa5SLPFFurB/y4osvgidGHuMpCJmRpx58XPRBpaFEHQEJkKhb8tBOmAlyKDTWrYsbx913W0+MMKmJFVqA4dG7BIiL1sl1AoRszp8H3n4bGDs2LlMWPwAYCHbbbS6i546h/Pjjjyagmg/UNL7N79ChAxo1amT+X5Y0AZ4a8cRo4sSJFwsyFi9e3LirFS1aNOpcP5iSme5pdH3x1Sh+uecY7J8pU6YUb6dgZraxsfw9l4UtAcaU8Q9PEFMyZraiyP/888+NwE/OJEBSoqmfO0bg55+B7t2B2O9Q8HuT2a2aNJH3hWOQ3dGQBIg71sGMwpUCxMOHfpi9egF8M0FjICKD06tWdRHB0A5l6dKlGDRoEBg4TWOMB2McPPEMoR1d+PT+ww8/oFevXjhw4IA5MaIAKVGiRNhUg3eK9G+/WaC9EuWLOlTk3xY5D0DBw5E9erVvbqXGY4o8t5++208Qv9qWdgRYNHPUaNGYcOGDV6/7GAiiPfeew+rVq1KNhmGBEjYbYfwHDBLAgwZApw5Y8fPGA++7LzzzvCcj0adLAEJEBdtEFcLEHI6cMCKkB9+iKPWqBHw3HNR/WaCb+7ffPNNzJw58yIXPgBSfFx11VUu2mHhMxSKD54ksQBh165djfggSwoSpQFNfh35UDllyhRs3rzZpwUfOnQo5syZAwpAWXgRoEBgoobRo0ejNqs/e2m8j+mtuV+eYR2FJEwCxEugusw/AvS0eOMNYPbsuPvvugsYPBjQd6h/TMPgLgkQFy2S6wUIWfHt/uuvA/Pnx5ErXx549VUgQqp3+7IlmB2GsQvxMzmxkjlT7CpdpS8kL7+WAegM5PecftCFjYH8fGCKFHc2vq1mHZh169YZt7OyZcuakwv+N6ELFh8wmzRpYirKU+zydKR8+fIYM2aMOb2gnT59GoULF0a7du1MHBKtS5cueP31181b7ocfftj8GyvT00Vr2rRpaNasmfk3plllhfr3338fT7AYqcwRAky0MG7cOPNnx44dZv+2bt3arDvFNJMwMNaJ7nL8zHjsscdMUobrr7/e9M998fLLL5vTqT179iB/vyoV68e+vfvjwwZMphr6DrXu3dvk22P2eJ27dqF22+/3ZyErV692lxz6tQpMBbt3Llz5pTEk1WOY6HojB+zlnDiEiCObAU1khiBEydslqt42RBRpw7QubP1tJBFLAEJEBctbVgIEA+vmBh7NMo3FzQ+APENRt68LiIa2KEwzoMPd7/88ovpiA/FrOpds2bNwHYcRa3zwefnn3828R+ekw8+OPHhLNwFHgVEkSJFjCigzz7FA1MQb9myBb/juef/75S2JAKEAYp3H/febuKJDhw6Za1ib4euvvza7gsUuH3/8cbDgo0eUkOFdd91lMo7xIZenS7fddptxtWJl+vjGtilCeBIic4YAhQELkPKzghnw+PBPcfjSSy+Z2AsKwTp16qBx48ZmbfjvFN+8jid/PEnl/SNGjDDi8ttvvzXZ9Pr27WuECe3ee+81bcVfN8ZTNW/e/KLIpOB544038M0331ziFvrJJ5+YccXfMxIgzqy9WkmBANP+U2h4TmsZ70EvCy9dR8U3vAlIgLho/cJKgJDbt9/aXNxHj1qK+fMDb74JFCzoIqqBGQofENu3b3+xvgcrdbPYIB8EZM4R8Lx55YMYg2b5NpjGN798UOMDuRuM8T58Q+2L8UGQ++XLL7/EfffdZ25l3AeD8J977rmLJ2ueIHQKEIqw7du3I126dOZ6vjknBz64cgx0W5s0aZLJHBbf+NDKPnhax/fuHGjESMJa9F07tzZPMTGr1vjy5wcvZbunXxAcYvRH93HNeb+5N599tlnTeFNj9GtkAkr+IdikKcgHuMeYPIFnqLyJISCkqcW8a+hy2fOnDmNeGGRwNy5c2P48OHmnvj21FNPGcHB+JCqVaua0zXGV8U3pr/OlSuXOaHhyVliphMQt2zCCBrHzp3Wffvvv+2k6EHB+A99h0bQIic/FQkQFy112AkQsmOGno4dgT17LEmm5x0zBrj1VheRdXYofEPNB0TPwy9dIhj8ybeTMmcJxH/wYct0LeHbYRoflvjw5QZ3LD5kLlu2zKfJHz161OwZJi3gG3C6PbEafNZYV8bEXLDKlCmDBQsWXOyHLlSsl0JBzJOLWrVqGYHy/fffXzYWvolnnAdPQnhSklg9Gr4h50Msg9I94/BpUk5eTDcwTyYcJ9v1ty1m/NxjT/88ENUrlzZZJp64IEHLumZnyMUGjyp4FrHt4ceesi42tEtiiKEooGnU4zT4D65Nd7nK08IKWKWLFliREZ8++uvv8zPPCdndMdK7PeFAqZVq1ZmfyRmEiD+bhrdlygBnnhQfPz3n/1xvnzAqFFAkSICFkUEJEBctNhhKUDIb/9+4Nln+frW0uQD1IgRQOnSLqLrzFBYp4JviflwQKObC33wo72quTN0L28l4YMPxQdFCP+dD2V8sKJLludEIFDjSKldf05A2CbdXuh2xbgLzoUP/Q0bNjSuMm3btr3MBYsPpnyb7TH+P2M4PNXiK1WqZPYmT1USmueBN2/evOakhfE0CY3ByHwQZazBtddem9K0A/vzCDgBmT17tllPumnecsstl/D66quvjKhYvny5OeWIb4wjowvWr7/+ak79xo8fb1ypKCwpICkq+NKDgnXNmjXmdIsnJBUTKdDGtubPn29OaHlClpjxu+fJJ580p2+JmQRIYLd6VLXOjJo8qYv9DgV/L+i+rWDzqNoGnKwEiIuWPGwFCBkePmx9OTdutEQZHMlK6g895CLCqRvKZ599ZgI96atPo189g3sTe5BLXU+620MgsQcfuqMwYJpv6c2HWJo0JiYke/bsYQuOc+Lbbrpx8WGTD4sUDPHrgNAFKyUBUr9+feNa9dNPP13Cgg+tvJfc6K7FExe6aiU0xhrwIZXcM2bMGLY83TLwDz74AHSD+uKLL4zY8BhFNEUn3TgTOwF58MEHzUkfxUV8Y9wZT9roSkWXRP6dLnoUNwsXLrws/mzlypXmpOvOO+80Yoaud4w7Smh0IeXJF9uVAHHL7onAcXzxhXXbjv0OBVOMM6lNGH92R+AqBW1KEiBBQ51yR2EtQDi9kydtbRB+yNDop04REgF1Bfh2kYGjnhgEPkzwIZHB0bLAEUjqzSvXgQ/TdGPyiBBmF8qRI0fgBuNwyzExMcaNjHEA+eiCEGt0h2nQoIGZm68ChAKZAoYxIPHTFfNtOYOgmQmL4oQuhIm9ee/YsSM4Lp6AyFJPgGKPLprkyhgNjzEGhMKDRSITxoAwUxZdrCgI6BJVrlw5lC5d2pyKeczjKkcRwhNAxoNQPPJ01mNMcsBMWDfddBNYo4j98DuG7mDx3bCYzIAneDz9YEYsCZDUr7taSITAihU229W5c/aHjHtjzIe+Q6N2u0iAuGjpw16AkCU/XPr3j/OVZlaLQYOARFwDXIQ+2aGsWLHCZJzxiA/6YPfr1y/sszCFA/kXD+4HnxQ5oOWR4TwYY8PY+Fg9M9nimG68dGdjOKJrjKTJ08G31y/9dZbPgsQ+vgzu5UnuJkc+Oabp3V0BeKpB7nxoZYCjmKEAcgeY9FMXkt3H5kzBJgZjyelPFlixrPvvvvOfH4wuxUf/OlCxxMpplimYGFmK57uMTUuhSlFJcUL0+5y3f7880/zb4wf8qT/5okJXesoHj3G2KC5c+eaEzGeevDkhG5WFCos7ukxihPGjvAk5YYbbpAAcWbZ1Up8AhQfffvGZc187DH7nKA0u1G9TyRAXLT8ESFAyJOZigYMAN5/39KlCGGdkEqVXETbu6EkFB/VqlUzKTDdEPjs3QzC+6qUfM/pWsQHeU9CAL71DycRwodRilvWAWHsBt9Sc38x2DixIPSUXLAY0M6TIL5h54MvxQZP6/hwSZcujzijQKHYoMsWhQ6NYo6ubHQNYuC0zBkC3KPMgMWTKYo+psvliYgn4xRTIVOMcE0oQhkPMmjQoIt1QLimjBNi7RbezzWsUqWKOYH1xJ4xDo3Z0LiGPJXl6RZflDCAnfvAYxQ6FByMLylWrJj5Z46Df2d2tKQspd9DZ0iplYgkkFB8MMUuM7HxuUAW1QQkQFy0/BEjQDwihKJj6dI4EUJRkiDY0kX4LxuKxEfoV8ebBx8+4LFiuif1LEVIuLljOUma9SJYwJEnH75UjecbdmZS4sOoL/c5OXa15R8BileeiPB0g6l5vTW6+VGws7AlX65IgHhLTtd5ReCTT4A+feJOPiQ+vMIWLRdJgLhopSNKgHhECGNAFi+OEyH0+Yytxuwi9JcNhS4wdHPwuF3p5CM0q+WNAOHIEjsJ4e9TNCYIOHHihHHt4ttvpuX1xpjOmAUNmVUrYUYmb+7XNaEnwBgOVkRnpixvs8IxxoSikxm5khOd3v4ehp6CRuAaAqtW2ZMOT7FiClyKEZ18uGaJQj0QCZBQr0C8/iNOgHhEyODBwDvv2JkyOxbzfZct6yLylw6FVaUZzEnXB5rER+iWypcHH4mQuHVi9iTGFDDGg4HOKRnFNoORk0rDmtL9+rk7CNDtivEcbdq0SXFADGBnvA+z+yWWGSt+A778HqbYsS6IfALM3saECJ6A8ypVbAyIxEfkr70PM5QA8QFWoC+NSAHiESEvvxwXmM6sF+PGAXfcEWikPrfPgE2mxuQXLu3pp5821aMV8+EzSkdu8PXBhyKEfvCs7kzjW10G1oa8qJ4jNNSICISGgK+/h6EZpXp1BQGm4m/fHjh1yg7n6adt9iuJD1csj5sGIQHiotWIWAFCxnwTwuPY1astceb9ZtGrBMW5Qrkc9JlnGkpPaldmE2JwqLfuDKEce6T27c+DD0UIMwV5smNx/ShClDI5UneJ5hVoAv78HgZ6TGrfhQS2bQOYyvnIETu4Rx8FWFtG4sOFixX6IUmAhH4NLo4gogUIZ8niQzyW9WRbyZ0bYLrP668P+Sr88ccfaNmypXFDoZUtW9akzlQxttAujb8PPgnrhKRPnx4s5Kf1DO16qvfwJODv72F4zlaj9ovA7t1A8+ZA7Hco7rnHFhmk27VMBBIhIAHiom0R8QKErE+cADp0ADZtsuSvu86KkDx5QrYSFB1MeeopvsbiXQzmlNtOyJbkYseeBx+KBxZc88VYXZzCkkHZNIoPtkMxIhMBEfCeAH+HmMqZKYR1kug9t6i58sABKz48BUxvvx0YOxbImjVqEGiivhOQAPGdWcDuiAoBQno8nm3ZEvjtN8uyeHHrjuXjA6YTC8EvVgZsbt682TTHYEwWawunitpOcHBrG0wEsG3bNlPB2Z+MVrz/999/x6lYf2Q+PNEdS251bl1xjcuNBJgljTVImClNAt6NKxTCMR0/bt2ufvnFDqJwYWDKFCBHjhAOSl2HAwEJEBetUtQIEDLfuxdo1gzYt8+uwAMPAMOHA+nSBW1F+IacFYG/+OIL0+fVV19t0pDyvzJ3EGA8BwVItmzZTG0Pf+zMmTPm7S3/S8uePbsp8qZaF/7Q1D3RSIAxVazOTgGi35to3AFJzJkpdrt1Az7/3F6QL5/1aNB3qDaJFwQkQLyAFKxLokqAEOr27UCLFsCxYxYxixT17s3URQFHzgdb1kmIiYkxffEBd9q0abjpppsC3rc68I0Aq5yz2nnevHnNOvnzAHT69GkTmE7RSWM16auuusqvtnwbva4WgfAlwM9JCg+m7L322muRK1eu8J2MRu48gWHDgPnzbbtMLEPxwRMQmQh4QUACxAtIwbok6gQIwX73HfDcc0BszQ08+yzQtGnAkbPy7+jRo00/dCkYM2YMSpcuHfB+1YHvBDyVzplal/vr1GEHDx48OLtdLOjoJGJgAgkTYCCn4I9X758EuzaKHEE5s4FRoywf6fnwpgxQJkyIiQCXhOQAPEaVeAvjEoBQqzLl9s84TSeftAV68EHAwZ89erV6N69+8X2BwwYABbwkrmbAE8vPG5U/o6Ua/mm2/GbrU06NGjB8roS9NfnLovCghkyJBBMVNRsM4+TfHTTwF+h3peCL30kq33IRMBHwhIgPgAK9CXRq0AIVgGrU2YYBEzGJ1HuTff7Dhy1vpo3rz5xUKD7dq1Qwu6gcmihgCrfU+ePNnMl1XCp0yZgmLFikXN/DVRERABEfCbwJYtNomMp9Ag/79tW7+b043RS0ACxEVrH9UChG9SXngBWLHCrsi11wIzZwKsFeKQMd1u48aN8ffff5sWK1dLy4HkAAAgAElEQVSuDJ5++BNT4NCQ1EwICNCNq1+/fljOk7fY5AOzZs1CnhCmgg4BBnUpAiIgAr4RYI2Phg3jksdUrgwMGBCUuE3fBqqrw4GABIiLVimqBQjXgW9UWrUCYlPi4q67gHHjWMAh1atE15327dvj+++/N20VL17cvAXnG3BZ9BFgPEjbtm2xKbYezV133YXx48eD7iYyERABERCBBASYRZAnHRs32h/ccYf1WnDg+1mso5OABIiL1j3qBQjXgml5GzcGWNiIVqWKjQ9JRWYsvvEeOHAglixZYppkNiUGofO/suglwID0Ro0aYV9sKujq1aujT58+0QtEMxcBERCBpAgMGgS88479KdPsvv02cOWV4iUCfhOQAPEbnfM3SoDEMuUJCP1KT5+2/9C1K1Cvnt/A582bh+EMbI+thk2ff56AyESABShbtmwJnojQevfujRo1agiMCIiACIiAh8CiRcBrr9m/8cSDMZv6DtX+SCUBCZBUAnTydgmQeDQZC+J5G80Uf6yUTpcsH239+vVgoPl5FkwC8Oqrr+Lxxx/3sRVdHskEli1bZmJCaKyQPmHCBJQsWTKSp6y5iYAIiIB3BDZsANq1A2JrKJmYD2WN9I6drkqWgASIizaIBEiCxWBe8bfesv/Io97Zs4GrrvJ6xVg8q0GDBmDwOa1p06Z4lnVGZCKQgMDIkSMxZ84c86+5c+cGg9KvueYacRIBERCB6CWwd68NOv/nH8ugQQOgc+fo5aGZO0pAAsRRnKlrTAIkAT++caFgYLFCGt9Kjx/PyoEpgj579izatGmDjbEBc2XLljXFBtOmTZvivbog+giwxshzzz2HtWvXmsnffvvtmDRpkoLSo28raMYiIAIkwKBzJoX56SfLo2xZgMV76ZEgEwEHCEiAOADRqSYkQBIhmTDtX/36QJcuKSKP/0abb7Jnz56NXLlypXifLoheAocPH0bDhg2xZ88eA6F+/fro4sVei15imrkIiEDEEmCVc1Y7p+XPD8yaBeTIEbHT1cSCT0ACJPjMk+xRAiQJNHwDw6D0s2ftBczGUalSkhw/vhjE0xMS58+PaZOnYoSJUq4aKU1FLcSYFA6C1N6Kq4PGTIEFSpUcOtwNS4REAERcJ7AJ58AvXrZdpmanIWBVazVec5R3qIEiIs2gARIMosRPwsHK6UzNqRw4ctu2Llzpyk2eOLECfOzXr16oWbNmi5aZQ3F7QRiYmIwePBgM8ysWbOaeJCCBQu6fdganwiIgAiknsAff9i4j+PHbVt8mafMgKnnqhYuIyAB4qJNIQGSzGKwUnr/sD779uLKD5YKT1z5os3UXRQfFCE0J544gn0799flc5dtMfDYSisG/Piiy/iww8/NMO9+eabMX36dGSOt9fCYR4aowiIgAj4RODkSWZrAbZvt7ep0rlP+HSxbwQkQHzjFdCrJUBSwMtK6fxw3LbNXlitGtC378WbBgwYgKVLl5q/FylSBDNmzNBDY0B3bOQ2fvz4cTRp0uSimK1SpcrFVL2RO2vNTAREIKoJ8CXfe+9ZBHzJN2MGj4GjGokmHzgCEiCBY+tzyxIgXiD73/s8TDf1NBi40GWL19u3lrTsmTJYoLO5TbjBU9dkiSBhO58PE178sknRUwEREAEIo8AvQteftnOi27O9DAoVCjy5qkZuYaABIhrlgKQAPFyMfiGhm9qaFmzYs+wYajbvTv41prGkxC6X8lEILUE6IbVN/aUTcI2tTR1vwiIgCsJMO6DNT5iYycxcCDw2GOuHKoGFTkEJEBctJYSIF4uBuNBXnoJWLYM5y9cwJpDh9Atd26cTZsWTz31FF72vMXxsjldJgLJEYjv2lesWDFMmzZN9UG0ZURABCKDAOt9NG8ObNli51O1KhDrTRAZE9Qs3EpAAsRFKyMB4sNi8LSjYUP8/d13ptL5R3ny4IvSpU3GImYukomAUwSY3ID1QX7/XfTZKNGjfD888871bzaEQEREIHQEWBxQbpb0W64wdb7oAuWTAQCTEACJMCAfWleAsQXWsC6OXOQoXVrZLhwwWS6yj5pEq5noUKZCDhMYOvWrWjatOnF+iBjxozBvffe63Avak4EREAEgkjg22+BDh1sh6z3waDzW24J4gDUVTQTkABx0epLgHi/GAcOHECdOnVQmnU/9u5Fvnz5kIdZO+bPB/Lk8b4hXSkCXhKYM2cORo4caa7OkycP5s2bZ/4rEwEREIGwI/DPP0DdusDBg3boXboAeoEXdssYzgOWAHHR6kmAeLcYrNNAF5g1a9YAFy5gOIAH06RBGt7+wAMAHxLTmL/JRMAxAtx3nTp1wldffWXaLFeuHEaNGoW0adM61ocaEgEREIGAE2AcZefOwJdf2q7KlQNGjQL0WRZw9OogjoAEiIt2gwSId4uxcOFCDBkyxFx85ZVXYsGECcjZpg1w6JBtoE8foHp17xrTVSLgAwHGG9WtW9fEHdG6detm/i4TAREQgbAhMG8eMJyv7sxxLsC/6zQ3bJYvUgYqAeKilZQASXkxGAhcv359nGJRQgCjR482b6LNm5xOnWwDrFg9Zw5QsGDKDeoKEfCRwLfffosOsX7TGTNmBF2zbrzxRh9b0eUiIAIiEAICO3bYWlqnT9vOx4wBFM8WgoVQlxIgLtoDEiDJL8bZs2fRvHlzbN682VxYq1Yt9OzZM+6m114DFi2yfy9RApg6FUif3kUrrKFECoFhw4ZhPuONABQvXtyk5k2vvRYpy6t5iEBkEjh7FmjaFPjlFzs/xnww9kMmAiEgIAESAuhJdSkBkvxiTJw4EZMnTzYXsco53zxn5mmHx1hEicWUWFSJ1qoVQNcsmQg4TODkyZNo0KDBxdS8bdq0QSvuN5kIiIAIuJXAxIlA7HcomLSFKXczZnTraDWuCCcgAeKiBZYASXoxfvzxR7Ro0QLnz583Qb8zZswwb54vM56O8A3P+fM2oG7KFOCOO1y0yhpKpBD4+eef0axZs5T3ZKRMWPMQAREIXwLxvxvTpbMpd4sVC9/5aORhT0ACxEVLKAGS+GIcP37cvG3etWuXuSDFt80UHRMm2Mauuw6YO1eFlVy0zyNpKPFP5RgHMnv2bGTKlCmSpqi5iIAIhDsBxkzSO+B/7Mzad3a/pGJQAgJSICEEH7CriVAEl+MwYMHIyYmxvzwtttuw9SpU5GOb3CSsnPnrPvVpk32ijp1gO7dXbTSGkqkEGBcEk9BtmzZYqZUr149dO3aNVKmp3mIgAhEAgGmpmdiFho9B6ZNU3xkJKxrmM9BAsRFCygBcvlifPfdd2jXrp35AeM9GPfB+I8UjaclTI8amy0LkyYBpUqleJsuEAFfCezcudOc0J2OzSozfvx4lC5d2tdmdL0IiIAIOE9g3TqgbVvbLuM9Zs8GChVyvh+1KAI+EpAA8RFYIC+XALmULl2vWGNhz5495gc9evRA7dq1vV8Cul6NGGGvL1DA5jrPksX7+3WlCHhJIH6V9Hz58pkMWdmyZfPybl0mAiIgAgEgcOyY9QD4+2/buKqdBwCymvSXgASIv+QCcJ8EyKVQhw4digULFph/LFWqFCZMmOBb1WkGotPP9YcfbMNyxQrArlWTJMDkCO3bt8c6vm0EULNmTfTq1UtwREAERCB0BF59FViyxPZ/993A+PGqdh661VDPCQhIgLhoS0iAxC3G+vXrTbA5jUG9fKNMPj6bXLF8RqYb/CPAkzqe0DFFL40B6nfzS18mAiIgAsEmsHYt0L697TVrVusBkD9/sEeh/kQgSQISIC7aHBIgdjFOnDiBOnXqXHS96tatm3HF8tvkiuU3Ot3oGwEKZRYppBUoUADz5s1DFrn9+QZRV4uACKSOwPHjNgYy1n0ZPI2tWTN1bepuEXCYgASIw0BT05wEiKUXv8p0yZIlzZtk1v7w2+iKxdOU77+3TcgVy2+UujF5AnTFat26NX6IdfurX78+uqjSsLaNCIhAMAkMH25PPGhMvsK09Kn5Dg3m2NVX1BCQAHHRUkuAABs2bDAPcDS6Xs2dO9e7rFcpraNcsVIipJ87ROCPP/4wJ3bMipUmTRqTNvoOFcN0iK6aEQERSJbAxo1Ay5bAhQv8ErVC5PrrBU0EXEdAAsRFSxLtAoS+83xw2717t1kVvjnmG2THLL4rFlP58u8qGucYXjUUR+Dtt9/GG2+8Yf7hhhtuMEI6I1NgykRABEQgUASYCrxePeD3320PnToBDRsGqje1KwKpIiABkip8zt4c7QJk9OjRmDlzpoF65513YvLkyalzvUq4PHTFYoFCviGiNWsGdOjg7CKqNRGIzYrFAoU/yz4dG0aVM8++yzYiMCIiACgSMwdiwwfbptv0QJ+/9yvQocb7WcKgISIKnC5+zN0SxAtm7dikaNGpl0pnxTzDfGfHPsuO3cCfBU5cwZgNXU334bKFrU8W7UoAjs2LHDFCg8c+aMEdIzZsxAcVYhlomACIiA0wR++QVo3Jg5wW2Vc1Y+L1zY6V7Ungg4RkACxDGUqW8oWgUIRUeTJk2wZcsWA5GVz1u0aJF6oEm1wKro/EPjA+GMGXpLFDjaUd3ytGnTMG7cOMOgaNGioGtWOgpfmQiIgAg4ReDsWSs+fv3VtsjK54wDkYmAiwlIgLhocaJVgMSvIl24cGHMnj0bGTJkCNzK0E+WfrE7dtg+VB02cKyjvOWzZ8+ak71t27YZEp06dUJD+WRH+a7Q9EXAYQJ0XR492jZ68832ZJ+nIDIRcDEBCRAXLU40CpCExdv4xjgoGYM2bQJ4ysJMIZkzA6y4riJNLvptiJyh/PTTT2A8yIULF5A5c2YsWLAA+bXXImeBNRMRCCUB1vqoVQs4dcqe5PNEX66eoVwR9e0lAQkQL0EF47JoEyB8IHv++eexZs0ag7dmzZroxYJJwbIhQ4CFC21v995r3yClSROs3tVPFBEYOnSoER60++67D6NGjTIpemUiIAIi4DcBvkB7/nkg9jvUFB/s1s3v5nSjCASTgARIMGmn0Fe0CZAVK1agT58+hkrevHmxcOFCZM+ePXgrcuyYfXO0b5/t85VXgMqVg9e/eooaAkePHkWtWrWwf/9+M+fBgwejYsWKUTN/TVQERCAABD7+GOjd2zZ89dX2hVq2bAHoSE2KgPMEJECcZ+p3i9EkQA4fPmxOPA4dOmR4sfr5ww8/7Dc7v2/8/HMbA0LLlQuIibH/lYmAwwRWrVqFHj16mFavvPJKxMTE4IorrnC4FzUnAiIQFQSOHKHbAHDwoJ3usGFAKL5DowK2JhkIAhIggaDqZ5vRJEBeeeUVvPvuu4bUQw89hOHDh/tJzYHbevYEVq60DVWrBvTt60CjakIELiVAl8OuXbvic4reULgcakFEQAQih8DgwfaFGa18eWDECLkQR87qRsVMJEBctMzRIkA2bNiA1q1bG/JZs2Y1b4Kv5vFxqOzAAaB6deD4cTuCadOAO+4I1WjUbwQT+Pvvv40r1okTJ0wMyNSpU4OTdCGCmWpqIhB1BOInUcmSxbpe5csXdRg04fAmIAHiovWLBgHCtKT169cHi7TR6JJSu3bt0K/CvHmA5xSGaQxnzbKFCmUi4DCB+Gmnb7rpJpN2Or1SZjpMWc2JQIQSYM0PpvLevt1OUGnkI3ShI39aEiAuWuNoECAzZ87E6Nh85awKzerQrBIdcjt3zhZy2rrVDqVzZ6BBg5APSwOIPALnzp0zhTd/YeViAB06dDBpemUiIAIikCKB+DU/br0VeOstvSxLEZoucCMBCRAXrUqkC5C9e/eiRo0aOHnypHE/oRgpVqyYe1bgp58APggytWHWrNa/NpSuYe4ho5E4TIDio3Hjxjh/jwyZcqERYsWIZ9cKBymrOZEIMIIJKz5QfHhpu/QCMOt6QSWgARIYPn61HqkCxC6WzETEI1+8D0Z/O02GzQIeOcdO6oKFQDWCpGJQAAIMPHCPLr+AXjkkUfAWiEyERABEUiSAN2tYpNYoF49oGtXwRKBsCUgAeKipYtkAcJigx07djS08+TJYwLPc+TI4SL6sUM5fBioUQP45x/7D3QXK1fOfePUiMKeAGuDVK9e/WIqaromltNeC/t11QREICAEvvrKFh2kXXmlfVGmmh8BQa1Gg0NAAiQ4nL3qJVIFyOnTp02g+e7duw2H/v3748knn/SKSUgu+uAD4KWXbNcFCgCsYJ0pU0iGok4jm8CyZcvQr18/M0n+/rNaesaMGSN70pqdCIiAbwROnwaYrCX2OxSvvgo8/rhvbehqEXAZAQkQFy1IpAqQyZMnY+LEiYZ0yZIlMWnSJBMD4lpjDEibNsCGDXaIrVrZv8tEwGECrA3ClNTff/+9abldu3Zo0aKFw72oOREQgbAmMGUKMGGCnUKpUgC/T938HRrWsDX4YBGQAAkWaS/6iUQBwlMPnn7wFITZrubOnQumHnW9MU0wfWyZHStDBmD+fKBgQdcPWwMMPwLbt283qakZkM7TD7on5s+fP/wmohGLgAg4T4CB56x4zlMQZoycOxcIh+9Q50moxQgjIAHiogWNNAHCt7udOnXCV/RdBdCoUSM87/FhdRH3JIcyZoxNcUi77z7gjTfCYdQaYxgSGDlyJFgfhFa+fHnw7zIREAERQLduwKefWhD169u6HzIRiAACEiAuWsRIEyCrV69G9+7dDWFWOuebXVY+Dxs7ccIGpO/bZ4f8+uvAAw+EzfA10PAhcOzYMZOi+sCBA7Fb7XU8oL0WPguokYpAIAisWQPEJm9R4HkgAKvNUBKQAAkl/QR9R5IAOXXqFGrWrIm/vrLzHLw4MGoWLGii2h7OZQVK4A+fezF111nA9IVJOwlPF3mC4GPPvoIL7zwgrmFLlgLFy40NUJkIiACUUiALld16gC7dtnJv/IKULlyFILQlCOVgASIi1Y2kgTIlClTMCE2aK5MmTIYO3asuwPPk9oHCQPSO3SwxQplIuAwAbostm3bFuvXrzctMzidf2QiIAJRSGDaNGDcODtxBZ5H4QaI/ClLgLhojSNFgPz999/GnYSnIAw8Z7G1woULu4i0j0PZtg1o0AA4fx7InNnmX1eFdB8h6nJvCOzYsQP16tXDuXPnFJDuDTBdIwKRSICeAww8P3XKBp4zPqxIkUicqeYUxQQkQFy0+JEiQPr06YMVdF0CE0nVQ9dIqNbKKtV0v6I99hgwcKCLdo6GEkkERo0ahVmzZpkpVahQAUOGDImk6WkuIiACKRFg7OTq1fYqBZ6nREs/D1MCEiAuWrhIECAbNmy46DaSK1cuLF68GFdccYWLKPs5FFZIf+YZ4L/bAOTJtljcZkIOEwgYYV01tC5++67He5FzYmACLiSwLffAnT1peXJY0/cs2d35VA1KBFIDQEJkNTQc/jecBcgdBtp2LAhttFlCTABtc/woT1SjF8EgwbZ2dx8M8C31OnSRcrsNA8XEXj33XfxCoNOzVa72ZyIpNNec9EKaSgiEAACrDvF+lOsQ0Xr3x948skAdKQmRSD0BCRAQr8GF0cQ7gKEaXaZ7Yp26623YubMmSYGJGKMMSCNGgFbt9op9ewJ1KoVMdPTRNxDgEUJmzRpgi1btphB9e7d28RVyURABCKYAN186e5LK1ECmD7dxoDIRCACCUiAuGhRw1mAHD58GNWqVQP/S5s6dSruvPNOF9F1aCgbNwItWtjGcuQAFi8GcuZ0qHE1IwJxBDZu3IgWsXstZ86cxp0xB/ecTAREIPII8LuzWjUg9jvUiI/bb4+8eWpGIhBLQALERVshnAXI0KFDsSA2SLty5coX3UdchNe5ofTrByxbZtvjW+nevZ1rWy2JQDwCffv2xYcffmj+pW7duujGqsgyERCByCMwbBgwf76d1xNPAAMGRN4cNSMRiEdAAsRF2yFcBcj27dtRv3590G0kS5YsWLRokal8HrG2f78VHsePA2nSALNnA0WLRux0NbHQEdi3bx+qV6+OkydPRkZK69ChVM8i4F4CjPmoW1ep3t27QhpZAAhIgAQAqr9NhqMASVg8rUOHDmgWDYX6Zs4ERo+2S/1/weMH2/FiEwEHCZAd8bx3F8AypYtizfffDM8i3o6zEXNiUBEEGCx2+eeA775xk6nXbs4N9+ImKAmIQKJE5AAcdHOCEcBsnLlSvRkMDaAAgUKYOHChaaAWsTb6dM2AP3PP+1UR4wAHnww4qetCQafAAt61qpVC3v27IndaiPwoPZa8BdCPYpAIAh88QXQubNt+dprgZgYIFOmQPSkNkXAVQQkQFy0HOEmQE6fPo2aNWtG74PRqlVAjx52B11/vS1UmCGDi3aUhhIpBFatWoUesXstqoR+pCyg5iECiRE4cwaoUwf44w/709deAx59VKxEICoISIC4aJnDTYAwze7oWDekMmXKYOzYsdHlGsKj8zZtgA0b7C7q0sVWrZWJgMMEEro6Pvvss2jatKnDvag5ERCBoBJgLalRo2yXJUvaArdy5Q3qEqiz0BGQAAkd+8t6DicB8s8/5i0u8eOHTOiY/bs2SgajYHYrNPQuDFAMcKK70uWKC2vi36nImkoLPDZoEEDk+wha9asWLJkCfKwUrJMBEQg/AgcOgSwUO+xY1Z0UIzcckv4zUMjFgE/CUiA+AkuELeFkwAZMmSIifegVa1aFS+++GIgkIRHm6xW+957dqy1a8e5ZYXH6DXKMCIwaNAgvPPOO2bEzI7Vp0+fMBq9hioCInCRwKBBQOzvMqpWBaL5O1TbIioJSIC4aNnDRYDs2LHD1CTwpN3lm9grr7zSRSSDPBSm5a1eHThxwlatnTcPKFw4yINQd9FA4NChQ+bk8fjx40rLGw0LrjlGJoFffwUaNLAn51mz2pNznWZG5lprVkkSkABx0eYIFwHSsWNHrFmzxpBr3749mjdv7iKKIRrKlCnAhAm283Ll4lL0hmg46jZyCUybNg3jxo2L3WrlLsZhRe6MNTMRiCACFB1MtbtunZ1Ux47WjVcmAlFGQALERQseDgLk66+/xnPMWQ7gmmuuMe4gmZQyEDh50p6C7Ntnd9SYMcC997pod2kokUKAaXnpfrV3714zJdYFueeeeyJlepqHCEQ2gS+/BDp1snMsUACgK3M0pK6P7FXV7PwgIAHiB7RA3eJ2AXLu3DnUq1cPdMGivfLKK6hcuXKgcIRfu8uXx/nx0gVr7lwgXbrwm4dG7HoCy5cvvxh3ddNNN2Hu3LnGJUsmAiLgYgLnztmK5zt32kEOGQJUqODiAWtoIhA4AhIggWPrc8tuFyA87WAQLK1EiRKYPn26Hnrir/L58wCrwP/8s/3XXr2AmjV93ge6QQRSIsD4K6bh3bx5s7n0hRdewDPMqCMTARFwLwEGncd+h+KOO4CpU5V2172rpZEFmIAESIAB+9K8mwUI0+3yAYdBsLSpU6fizjvv9GV60XHtpk2AJyYmVy5g8WKbnlcmAg4T+OGHH9CyZUvTKtPxMhkE0/PKREAEXEjg+HGgWjUg9jsU06bBiBCZCEQpAQkQFy28mwUI/cxnzJhhaFWsWBGDBw92ETmXDYWpUVessINq1Ah4/nmXDVDDiRQCrI7OKum0Fi1aoB2DW2UiIALuIzB+vD3xsF+igL5D3bdGGlFQCUiABBV38p25VYDs2bMHNWvWxOnTp5EhQwbExMSgAIPnZIkT+OsvoEYN4PRpIEMGYNEiIH9+0RIBxwns2rULtWrVwtmzZ5ExY0YsXrzYJIeQiYAIuIgAk5PQRfLUKSB9eiAmBrjuOhcNUEMRgeATkAAJPvMke3SrAGGxsxWxb/QbN24MpuGVpUCAWbDeeste9MQTwIABQiYCASEwcuRIzJkzJ3arPYEB2msB4axGRcBvAvGL1davD3Tp4ndTulEEIoWABIiLVtKNAoRBrhQdtFy5chk/8+zZs7uImkuHcuQIS8QDhw/bAc6aBdx6q0sHq2GFM4HDhw+b4oT8L23mzJkoXrx4OE9JYxeByCEQv+gg4wHffRfIkSNy5qeZiICfBCRA/AQXiNvcJkAuXLiANm3aYMOGDWa69DevXbt2IKYemW3yrfTIkXZupUsDLB6XJk1kzlWzCikBpuEdMWKEGUOpUqUwceJEpNFeC+maqHMRMJXOO3QA1q61MDp3thXQZSIgApAAcdEmcJsA+fLLL9EptmDS9ddfj4ULFyI9/Vdl3hFgDAjT8O7ZY68fPdpWSZeJgMMEzpw5Y14OMCaERres8uXLO9yLmhMBEfCJwJo1ttI5TUUHfUKniyOfgASIi9bYTQKEdQbq1q17sejgkCFDUEEFk3zfLYydYVYs2k032eKEKhjnO0fdkSKB1atXo3v37ua6QoUKYd68eUinQpgpctMFIhAQAiw6WK8eEFu412S9YvYrmQiIgCEgAeKijeAmAbJ06dKLway33XabKToolw4/NguLEzZtCsQWjEO/fkCVKn40pFtEIHkCdJlkKt5NrEWj4oTaLiIQWgLxiw7efjtM3Q+5RYZ2TdS7qwhIgLhoOdwiQE6ePInq1atjH1MHApg0aZLxK5f5SYAxNK1b25uvvhrgF1PmzH42pttEIGkCGzduNCKEdtVVV5m0vFmyZBEyERCBYBJQ0cFg0lZfYUpAAsRFC+cWAcLTjrFjxxoy9COnP7kslQSYdvHzz20j7dvHVUtPZbO6XQQSEujatSs+++yz2K3WHs2bNxckERCBYBKYOBGYPNn2SNflIUOC2bv6EoGwICAB4qJlcoMA+ffff1G1alUcO3YMadOmNX7khQsXdhGlMB0K/YDr1gXokpU1q03FmDt3mE5Gw3YzgZ07d6JOnTpgHFfWrFnx7rvvIrf2mpuXTGOLJAIHDwLVqgEnTtiigwsXAtdfH0kz1FxEwBECEiCOYHSmETcIEKbyZEpP2jPPPIMXXnjBmcmpFWDgQGDxYkuiTh0gNmBYaETAaQIDBw407of4kF4AACAASURBVFc0JpPo1q2b012oPREQgcQI8LSDokOf89ofIpAsAQkQF22QUAuQP/8EzVq1MDZs2eRKVMmU3Qwb968LiIU5kM5cMC+GTt5EmB2opgYvRkL8yV16/D3799vihOeOnXKpM5etGgRCjANqEwERCBwBJgGm6nXmQGLJ91LlgB58gSuP7UsAmFMQALERYsXagHSp08frGDaWMAEsrZr185FdCJkKPINjpCFdP80xo0bh2nMvAOgUqVKGDRokPsHrRGKQDgTYMr12O9Qk3jEk3wknOeksYtAgAhIgAQIrD/NhlKAbN68GY0bNzbDzpUrl/Ebz5Ytmz/T0D3JEUiYHWX6dIApGmUi4DABxnExnotxXbSZM2eiePHiDvei5kRABAyBLVuARo0sDJ568PSDpyAyERCBRAlIgLhoY4RKgLB+QNu2bbF+/XpDo0ePHqaqsixABBYtAl57zTZ+1102W4rywwcIdnQ3O3/+fAwbNsxAKF26NHgqono+0b0nNPsAEWB2w7VrbeM9egD6Dg0QaDUbKQQkQFy0kqESIF999RWef/55Q4JjWLhwITJkyOAiMhE2lLNnbRD677/biY0aBdx/f4RNUtNxA4EzZ86gVq1a2L17txnO6NGjUa5cOTcMTWMQgcgh8O23QIcOdj6MtWJ8n75DI2d9NZOAEJAACQhW/xoNhQBhqs569erht99+M4MePHgwKlas6N8EdJf3BFauBHr2tNcXKQLMmQOkTev9/bpSBLwkwLguxnfRbr75ZsyePduk2JaJgAg4QICp1el6tXWrbYzZDh97zIGG1YQIRDYBCRAXrW8oBMjSpUsxYMAAQ6FEiRKYMWOGXDSCsScuXACaNAE2b7a9vfIKULlyMHpWH1FGgC8ZmjZtCsZ50fr3748nn3wyyihouiIQIAIMOo8V+LjlFuDtt/UyKUCo1WxkEZAAcdF6BluAnD592tT62Lt3r6EwadIklCpVykVEInwo9Bem3zAtf36AsSE6to/wRQ/N9NatW2fivGjXXHONqRGSMWPG0AxGvYpApBA4c8am3f3zTzujN98E7rknUmaneYhAQAlIgAQUr2+NB1uAzJkzByNHjjSDvO+++/DGG2/4NmBdnXoCClxMPUO14BWBjh07Ys2aNebazp07o0GDBl7dp4tEQASSILBgATB0qP1hmTLA2LFKKKLNIgJeEpAA8RJUMC4LpgA5fvw4qlSpcjFFJ8VI0aJFgzFN9RGfAN1iYtMfK3WjtkYgCWzbtg3169cHs97lzJkTdL9Uqu1AElfbEU0gYUr1mTMBpbmO6CXX5JwlIAHiLM9UtRZMAUJ3K/6hPfbYYxjIwDlZaAj06gV88ontm24yLVuGZhzqNeIJ9O3bFx9++KGZZ+vWrc0fmQiIgB8E+P0Z+x2KRx+NS63uR1O6RQSikYAEiItWPVgC5J9/jEFyngKki5dOsTExOD66693EYkoG8off1g/YmZTYeGqpUtZDTLKIGi6wSDAdLw1atTAuXPnkDVrVlNwNHfu3MHoWn2IQOQQOHQIqFYN4ClIunTAwoVAwYKRMz/NRASCQEACJAiQve0iWAKEcR90uaLxYaR3797eDlHXBYrAoEHAO+/Y1umb37lzoHpSu1FOgKm2+dKBRpesLl26RDkRTV8EfCTA4p7z59ub+PKIp9gyERABnwhIgPiEK7AXB0OA/P333ybzFQuUZcqUCUuWLEHevHkDOzG1njKBffvsG7XTp20mrMWLgXz5Ur5PV4iAjwQOHDhgTkBPnTplCo4yI1Y+7TUfKeryqCXAjFc1agAsKJs5M/Duu8CVV0YtDk1cBPwlIAHiL7kA3BcMAcKaHww+pTVp0gTPPfdcAGaiJv0iMHo0wEBGWpUqQL9+fjWjm0QgJQJvvvmmqfljt1oV9NNeSwmZfi4ClkDfvkBsHBVatADatRMZERABPwhIgPgBLVC3BFqA7Ny5E3Xq1AELk2XPnt0IkRw5cgRqOmrXVwKHDwNVqwJHjthCVvPmAYUL+9qKrheBFAkcPnzYnIIcOXLEVEWfP38+ChUqlOJ9ukAEoprAtm1AvXoWQc6cNl4vW7aoRqLJi4C/BCRA/CUXgPsCLUB69OiBVatWmZF36NABzZo1C8As1GSqCPCtNItZ0R56CBg+PFXN6WYRSIrA9OnTMZZ1CwA88sgjGOqpZyBkIiACiRPo1g349FP7M8bpqZaOdooI+E1AAsRvdM7fGEgBsnnzZjSOrTeRJ08ek/0mS5Yszk9CLaaOwMmTNhbkwAHbzvTpwO23p65N3S0CiRA4ceIEqlWrhoMHD5qfzpw5E8VVx0B7RQQSJxC/ZhPjJpcsATJlEi0REAE/CUiA+AkuELcFUoC0b98ea9euNcPu2bMnatWqFYgpqE0nCCxaFJdTvlQpYOJEVdd1gqvauIzAwoULMWTIEPPvZcqUwbhx40RJBEQgMQKMl/z6a/sTZr1i9iuZCIiA3wQkQPxG5/yNgRIgFB4UILT8+fNj0aJFJvuNzKUEmF2FAnHXLjtABqeXK+fSwWpY4UyA2fCYinvPnj1mGhQgFCIyERCBeAS+/x5o1cr+Q/78AF8S6TtUW0QEUkVAAiRV+Jy9ORAC5MKFC2jatCl+/vlnM9hXXnkFlStXdnbgas15AitWAH362HaLFgVmzbKB6TIRcJjA8uXL8eKLL5pWS5QoYbJjpUmTxuFe1JwIhCmBCxeANm2ADRvsBF56CXj66TCdjIYtAu4hIAHinrVAIATI6tWr0b17dzPLIkWKmAKEzHojczkBVkVnzM4vv9iBvvYa8OijLh+0hheOBJgVjwUJt2/fboY/bNgwPPzww+E4FY1ZBJwn8O23zNpi273hBmDBAlv9XCYCIpAqAhIgqcLn7M1OCxA+WDDtLtPv0l5/XU88MADzg5arQWOwJo1QMeO+uILHGG1HEvg888/v1gRnel4mZZXLyq0PaKeAE8/mjYFYj0IMGgQUKlS1GMRABFwgoAEiBMUHWrDaQHy3nvvoX/mZ0d9xxB6ZOnSrXCofWKijN8MuPfsc/GC709F/ULBHYyd01WzRogU2bdoUu9VewtNyM4nGraA5xyfw+edAly72X4oUAebMkSusdogIOERAAsQhkE4046QAOX36NKpXr46/7bDG3SpEkoxYxKsvAiQL/j1q3tmK+91gY/ZswYXnPQaMOCwIYNG9A6dq/ly5cP77zzDjJqr4XF2mmQASBAN1jW+WDxQdqIEcCDDwagIzUpAtFJQALERevupACZO3cuRvADE0ygVA6jmUlJFp4Enn0W+OYbO/YePYDatcNzHhq16wl07NgRa+j6B6Bbt26oW7eu68esAYpAQAh8/DHQu7dtmvVx3npL6dADAlqNRisBCRAXrbxTAuT48eOoWrUq/vnnHzO72bNn45ZbbnHRTDUUnwjEL4B15ZXAu+8CmTP71IQuFgFvCGzduhUNYqs7586d2xQszZo1qze36hoRiBwC587ZFz2/27n9OabwD33RM78NBMRcAEBCRAXLIJnCE4JkGnTpl0sKFapUiUMYuCcLLwJMJPZ6tV2DgxMj61qH96T0ujdSKBPnz5YwTTQgKkf1Lx5czcOU2MSgcAReP994OWXbfslS9KHWacfgaOtlqOUgASIixbeCQFy+PBhVKlSBUePHjVZbGJiYlCwYEEXzVJD8YvAjh1AnToAA9Nz5ADeew/Ils2vpnSTCCRH4Pfff0etWrXALHpXXHEFli5dav4rE4GoIHDmDFCjBhBbnNOID8VPRsXSa5LBJSABElzeyfbmhAAZP368yXZFoxDp16+fi2aooaSKAIvFLV9um2CwsCc4PVWN6mYRuJzAgAEDjPCgMTtWu3bthEkEooMAE32w7hKNbld0v5KJgAg4TkACxHGk/jeYWgHCmA/GfjAGJH369CaLTf78+f0fkO50F4Fdu+ybOWZnoV8+T0Fy5nTXGDWaiCCwZ88ek0Xv7NmzJgaEsSCMCZGJQEQTOHUKqFYN2L/fTpOB5yVKRPSUNTkRCBUBCZBQkU+k39QKkDfeeANvv/22aZkuFD179nTR7DQURwgMHAgsXmybYhyIp1ChI42rERGIIzBkyBAsXLjQ/EPDhg3RqVMn4RGByCbAOh8jR9o5MuVubCbJyJ60ZicCoSEgARIa7on2mhoBcuDAAeNyxfofzN3PN5Z58+Z10ew0FEcI7N1r39DRTzlTJpsR66qrHGlajYhAfAL79+83J6r6TNG+iAoCx48DVasCsdkjMXcucPPNUTF1TVIEQkFAAiQU1JPoMzUCZOjQoViwYIFpmWk0O3fu7KKZaSiOEuAbOr6pozFVJGuDyEQgAARGjRqFWbNmmZZ1qhoAwGrSPQSmTwfGjrXjqVQJUPZI96yNRhKRBCRAXLSs/gqQv/76C88884zx186SJYs5/ciTJ4+LZqahOErg0CH7pu7ECSB9euuSxSrpMhFwmADjyniyeuLECcWVOcxWzbmIwJEjzNoC8L9p0wJ0PbzhBhcNUEMRgcgjIAHiojX1V4C8+uqrWLJkiZkJc/Yzd78swgmMGwdMm2YnyS9OZTuL8AUP3fTGjRsH1hayW02Z9UK3Euo5YAQmTACmTLHNP/008NJLAetKDYuACFgCEiAu2gn+CJBdu3ahRo0aJmd/9uzZTerMHKwTIYtsAocPW+Fx9Kje2EX2Sod8dkeOHDHCg/9VbaGQL4cG4DSBf/+1n6WMAeGJ8jvvAMoe6TRltScClxGQAHHRpvBHgLDOx7Jly8ws2rZti5YtW7poRhpKQAnwrTRPQmjyWQ4o6mhvnCcgPAmhPfbYYxjIbGwyEYgEAqNHAzNn2pnUrAn06hUJs9IcRMD1BCRAXLREvgqQHTt2oE6dOrhw4QJy5sxpTj+yqTq2i1Y0wENJmLWFgelFiwa4UzUfjQRYW4inIP/++y/SpEmDuXPnokiRItGIQnOOJAIHDth4Otb/yJgRoCvz1VdH0gw1FxFwLQEJEBctja8ChHU+Vq5caWbQsWNHNGZdCFl0EYift758+bgc9tFFQbMNAoHZs2fj9ddfNz099NBDGD58eBB6VRciEEACQ4cCsdkjUb8+0KVLADtT0yIgAvEJSIC4aD/4IkC2bt1q0u3SmPGKpx+ZM2d20Ww0lKAQOH3a1gXZt892x1SSt98elK7VSXQROHXqFKpVqwbWB6HNnDkTxYsXjy4Imm3kEPjrL+CZZ4CzZ4EsWWxNJWWPjJz11UxcT0ACxEVL5IsAYZ2PL774woy+e/fuxhVLFqUEGDTpyVlfpkxcXEiU4tC0A0cgJiYGgwcPNh3ce++9GDNmTOA6U8siEEgCr7xiRQeteXNA2SMDSVtti8BlBCRAXLQpvBUgP/74I5o1a2ZGfs0112Dx4sWm+rksSgnwDR6DJ3fvtgCYUvL/i9KYWjagSRw5swZk3Vvz549ppvJkyejZMmSgexSbYuA8wT++MN+Zp4/D2TPDixdCih7pPOc1aIIJENAAsRF28NbAcI6H2vXrjUjf+GFF0wRQlmUE2AmNE8tkDvuAKZOBdKkiXIomn4gCLz33nvo37+/abpUqVKYOHGiCUyXiUDYEOjbF/jwQzvcdu2AFi3CZugaqAhECgEJEBetpDcCZN26dSbdLq1AgQJYtGiRqVAsi3ICfJNXty6wY4cF8cYbwH33RTkUTT8QBM6dO4datWrhD75FBjB27FiULVs2EF2pTRFwnsBvv9nPygsXgJw5gffeA7Jmdb4ftSgCIpAsAQkQF22QlAQI0+2yzsfGjRvNqAcMGIAnnnjCRTPQUEJKYNUqoEcPO4RbbgHeftsWKZSJgMMEVqxYgT59+phWGYj+1ltv6RTEYcZqLkAE+BnJz0ra888DjRoFqCM1KwIikBwBCRAX7Y+UBMiaNWtMul3ajTfeiAULFpjKxDIRMAT4Ro9fpr/8YoEwxeQjjwiOCDhO4Pz586hfvz62b99u2h45ciTKMw20TATcTGDLljjBcdVVtu6Hske6ecU0tggmIAHiosVNToDw9IN1PrbwAxQwmWgqVqzootFrKK4gsGYNi8LYoRQuDMybp1MQVyxM5A3is88+Q9euXc3Ebr75ZrBOiF6IRN46R9SM+NnIz0gaT0Jq146o6WkyIhBOBCRAXLRayQmQTz/9FN26dTOjLVq0KGbNmqUvexetnWuGwlMQBlRu2mSHNGAAIDc91yxPJA2EL0WaNGmCzZs3m2kNGjQIlSpViqQpai6RRICuy55g83z5AKYvV/bISFphzSXMCEiAuGjBkhIgdHeoV68efmPwHGCqET/wwAMuGrmG4ioC69YBsYkKcN11QEwMoEQFrlqiSBnMN998g2effdZM54YbbjBuoenSpYuU6WkekUKAL2b4mbh+vZ0RMwZWqRIps9M8RCAsCUiAuGjZkhIg8QM+b7vtNkyfPl0Bny5aN1cOhUW1YlM1gyknWS1dJgIOE+ApSJs2bbBhwwbT8ksvvYSnn37a4V7UnAikkgA/Cz2FBgsWBBYuBCSUUwlVt4tA6ghIgKSOn6N3JyZAEqa8HDduHMqw2rVMBJIjQBcsVvelXXMNsHix3A20YwJCgOKjdevWpu38+fOb1OAZMmQISF9qVAR8JsDTD34W/vijvXXgQOCxx3xuRjeIgAg4S0ACxFmeqWotMQGiol+pQhrdN3fqBHz5pWXQvTtQp05089DsA0aAblh0x6L17t3bVEuXiYArCHzxBdC5sx3KTTcBc+cqMYcrFkaDiHYCEiAu2gEJBciZM2fMF/mePXvMKCdPnoySJUu6aMQaiqsJbN0KNGhgh5gnD7B0qVJOunrBwndwDERnlj5a3rx5sWTJEmTKlCl8J6SRRwYBFmht2BD49Vc7n2HDgIcfjoy5aRYiEOYEJEBctIAJBQhdGV577TUzwnvvvRdjxoxx0Wg1lLAg0LMnsHKlHSpTUMY+JIbF2DXIsCLAlLxMzUvr0qWLqRMiE4GQEuBnHz8DacWKATNnAmnShHRI6lwERMASkABx0U6IL0CY8apatWrYv3+/GeHMmTNNxWGZCPhEYMcO63pFP+gcOYD33gOyZfOpCV0sAt4Q2LZtm8nWR8uTJ485BcmaNas3t+oaEXCeAE8/+Nm3c6dte/RooFw55/tRiyIgAn4RkADxC1tgboovQIYOHWqqC9MefPBBjBgxIjCdqtXIJ8CUk8uW2Xm2aQO0ahX5c9YMQ0KgT58+YNY+GuNCmjZtGpJxqFMRMJ95/Oyj3XknMGWKTj+0LUTARQQkQFy0GB4BwkwyJUqUwKFDh8zo5s6dayoNy0TALwK7dwPVqwN8I8jTD56C8DREJgIOE/jf/6H2rVrg7WLcuTIgaVLlyJ79uwO96LmRCAFAmfPAkyE8Oef9sJJk4BSpYRNBETARQQkQBxcDH75FipUyNTp8OfNn0eA5M6dG4ULFzYjY2VhVhiWiUCqCDD1JFPx0vhWOrZ4XKra1M0ikAiBl19+Ge+/775CdPzelL0CpYIBI0Aq5x7vjeZtn7cuKB1rY5EQAS8IyAB4h0nr65ySoAwewwLDqZNm9ZUFr7xxhu96l8XiUCSBPbutcUIz5yxmbCYEYuZsWQi4DCBP/8E9WrVwdrGDEGhKnEc+bM6XAvak4EkiBw+rT9rNu3z14wYwZw223CJQIi4DICjgiQTp064fXXX4/66txOCRAW8brjjjvw1FNPgW8TZSLgCIHhw4F582xTDBbu2tWRZtWICCQkwFPbd/gWGkCTJk3w3HPPCZIIBIcAP+P4WUcrXx6IjaUMTufqRQREwFsCjggQZmuiz++8efMuZj3ZtWsXXn31VUycONHbsYAVdbt3745169aZ9sqWLYuBAwea/9K++OIL9O3bF9999x0yZ86Mp59+GsOHDzd55z3G7FG9evXCypUrceHCBZO+dtiwYSamgvbff/+hf/+ePfdd8E3dUWKFDEpI5t7qkYD5sSBX5rHjx832acOHz6M8uXLmzS4RYsWvdgXv2DZ1q+/opixYqhX79+eOaZZ1LtgkUBwnofbL9AgQJe89OFIpAsgYMHgSpVgFOnAFaqXrLEVkmXiYDDBPbt22ey+J0+fdrUA2EsyJVXXulwL2pOBBIQOHECqFoViI2fxJw5QLzvbPESARFwDwFHBAgf9Hv27IlPPvkE48ePx4wZMzBnzhw0atQIb775plez5UM+xcDDDz+Mli1bmi8uCpgtW7bg999/x8aNG1GxYkVUqFABHTp0MAHaL774Iq644gojSLJkyYK/vrLuC5de+21RqgwCHLAgAHgycRPP/2EbNmyoUyZMti7d68RDoyzYKrICRMmGKHDDC40CpB/0X999/8W+nn/+eRMI/vXXX5tr6FZQtWpV1K1b1xTg+uGHH0wbR48edUSA8OTDMx6vAOoiEfCGAGvJvPWWvZKB6bF73ptbdY0I+EKAmfuYQIPG9LysEyITgYAS4Gebp15WxYrA4MEB7U6Ni4AI+E/AEQHC7nniUaVKFWzatAm1atXCqFGjkC9fPq9H9s0335jTii+/BL33XefuY+nGTxB4fE9H/QpUvigny5dOvNznjywNsYbb7xhhAJPT8aOHYsdO3Zc7Jui5J577jFCaPfu3Wjfvv0lfbAdCp7Zs2ebExHmr6cASZMmDbZv336xLwqZl156CQcOHDBv8kqXLm3GQPHjsSFDhpjTl9QGoWfIkBE7duzC1VdffQm/tGmB9Onj/omurkkZay3xJbfHfLmWYQIsG5GYJWzXqWvZV8aMcT0m127Ca5nwhAmekrL47aZ0LZl56lQF6tpz5wD+ScrijyGla7kfuC9oXl175D/g6adx7thJnEubAViwAEjklM3ndmPHwHUgt6SMv7qxv75mzUJ9Lfc595o3403p2vi/n4G6luNM7nfZTZ8RBw8eNC9pTpw4g/TpMyImJgbXJDhx8+XzRJ8Rcbs0oJ8Rvnye+HFtwH7vDx/F2SrVgcOH7Yfi7NlAoUIXofn72ZPS73L8dlO6Vp8Rdjl8+b335dpgfUYcP34a6dJlQKZMKmqZ9Ldnyj/xWoDwdIKZTW699dbLWuUD/MKFC81JAGMX+LDOE5AHHngg5RHEXsGTA55InD17FnXq1METTzxhTjsYxEhXKJ50UGDwVCS+0VXppptuMicZFBo85aD7VWLGdr/99ltzIhLfPv30U3Py8sEHH5h+KUB4UsIAcI9NmzYNLVq0MKcxdPliP5wnT1o8tnPnTjOH5AQIa3t46nskHCPFEl3PMmXKi169YgPo4l3ETLwNGsT9AxMbJfXwxLj1+Cn4hw4Fjh9PfDny52e2mrifjRoF/Ptv4tfS261Dh7ifjR0LxNZKvOyGXLmATp3i/pmZEPfsSbxd1ivr0SPuZ4wbTLBMF3/IL98XXoi7lt8z27YlvdXih9FwSTdvTvpaHgh4BAs9lH74Ielru3ePq+n3wQcUo0lfSw7kQWOZhDVrkr62fXvAoz0/RTgn6SMJT08+uGrr4CPP076Wu4Hk89g0iSsff0rLPvvPoCb6uGHL7uJRaw9ngtkQBZJWa1aQKyHI37+GVi4MOlrGRt6113257/+CuMhkZQ98QTABDY07gXuiaTs0UeB2PcWJvPm5MlJX/vQQwD/0BinmlyCHNYtq1TJXsvfCf5uJGV8J/Hkk/anx44Bw4YlfS0ZkAWNgiK5RHesP1q7dlxbyYWFue0zgm6rw4Ydx9mzuY2basLvBH1GxK2rqz4jAKxdG1c+KLGd7LrPiEFzMOPNo3aoiXyu6TMiDo2eI+wLWn+fIxo1eg+bNp3Fxo3PJP0hr5+kSMBrAcK4BJ5OMB6jXLlyePvtt82DP40Fp3r37n0xXmHt2rXmFIRuTr6ko926dasRGBQ6dIGi+GjYsKGJrWCK2qS/+EuDfdJF6v/+7/8uHvsnvP7RRx/FkSNHwNOW+PbLL7+YL0eegtSvX98IkIceesi4knmM/9+sWTNQZGTMmNHMla5bbVjYLdZOnjxpXMGSEyB0rSKX5Cx79vzo2jU2f3m8C932cMGhSYDYBQorAXL0KNY+1APL9txlX0XVrAnkzn3JlnTdw4UEyMX1CScBwpi7u++ehuPHs5lTZb4EomusxyRAJEASfhf69ZLiv/wv0dbYcbuivYzjRXQE9Q6kgCRAIm/1/wVIIxvu/+0Th6tCD27In35jbFx21dkJCA1wKEAoCZrigsmB6WD/E8JUjK/vjjDxMkztgNX43pGykoKHIYU+J5aO/cubPxJU5oFCp0xaJbFNM9MhYlvq1atcqICoqkxE5AVq9ejUceeQQfffSRqbuRkgChaxlPQOiSRXHkMbpwkVNqT0Aobnbs2H3ZPN3kXuEZnFywLAlf3LVScpUKinvF9Jk4NyY2N36FCgCP0+KZXLAsDLlXWA6+uEEkvHb8+MmYPHmqaefJJ580sXse86Vd3iM3TUsuKJ8RKbiKuuozYswYnJ8xE2cvpLNHi716Xfb9KRcsi0TPEXFbwxf3bM+1r732GmJiluDChTTYsOHSl9mXbTr9Q7IEvBYgrVq1wuLFi028BLNKMQib7krJGd2qvK2CS/gdu3a4ccff7wkdoRF+Ro0aGAED/2H6SblsRMnThhBxHEwtoPZrBgzwlMKT/wEYzb4QM/4DJ5cMFYkfpwJ26JrFcUOlW2uXLlSFCAUKHQl8MSk8M0ejScinENqY0A4XsaryEQgYASULSZgaNXwpQT4PcD4QH5eqraRdofjBOJn9+NTIv1FE8RPOt6nGoxKAnv27DE1jhgqwBffn3/+eVRycGrSXguQY8eOgScQTLXL/6dRHNx9992X/PG3aB7jH5gql2luGcjNY/r58+dj8uTJJqbjzJkzRmjwCJ+ChKckTMHLEw3GcDD+g4Hwd911FwoWLIgXXnjBpOplPnpuGqb45d95SrJ/34Tv8F4OGTeJAAAIABJREFUDaaHZOA6TzM8NTdSOgHhz5kSmKcmrNVBNywGxNN9jG1LgDi1PdVOQAkoX35A8arxOAJ0YfVkROQpMz+XZSLgCAHVN3IEoxpJmQCfG/nMSOPL+LZt26Z8k65IkoDXAsTTAtPj8kGe7kx8s7V+/XqTmYqB4jwJ4AkCRckKRtr6aMwoxaBu1gFhe0ypy1S0rK1BoxBh/AR/ztMM9sO/M12uxxjP0aNHD9CtitcwloMnNhQbNJ6IUOBwE/GNHIPqO3bseFkdkORiQDwii65eHB9PbQoVKoShQ4catzMJEB8XXpeHhkDCisHTpwO33x6asajXiCbA02pmxGL6dBrT8zJmTyYCqSKwd691uaIvcObMAB8O8+RJVZO6WQQSI8Cwgpo1a5pEQUyKxGdI/lfmPwGfBQi7YtE+PsR7ivJxQVivg8KAf3ja8BVT8sh8IsD4EcaRyAXLJ2y6ODUEWK3a8zaaMV3JpYRKTT+6N+oJMDOiJwPggw8+CNYJkYlAqggwdm3xYtsE0/w9+2yqmtPNIpAUAcauLV++3PyYrvZ03ZeljoBfAiR1XerupAhIgGhvBJ0Ao+dr1IDJXUubOBG4++6gD0MdRj4Bnp6zOjpj7WgzZ840yUNkIuAXgV277GcXC4tky8bqwJdlvvKrXd0kAgkIsLYc3f9ZdJuJjhgDzRgQWeoISICkjp+jd0uAOIpTjXlLYNkywJPN7c47gSlT4qoxetuGrhMBLwgsWrQIzCJDY+FZ1gmRiYBfBPiZxc8uGtPhsyiSTAQCQIAeP57sqnTZZ807WeoJSICknqFjLUiAOIZSDflCgG8QmTd/50571+jRACvwyUTAYQJMJlKjRg2TGITGJCMsJisTAZ8I7NhhP7NYepz1Pnj6wVMQmQg4TIAJhlgfjpYnTx4T+8E4aFnqCUiApJ6hYy1IgDiGUg35SmDlSqBnT3tXsWL0j9EpiK8Mdb1XBOi+4CnGWqpUKZM63ZPK3KsGdJEI8LOKn1m0jh0BvZHWnggQAWZ/ZdZTWvfu3Y0rlswZAhIgznB0pBUJEEcwqhF/CPAUpGFD4Ndf7d3DhgEPP+xPS7pHBJIlwBTqrN/ErDK0cePGJVvUVjhF4BICW7cCDRrYf2LGK2a+0htpbZIAEGCG02bNmpmWWYeOtfCYXVXmDAEJEGc4OtKKBIgjGNWIvwT4lqdzZ3s301azTgjL5spEwGECTNPOFOY0pltn6nKdgjgMOVKb69QJ+PJLO7vu3a0rlkwEAkCABa7Xrl1rWmZtOU9JiAB0FZVNSoC4aNklQFy0GNE4FPpTN28O/PijnT1TXD72WDSS0JwDTICp2+vVq4fffvvN9PT666/jgQceCHCvaj7sCWzaZD+jaNdcY1Pw6o102C+rGyfAGncsMk1jaQQm0EifPr0bhxq2Y5IAcdHSSYC4aDGidSh829O+vZ19wYLAwoVAunTRSkPzDiCBTz/9FN26dTM9sKbUrFmzkFYnbgEkHgFN87Mp9o00+va1RQhlIuAwAabbbdWqlSmyTWMF9CeeeMLhXtScBIiL9oAEiIsWI1qHwlOQtm2B9estAaa6rFIlWmlo3gEkwC95prNkEVvakCFDUKFChQD2qKbDmsC6dfaziXbddUBMDKA30mG9pG4d/Jo1a8B0u7RChQph/vz5ejkSgMWSAAkAVH+blADxl5zuc5TAxo2Ap8prvnwAq6XLzcFRxGrMEtAXvXaCVwT4YoSfSXTBog0YAOiNtFfodJFvBPRixDdeqblaAiQ19By+VwLEYaBqzn8CfPuzZo29v0cPoHZt/9vSnSKQBAF+2bds2RIb/7+984CSotq68CZnEFBUfKICggKioCiGZ0AfIv6SJWeQHFRyVkCySFCS5JwFVAQDGHmKCoiKoII+UEAkSc78a9+aHgYE6e6p6r7Vvc9as0hV9577nWKmd917zqHo1VEHPSeXIsDvRQlvpFUgQ4+JlwR0NNRLuuePLQESOdaXnUkC5LKIdEGkCPBYTJ06zmw5cwKLF6vUZaTYx9k8SZM9+T1w/vz5SvaMs2fgH5fL3Q9+L9q40bls0CCgVCkREgHXCag4hutI/3FACZDI8v7H2SRALAqGXHF2PlascEi0bXtOkIiNCLhMIGm5y+7du6OCkotdJuzj4fg9iN+LaAULAtOmqTy4j8Nps+sqDx7Z6EiARJa3BIhFvOXKZQiwRGr16gDfQGbLBrz5JpAxo7CJgOsE1q9fj4YJ5VXV8Mt1vP4dkA1S+T1oyxZnDcOHA/ff79/1yHNrCahBauRDIwESeeaXnFE7IBYFQ644BFjqctky5/fNm59LThcfEXCZwLPPPotPExrMdezYEVWVd+QyYR8Ot3SpU4mPVrQoMGECkCKFDxcil20nsGTJElNul3bnnXdizJgxao7qcdAkQDwGHMrwEiCh0NK1ESGwdStQpQrAN5GZMwNLlgBZs0Zkak0SXwQ2btyI2rVrm0XnzJkTixcvRvr06eMLglZ7jsCpU0DlysDvvzt/N2YMcNddIiQCrhM4efIkKlWqhB07dpixx48fjzvuuMP1eTTg+QQkQCx6IiRALAqGXDlHoE8fJwmdxmMygUaFYiQCLhPgzseKhLyjtm3bok6gEILL82g4HxBg+e9+/RxH774bGDXKB07LRT8SYOGLAQMGGNfvu+8+jBgxwo/L8J3PEiAWhUwCxKJgyJVzBPhWqGJFgG8kM2RwxEiOHCIkAq4T2LJlC6pVqwaW582WLRvefPNNZFTekeucrR/wxAmny/muXY6rkycDRYpY77Yc9B+B48ePm6IXf/75p3F+6tSpKFSokP8W4kOPJUAsCpoEiEXBkCvnE2Dpy7lznb+rWRN4/nkREgFPCPTo0QPvvPOOGbt58+ZoFGiK6clsGtRKAjNnAkOHOq49+OC531vprJzyM4GZM2diaMKz9vDDD2PIkCF+Xo6vfJcAsShcEiAWBUOunE9g926gfHng+HGnK/qiRUCuXKIkAq4T2Lp1K6pUqQLW5M+cOTOYHJpVeUeuc7Z2wCNHnO81+/Y5LlKMFChgrbtyzL8Ejhw5gvLly2Pfvn0m4XzWrFnInz+/fxfkM88lQCwKmASIRcGQK38nwHOxU6c6f8/E9M6dRUkEPCHQp08fk4ROY3le9gmRxQmBiRPP5XuULn0uDyROlq9lRo7AxIkTMSoht+jxxx/HSy+9FLnJNRMkQCx6CCRALAqGXPk7gf37gXLlAL6hTJUKeOMNIHdukRIB1wmwGk3FihVx6tQpZMiQweyCZM+e3fV5NKBlBA4ccL7HHDrkNBucNw+44QbLnJQ7sUDg4MGDKFeuHPhrypQpwUT0PHnyxMLSfLMGCRCLQiUBYlEw5MrFCbAU5vjxzr899RTQq5dIiYAnBAYNGoS5CXlHLM/LPiGyGCfAt9HcAaFRiAR6gMT4srW8yBNgnw+W23UetXLoqWct4kGQAIk48ktPKAFiUTDkysUJHDzonM/mm0q9odRT4iEBVqXh+ewTJ04gbdq05kjWVVdd5eGMGjqqBPbudb63HD0KpE7t7LBee21UXdLksUlg/79RnQwByR16tRYuHAhcms3P+LBlgCJOHIJEIuQy5VwCEyaBLz2mnOnzmiHQ1D3BElg2LBhmD59urmandHZJ0QWowRYiYgJ506wAcU6RgMd/WUNHz4c06ZNM46w4EVn5TNGJSgSIFHBfvFJtQNiUTDkyqUJMAeENfr5xpI2axZw880iJgKuE2B1Gr6pPHr0qHlT+cYbb+BavRV3nXPUB/zjD+d7ysmTQLp0wJIlQM6cUXdLDsQegd27d5vvKdpZjX5sJUCiH4NEDyRALAqGXPlnAknr9D/0EPDyyyImAp4QYJUaVquh8UgW+4TIYowAqw/xyBWtbl2gTZsYW6CWYwuBpLlltWrVwnPPPWeLa3HnhwSIRSGXALEoGHLlnwlc2Kl4yhSgcGFREwHXCRw4cMC8sTx06JCq1bhO14IBt20DKlcGzpwBMmVydj+yZbPAMbkQawQurK7HvLIcOXLE2jJ9sx4JEItCJQFiUTDkyuUJLFgA9O/vXFeyJPDqq5e/R1eIQBgEJkyYgNGjR5s7n3jiCbBPiCxGCHBHK6HzPZo0gfmSiYAHBHr37m1KetPUX8gDwCEOKQESIjAvL5cA8ZKuxnadAM9r883l9u3O0OPGAcWLuz6NBhQBVqt56qmn8Ndff5mOxXPmzEHevHkFxu8ENm8GqlcHzp51dj344ZC7IDIRcJnAL7/8gmrVquHMmTPIkiWLqaqXNWtWl2fRcKEQkAAJhZbH10qAeAxYw7tP4K23gBdecMYtVswRISlSuD+PRox7Aqxaw+o1tFKlSoFnuWU+J9ChA7BypbMI5n0w/0MmAh4QYAW9FStWmJFbtmyJBg0aeDCLhgyFgARIKLQ8vlYCxGPAGt59AqdPOyUz/c/Z2wew+JxLJkIuEzg2LFjJgl9z549ZmSW573llltcnkXDRYzAhg3nBAcrXi1eDKRPH7HpNVH8ENiwYQPqJohb5nxw9yNDhgzxA8DSlUqAWBQYCRCLgiFXgifw3ntAly7O9YUKAUxI1y5I8Px0ZdAE2Bk9sPPxwAMPgH1CZD4l0KoV8PnnjvPs+cEXGTIR8IBAq1at8HnCs8adEPYUkkWfgARI9GOQ6IEEiEXBkCvBE2D1mlq1gJ9+cu5hSV6W5pWJgMsEWLu/YsWK+IN9IwBTnrdo0aIuz6LhPCewZs25ZHN2oGZBizRpPJ9WE8Qfga+/hpNmzY1C2e38wULFiCNnjUrHgQJECvC4DghAWJRMORKaAQ+/hh4/nnnnvz5nY7GKVOGNoauFoEgCCxatAh9+/Y1VxYvXhxjx441iekynxBgwvkzzwDr1jkO9+oFPPWUT5yXm34icPbsWVPt6ttvvzVuswpW2bJl/bSEmPZVAsSi8EqAWBQMuRIaAX6oqF8f+P57575+/YDSpUMbQ1eLQBAETp06ZY5QbN261Vw9YsQI3HfffUHcqUusILBq1blGgzfcAMydC6RKZYVrciK2CHz88cd4PuHFGKvmzZ492/QSktlBQALEjjgYLyRALAqGXAmdwBdfsLyIc1+ePMC8efpgETpF3REEgffeew9dEvKOChQoYBLS9cEiCHDRvoTHNevUATZtcjxhH6H/CfaXmn+GCTAcrs1atTAZpZ6NieDX8ZDOhpsVaQlQCwKhwSIRcGQK6ET4C4Iz9ryfDdNRytCZ6g7giLADxesarNx40Zzfb9+/VBaO25BsYvqRe++C3Tt6rhQoABLmemoZlQDEruTL126FD179jQLLFKkCCZNmqSjmpaFWwLEooBIgFgUDLkSHoG1a53z3TQll4bHUHcFRYBVbVjdhsbvnfPnz0fq1KmDulcXRYHAqVPA008D27Y5k48YAejoXBQCEftTnjx5EpUrV8b2hCa5o0ePRokSJWJ/4T5boQSIRQGTALEoGHIlfAKtWwP/a9zf+fOQJUq4Y+lO0XgEgSYYNq8eXN89dVX5goeyeKHDpmlBFjpikeuaHfeCYwZo3LdlobK727NmzcPAwcONMu4++67MWrUKL8vKSb9lwCxKKwSIBYFQ66ETyBpg7GrrgIWLQLSpQt/PN0pApcg8N1336E+ix8AyJkzp2kwll7N7Ox7Xo4dA8qXBxKaSGLSJOC22+zzUx75nsDRo0dRoUKFxIalU6dORSH2p5JZR0ACxKKQSIBYFAy5kjwC7dsDH37ojPHcc06fEJkIeECAjcVWrFhhRuaRrIAg8WAqDRkugcmTgVdfde5++GFgyJBwR9J9IvCPBCZPnoxXE561UqVKJTYuFTb7CEiAWBQTCRCLgiFXkkfg55+BGjUAJqZnywYsXgxkzpy8MXW3CFyEwC+/IJq1aqBielZsmQxuyBZs2YVK1sIHDjg7H4cPOgknM+eDeTNa4t38iOGCBw8eBDlypUDf2VVvDlz5uCmm26KoRXG1lIkQCyKpwSIRcGQK8kn0L07sGyZM06jRkDz5skfUyOIwEUIsMHYkiVLzL/Uq1cPrZmHJLODAJPNp051fClXDkioTGSHc/Iilggw12PixIlmSU899RR6sRKjzFoCEiAWhUYCxKJgyJXkE/j9d4BJwax+w3P53AXJmTP542oEEbiAwM6dO1GpUiWcOHECadOmBbul58qVS5yiTWDXLqBCBeDECSBtWmDhQuCaa6LtleaPQQJ79uxB+fLlcezYMaRJkwYLFy7EtddeG4MrjZ0lSYBYFEsJEIuCIVfcITB4MDBnjjMWq2GxKpZMBDwg8Morr2DGjBlmZIqRroF+Ex7MpSGDJNCvnyM6aMwDYz6YTAQ8IDBo0CDMnTvXjFy9enW0Zx6izGoCEiAWhUcCxKJgyBV3COzd67wBPXLE6YrO7ujski4TAZcJ7N+/35z/PnLkiDn/zb4gefSsuUw5hOH+9z+n7we7n2fMCPCI3BVXhDCALhWB4Aiw3wdfOpw6dQoZMmQweWA5cuQI7mZdFTUCEiBRQ/3iSVALAqGXHGPwLhxAL9o/nPuV4A7s2gkUTAEBg/fjzGsL8EYDqjs0O6LEoEuNv5/vvO5M2aAY0bR8kRTRvrBHr06IF33nnHLLNhw4Zo0aJFrC85JtYnAWJRGCVALAqGXHGPAHc/uAvC3RAaE1JVl909vhopkQB3P3gOfN++febvpk+fjltuuUWEIk0gaS8gvolmLyDugshEwGUCmzZtQq2EMu/ZsmUzux+ZVXHRZcreDCcB4g3XsEaVAAkLm27yAwGezR00yPG0RAmAnWlTpPCD5/LRZwRYenMwc48A3HvvvRg5cqTPVhAD7vIN9OrVzkI6dgSqVo2BRWkJNhJg75/PP/cuNauXTvUYPl3mS8ISIBYFCYJEIuCIVfcJXDypJOEzspYNDaKKlnS3Tk0mgiABZdOoEqVKuC5cBqPZN11111iEykCFB6BIzC5cwMLFgBp0kRqds0TRwRWr16deNwqd+7cJu+LVfBk/iAgAWJRnCRALAqGXHGfwLvvAoHKRAULAtOmOY3JZCLgMoGlS5eiZ0K/iSJFimDSpElIoR03lylfZDg2Hq1XD+ARLFqfPsATT3g/r2aIOwJsPFqnTh3wCBatb9++KFOmTNxx8POCJUAsip4EiEXBkCvuE2A1nDp1gIQfGHjpJeDxx92fRyPGPQF+OOFRjM2bNxsWLNFZqlSpuOfiOYAPPgA6dXKmuflmgGWR9ZLBc+zxOMHy5cvRrVs3s/SCBQti2rRppvqdzD8EJEAsipUEiEXBkCveEPjiC6BlS2fs664D5s/X8QxvSMf9qB9/DGef/55w4HleNkjIHXq1HHPxTMAbDjKXI+tW50phg0DHnjAs+k0cPwSuPCY5WuvvYZ77rknfoH4dOUSIBYFTgLEomDIFe8IKEHVO7YaOZHA2bNn0aRJE6xdu9b8XefOnU1uiMwjAsz16N/fGbxYMaf0to69eQQ7voedPXs2hgwZYiBQeFCAyPxHQALEophJgFgUDLniHYEffnCOYtFUotM7zhoZ3333HerXr5/wqOXAokWLkFHlYN1/Mi4stT1pEnDbbe7PoxHjnsDhw4dNqW02HqWp1LZ/HwkJEItiJwFiUTDkircEmIzOpHRakybOl0wEPCDAnY/3ExriPfPMM2jatKkHs8T5kGPHAq+/7kB49FFg4MA4B6Lle0Vg1KhRmDhxohmeSedMPpf5k4AEiEVxkwCxKBhyxVsC27Y5ZXlPn3YalLFRGXdDZCLgMoFt27aZo1enT59G+vTpzS7IlVde6fIscTzc7t1Oo9Fjx4BUqZy8ruuvj2MgWrpXBHbv3m12P44fP27yuRYuXAiW35X5k4AEiEVxkwCxKBhyxXsCfEs6b54zT7VqQIcO3s+pGeKSABsTskEhrVKlSugaKAcdlzRcXjSr2b3xhv4fu4xVw/2dQL9+/YzooLHKHRsPyvxLQALEothJgFgUDLniPYE9e5w3p0eP6s2p97TjeoZ9+/aZN6dHjhwxpTopRm666aa4ZuLK4rdsAapXB1himzuZixcD2bO7MrQGEYGkBH799VdUrVoVLLHNPK4lS5bgiiuuECQfE5AAsSh4EiAWBUOuRIaAzo5HhrNmMefGeX6c9tBDD+Hll18WleQSYJnjjz92RmF1u4YNkzui7heBixLo0KEDVq5cmfCotUBDPWu+f1IkQCwKoQSIRcGQK5EhcGH1HCYXFi0ambk1S1wROHbsmDl+tWvXLrPu119/HcVYLlYWHoE1a84Vj8iVC+DRmPTpwxtLd4nAPxBYv359ouBg/tYbb7yBDBkyiJnPCUiAWBRACRCLgiFXIkeAH1z69XPmY+lOihD1D4gc/ziaicc2evfubVZcpEgRTJo0CSn0rIX+BPDIFcsbb9jg3NuzJ1CuXOjj6A4RuAwB9vNh9bp169aZK5m/xRcJMv8TkACxKIYSIBYFQ65EjgArYdWoAfA8OW3AAOCxxyI3v2aKGwI8P87k1c2bN5s1Dxw4EI+ybKwsNAIsoR1I5M+fH5g5E0iZMrQxdLUIBEFgxYoV6Nixo7nyhhtuwNy5c5GK1dZkvicgAWJRCCVALAqGXIksgVWrgDZtnDlZVpGlPNOmjawPmi0uCKxatQptEp6166+/3nygSZMmTVys3ZVFnjjhlNDevt0ZbsQI4L77XBlag4hAUgInT540iecspU0bOnQoHnzwQUGKEQISIBYFUgLEomDIlcgSOHsWaNkSWL3amfe554BatSLrg2aLCwI80tGiRQt8+eWXZr18u8oPObIgCXC3Y+hQ5+K77wZee01HJoNEp8tCIzBz5kwjOmh33nknxowZoyOToSG0+moJEIvCIwFiUTDkSuQJ/PijIzooRrJkcUp6Zs0aeT80Y8wT+OGHH1CnTh2zTpbyXLx4MTJlyhTz6072Ag8eBMqXBw4ccIaaPh245ZZkD6sBROBCAgcOHECFChXAX5mnNW3aNNyiZy2mHhQJEIvCKQFiUTDkSnQIvPgi8Oabztw1awIs8ykTAQ8IdO/eHcuWLTMj169fH61atfJglhgbcuRIYMoUZ1FlywIJCf0xtkotxwIC3PngDgjtySefxIv82SCLKQISIBaFUwLEomDIlegQYInUihWB48eB1KmdXJB/Ss6vmjWmCawfft2VK5cGTxnnjZtWsyfPx+5mX8kuziBHTuAypUB5oAwZ4bV6669VrREwHUCzPl4+umncerUKaRLl86U3c3FUs+ymCIgAWJROCVALAqGXIkegdGjgQkTnPlZDYtVsWQi4AGBESNGYOrUqWbk0qVLo1+gHLQHc/l+SFa9YvUrGo+vtW3r+yVpAXYSYF4Wq1/RGjVqhObNm9vpqLxKFgEJkGThc/dmCRB3eWo0nxJQc0KfBs5/bh8+fNicM9+3b59xnt3Si6oR5t8DuX79uS7nV1wBLFoEZM7sv4DLY+sJsN9H48aNjZ85cuTAokWLkDFjRuv9loOhE5AACZ2ZZ3dIgHiGVgP7jUDS5oT8QMgdETWM81sUfeHvwoULE3c+ChcubJoTplRPi3OxY9PBBg2A7793/q5zZ6cMr0wEXCbAPj0NGjTA9wnPWrdu3VCRR3JlMUlAAsSisEqAWBQMuRJdAmxOWL068Msvjh8DBwJqGBfdmMTo7KdPnzbNCbckNMLs27cvypQpE6OrDWNZ77wD9Ojh3Jg3LzBrFqBGcGGA1C2XI7B8+XJQdNDy5cuHWbNm6WXA5aD5+N8lQCwKngSIRcGQK9En8OmnwLPPOn5cdx0wb56aE0Y/KjHpweeff55YBevqq6/GggULkD59+phca0iLOnYMqFQJYHEIGqtg3XtvSEPoYhEIhsCJEydMUYgdLHZgHrWRuFfPWjDofHuNBIhFoZMAsSgYciX6BNgPpEULIKFhnOmUXrdu9P2SBzFJoG3btvjss8/M2tiosGHDhjG5zpAWNX48MGaMcwu7nbPruUwEPCAwZcoUIzpoFB6B33swlYa0hIAEiCWBoBsSIBYFQ67YQSBpc0ImIjL5NUcOO3yTFzFF4JdffkG1atXAc+gZMmQwpT+vvPLKmFpjSIv580+nJDZ3QZgTM2cOcNNNIQ2hi0UgGAIsAsFiECwKwfwrHr3iESxZbBOQALEovhIgFgVDrthDgKVRmZROYxfmwHl0ezyUJzFCYNCgQZg7d65ZTbly5dCzZ88YWVkYy0jaFLRqVaBjxzAG0S0icHkCLH/NYhA0Jp0H8kAuf6eu8DMBCRCLoicBYlEw5Io9BPbudd7EHj7sVMKaPh0oWNAe/+RJzBDYv3+/eRN76NAhpEiRAjNmzECBAgViZn1BL+SHH5zjjjwGmSWLs/OYLVvQt+tCEQiWwI8/ohatWrh7Nmzptwudx5z5swZ7O26zscEJEAsCp4EiEXBkCt2EaDoGDbM8alYMWDcOJXltStCMePN9OnTMSzhWbvrrrswevRoI0bixig6mjQB1q51lvz880DNmnGzfC00cgQoOpo2bYo1a9aYSdu0aYO6yvOLXACiPJMESJQDkHR6CRCLgiFX7CJw8iRQrRqwdavjV/+wH/+Y5eP8iYmCLAaT9WqVfHbb7+Z9bz88st46KGHYmJtQS2CHagDx63y5HFyP9KkCepWXSQCoRD44IMP0KlTJ3PL9ddfjzlz5iBt2rShDKFrfUxAAsSi4EmAWBQMuWIfgU8+AZ57zvHrmmuABQuAdOns81Me+Z7AihUr0DHhQ3hcfTA6cQJ4+mng99+dGL78MhBP4sv3T65/FnD8+HFUqVIlsezu0KFD8eCDD/pnAfI02QQkQJKN0L0BJEDcY6mRYpAAj4a0bg18/rmzuObNgUaNYnChWlK0CVx4NKR169aoV69etN3yfv6pU8+V2r3rLmD0aB119J56XM4wYcIEc7yRVrJkSVN2N66OOsZl1M9ftASSXH4fAAAgAElEQVSIRQ+BBIhFwZArdhJgt2p2SD9zBmCjOFZOyZXLTl/lla8JMDm2du3aiWV5WaXnqquu8vWa/tF5lt2tXBk4csQRHTNmAPGYgB+7EbZmZbt27UKlSpVw7NgxU3Z39uzZyJs3rzX+yZHIEJAAiQznoGaRAAkKky6KdwKDBzvn0mllywK9e8c7Ea3fIwIDBw7EvHnzEh61sugdy88aSw4vXeqQpBDp0sUjqho23gn06NED77zzjsFQvXp1tG/fPt6RxOX6JUAsCrsEiEXBkCv2EjhwAKhQAeCvtEmTgNtus9dfeeZbAn/99ZfpS3Ag4VnjsZHbb7/dt+u5pOPffHPuOGPWrMAbb6jsbuxF2YoVrV+/Hg0bNjS+ZMuWzZTdzcpnThZ3BCRALAq5BIhFwZArdhNgs7hBgxwfCxd2RAi7NctEwGUC8+fPx4ABA8yot9xyC6ZOnWqOjcSM8ThjnTrApk3OkliViInoMhFwmcCZM2dQv359bNiwwYzcuXNnk4gui08CEiAWxV0CxKJgyBW7CZw+DdSoATAnhMauzU8+abfP8s6XBPihibkgzAmhsUszd0VixphH1a+fsxzmfLDnTiwJrJgJlP8X8uabb+JFfq8GkD9/ftPoM1WqVP5fmFYQFgEJkLCweXOTBIg3XDVqjBJYvRpo0cJZXI4cTkJ65swxulgtK5oE2CitCZvzAbjiiivAhPSYODbCo2UUU3/95eBlg8/ixaOJWnPHKIHDhw+bxPM9e/aYFbICVokSJWJ0tVpWMAQkQIKhFKFrJEAiBFrTxA6BDh2AlSud9bBbM7s2y0TAAwJdu3bFu+++a0aOmcRZHmPkcUba448DL73kATkNKQLAK6+8YnY8aKVKlcKgwBFawYlbAhIgFoVeAsSiYMgVfxDYsQPgGeLjx51jIzNncm/fH77LS18R+OOPP1C5cuXE0qGzZs1Cvnz5fLWG85z96SegVi2VtPZvBH3j+ebNm1GjRg1T0pqdzplXlTt3bt/4L0e9ISAB4g3XsEaVAAkLm26KdwITJwKjRjkUihVzjpGwj4FMBFwmMHHiRIxKeNZ4fIS/92XzNDb1bNoUWLPGIdSyJdCggcu0NJwIABc29WzWrBkaN24sNCIACRCLHgIJEIuCIVf8Q+DECaBaNWDbNsfnPn2AJ57wj/y1DcETpw4Yar2bN++3fjMPiGPPvqob/xPdJRHybp2df74r385x7DSpvXfOuSx9QSWLVuG7t27Jzxq/8LcuXPNLohMBCRALHoGJEAsCoZc8ReBVauANm0cn3PmdBLSM2Xy1xrkrS8IfPTRR2jXrp3x9eqrrzaNCjNmzOgL342TR486jQZ37XJ8fuUV4N/9o/8tQ3BJh4zmOLu3fvNj4PHz4c999/v2/8l6PeEpAA8ZZvSKNLgISESxeLwPkE2E33ww+dv1NCup4OjwjwSEnbtm2xiqIXQN26ddEmIH49mtPVYUeOBKZMcYbkh8Hhw10dXoOJQIBA0sTzhx56CC+/LLgiEAiAQkQix4GCRCLgiFX/EeAx2KYkM4jWUpI91/8fOTxtm3bUK1aNfBIFvsYMCE9b9689q+AfXPYP4d9dNKkAebMAfLksd9veeg7Ako8913IIu6wBEjEkV96QgkQi4IhV/xJYPx4YMwYx3f2Mxg7Vgnp/oyk9V6PGzcO/HIeteIYO3as3QnpFyaeP/OMk4guEwGXCSjx3GWgMTqcBIhFgZUAsSgYcsWfBLj7UbUq8Ntvjv99+wJlyvhzLfLaagLc/ahatSp+S3jW2OH5ySeftNfnt98GevVy/GPiOXc/0qWz11955lsCSjz3begi6rgESERx/NkEiAWBUOu+JfAZ58Bbds6/ish3b9x9IHnzAMJ5H9kz54dCxYssLNDOjueM/F83z6H6ogRwH33+YCwXPQbASWe+y1i0fNXAiR67P82swSIRcGQK/4mwI7oH3/srIFn3hOqFvl7UfLeRgKdOnXCBx98YFxjid7OnTvb52a/fk5lOBrLBg8caJ+P8igmCAwZMgSzZ882a1HieUyE1LNFSIB4hjb0gSVAQmemO0TgogSYkP700+c6pE+eDBQqJFgi4DqBXbt2mVKjR48eNTkgU6ZMQSGbnrXvvnOaDDIHhOWC588HcuVynYMGFIENGzagXr16pvlgunTpTIlqdTzXc3EpAhIgFj0bEiAWBUOu+J/A1KnOURNawYIA/5wqlf/XpRVYR2D69OkYNmyY8evWW281IiQlK7FF21jtqm5dYNMmx5PnngNq1Yq2V5o/BgmcPn3alKTelPCs8Wgi/ywTAQkQHzwDEiA+CJJc9A+BU6eA2rWBn392fOaxLPYHkYmAywROnTqFWrVqgaVHaR07djQJ6lE3HoUZMsRx4+abgenTJcKjHpTYdGDmzJkYOnRowqN2M6ZNm4bUqVPH5mK1KlcIaAfEFYzuDCIB4g5HjSICiQTWrwcaNXKOn2TIAMybB1xzjQCJgOsE1q1bh8aNG5txM2XKhPnz5+Oqq65yfZ6gB2T36UqVgCNHnFsmTgSKFg36dl0oAsES2LlzJ55++unEY4gTJ07EbbfdFuztui5OCUiAWBR4CRCLgiFXYofAgAHOuXfagw8C7MabIkXsrE8rsYZA7969sWTJEuNPqVKlMGjQoOj51qkTkJAcjwoVgO7do+eLZo5ZAsz3aNeuHT5OKPpBIcLCDDIRuBwBCZDLEYrgv0uARBC2poofAgcPOh3S9+xx1jx4MPDII/Gzfq00YgT++usvUwlrX0K5W1YEevjhhyM2f+JE/DDII4e0K64AFiwAsmWLvB+aMeYJrFy5Eh06dDDrzJkzpylFnTlz5phftxaYfAISIMln6NoIEiCuodRAInA+gffeA7p0cf6OFYB4FCtTJlESAdcJLF++HN26dTPj8ggWKwFF9APZ4cNOBbhdu5y19ekDPPGE6+vUgCLAnh/c8WAlONqAAQPw2GOPCYwIBEVAAiQoTJG5SAIkMpw1SxwSYA4ImxOuWuUsvnp1oH37OAShJXtNgEdS2rZtCzYppEW8Nwh7fFBg09hscPhwHTn0OuhxOv7gwYMxZ84cs/r777/fVIJjKWqZCARDQAIkGEoRukYCJEKgNU18EkjaG4Q/JKdMUW+Q+HwSPF/1jh07TBUs9gahTZgwAbfffrvn8yJp0YX06YG5c4Hcub2fVzPEHQH1/Ii7kLu+YAkQ15GGP6AESPjsdKcIBEUgaW8QliXln9OkCepWXSQCoRBIWpb0pptuwowZM5A2bdpQhgjt2hMnnB4fv/zi3Key06Hx09VBEzh58iTq1KmDnxNKnKvnR9DodGESAhIgFj0OEiAWBUOuxCYB9gZhc6wff3TW16wZkFA6NTYXrFVFi8CZM2dQv3598E0xrUmTJubLMxs3DuAXjZ3YJ08GbGiG6NmCNXC0CLz++usYO3asmb5AgQKYOnWqen5EKxg+nlcCxKLgSYBYFAy5ErsENm50RMiZMwAbZc2YAeTLF7vr1cqiRuDHH39E7dq1QTGSJk0acFeEuyGuG3c92GTz5Emn0eC0afxk6Po0GlAE2GyTTTfZfDNlypSm4WDBggUFRgRCJiABEjIy726QAPGOrUYWgfMIvPYaMGmS81eFCzu/19tiPSQeEHj11VcxmbsRgMkD4dtjfnBzzSikn3kG+OYbZ8gGDYCWLV0bXgOJQIDA6dOn0aBBg8RdvYYNG6JFixYCJAJhEZAACQubNzdJgHjDVaOKwN8I8Lw83xj/+qvzT88+C9SuLVAi4DqB48ePo3r16ti2bZsZu3379ubPrtmsWU5zTVqePAD/nC6da8NrIBEIEOBux3BWVQNw4403mh09T/OahD6mCUiAWBReCRCLgiFXYp9A0opBTA6ePdv5ACcTAZcJfP3112jatKkZNV26dJg9ezauv/765M+ydStQowZw/LgzFnNAihdP/rgaQQQuILB161YjnE+cOGFK7bKyW9GiRcVJBMImIAESNjr3b5QAcZ+pRhSBfyQwZIgjPGj84DZmjI5i6ZHxhMCgQYMwl2VxARQrVswk8SbrKBaPXjGpfd06x99q1YCEjtSeLECDxi0B5jBRQK9du9YwqFGjBtq1axe3PLRwdwhIgLjD0ZVRJEBcwahBRCB4AuzTwA9u7BFC69yZneOCv19XikCQBI4cOWLeIG9PeNaSfRQr6dGr665zhHSGDEF6o8tEIHgC8+bNw0A2uATbyuQ2zQcz6FkLHqCuvCgBCRCLHgwJEIuCIVfih8Dq1UAgkTJjRueDnJq3xU/8I7hS145i6ehVBKMW31NRMFM4U0DTRo8ejRIlSsQ3FK3eFQISIK5gdGcQCRB3OGoUEQiZQN++wKJFzm06ihUyPt0QPIFkH8XS0avgYevKZBHg0atmzZphzZo1ZpyKFSuiW7duyRpTN4tAgIAEiEXPggSIRcGQK/FF4PBhgJWJduxw1q0u0vEV/wiuNtlHsXT0KoLRiu+pWOVq6NChBsK1115riidkypQpvqFo9a4RkABxDWXyB5IAST5DjSACYRP46iunMzqNVbHYoNCLpnFhO6gbY4VA2EexdPQqVh4B69exZcsW00STVa9oLJpw5513Wu+3HPQPAQkQi2IlAWJRMORKfBLg276ZM521FyoETJzodEuXiYDLBJIexWI5UzYoTMUu5pey06edhoMsH01T1SuXI6LhAgTY5ZwNB3/44QfzVzVr1sTz3BWWiYCLBCRAXISZ3KEkQJJLUPeLQDIJsJ9CrVrnGhSyzCm/ZCLgMgEexWI5099/92M3Lx5czRq1OjSs4wf75SJpv3rX07DQVUicjkqGo4Exo0bZ75obDg4Y8YM079GJgJuEpAAcZNmMseSAEkmQN0uAm4Q2LABqF8fYLIv30hPngzceqsbI2sMETiPwPr169G4cWMw2Ze7H5MmTUIh7rxdaN9/DzRo4DyTKVMCFCNqAqenyQMCGzZsQP369c0zyT41kydPvvgz6cHcGjK+CEiAWBRvCRCLgiFX4pvA2LHA6687DJgHMn06W1jHNxOt3hMCY8aMwXgKCgB58uQxb5vP67HAXjXclWP+B43HsBK6qnvikAaNWwLHjx83eR+/PKLYdCkSRPzJRMBLwhIgHhBNcwxJUDCBKfbRMBtAqdOObsgGzc6I9es6VTGkomAywR43r5hw4bgm2dalSpV0JkNMQPWvz+wYIHzp8KFgQkTlJfkcgw0nEOAFa9Y+Yp26623mh251MqB0+PhEQEJEI/AhjOsBEg41HSPCHhEYMsWoHZtIKEKDEaMAO67z6PJNGw8E9i6datJ9D127JjBMGzYMDzwwAPAJ58Azz3noEmf3imQkCdPPKPS2j0isGrVKrRp08aMnjZtWkyfPh158+b1aDYNKwKABIhFT4EEiEXBkCsiQALsij5kiMMiRw7nz/xVJgIuE1i4cCH69euX8KjlwJzRo5G9eXNg715npq5dgUqVXJ5Vw4kAH7G9pts5f6W1a9fOFEiQiYCXBCRAvKQb4tgSICEC0+Ui4DWBs2edN9CffurMxB2QYcOcRGCZCLhI4OzZs6bU6Sfc9Th7FpS9D6VIgRSc49/5vkYIIX5k0wEXCPAZPNnn30W3AGh3X/WYHLoWeNdcYa6CLE5AAsejJkACxKBhyRQQCBPbtc7qk79nj/I26pOvZ8IgA30BXq1YNd27ejLp/IFrrrkGOfLl086bR7w1LE/1net2niNHDtPtnL/KRMBrAhIgXhMOYXwJkBBg6VIRiCSBL74AWrZ0ZmRS5pQpQMGCkfRAc8UJga9mzkTaJk2Q+uxZ8xY687hxuJ5FEGQi4DKBTZs2mZK7J0+eNCO/+uqrKFmypMuzaDgRuDgBCRCLngwJEIuCIVdE4EICTEKfOtX52xtucErzqhGcnhM3CRw5Ygof7PzyS3Mef3mOHPikRAmTEJwxY0Y3Z9JYcU7g6NGjqFOnDn799VdDguV3eRRLJgKRIiABEinSQcwjARIEJF0iAtEiwLeE7FSdUC4V5csDPXpEyxvNG2sEmG/UqxewdCnOnD2LVXv3on327DiVMiWefPJJvPjii7G2Yq0nigT69OmDxYsXGw8KFixoSu6y+pVMBCJFQAIkUqSDmEcCJAhIukQEokmAzeDYFI7N4WgvvQQ8/ng0PdLcsULgzTeBgMjImBHbhwxB9fbtcYS7IgBeeOEF/N/V+srFbriCKBt99+G70odk115/Sm+eUN3NWViUAECUiARBD25aaSALkcIf27CFhA4K23+GnQcYRHsHgsi93SZSIQLgF2nq5TB0joAwKW4y1dGsuXL0e3bt0SPyjyKNaNN94Y7iy6TwSwZcsW1K1bN7HnTO/evVG2bFmREYGIE5AAiTjyS08oAWJRMOSKCPwTAb6p5htrGsUHk9J1Rl/PTDgEKDrq1wd+/tm5u0IFoHv3xJGSHpW5+eabMXnyZKRLly6cmXRPnBPgbhrFRyDvo0KFCuie5FmLczxafoQJSIBEGPg/TScBYlEw5IoI/BOBCz80PvEE0Lu3+jToqQmNAPM+uJv29tvOfew8zR01dj1PMHZH54dGvrmm8RgWj8+oT0NoqOP9avaZ6dGjB5YtW2ZQFChQwOR9SMzG+5MRvfVLgESP/d9mlgCxKBhyRQQuR4D5ILVrAwln9NGlC1C58uXu0r+LwDkCCxYA/fs7f+ZxPu6kUYRcYBcem+natSsqqSu6nqQQCCxcuBD9eLQP3KzNaCqr5cmTJ4QRdKkIuEtAAsRdnskaTQIkWfh0swhEnsAHHwCdOjnzpkkDTJwI3Hpr5P3QjP4j8N13QOPGwKlTju8JeR+XWsi7774LCg9a6tSpMX78eBQpUsR/65bHESfAfh8NGjTAiRMnzNwDBw7Eo48+GnE/NKEIJCUgAWLR8yABYlEw5IoIBEvg5ZeBWbOcq3PndvqDZM0a7N26Lh4J7N3r7J7t2uWsno0Gn3/+siSGDh1qOlfTcuXKZaoXZc+e/bL36YL4JbB/35zhG/79u0GQvXq1dG+ffv4BaKVW0NAAsSaUAASIBYFQ66IQLAE2B+kSRPg22+dO+65B2DTwlSpgh1B18UTgdOngZYtga++clZdrBgwejS3NS5L4dSpU2jWrBnWrVtnri1RooTpXp1Kz9pl2cXjBadPn0arVq3w5ZdfmuVzx+z1119HGu7WykQgygQkQKIcgKTTS4BYFAy5IgKhEPjjD+eN9r59zl3sFfLcc6GMoGvjhcDIkU6uB+3KK4EZM4CcOYNe/e7du1GrVi3s2bPH3FOvXj20bt066Pt1YfwQSLpjljNnTkybNs3snMlEwAYCEiA2RCHBBwkQi4IhV0QgVAJr1wLNmgF8w01jVSzV1w+VYmxf/+67QEIeh9khGzsWuOOOkNe8du1aNG3aFGfOnDH3Mrm4dOnSIY+jG2KXwNKlS9GzZ0+zQOYMjRs3DkWLFo3dBWtlviMgAWJRyCRALAqGXBGBcAgkrWqUNi0wfjxQqFA4I+meWCOwYYOTdJ6QCIx27YAaNcJe5axZs/Ay848ApE2b1iSlF9KzFjbPWLpxw4YNaNy4cWLSuaqmxVJ0Y2ctEiAWxVICxKJgyBURCJcAqxktXOjczeMO06aFdMQm3Gl1n8UEmGxety6we7fjZLlyQI8eyeobw74ObFK4ZMkSM+RVV12FKVOm6IiNxY9BJFzbu3cvateujV0JBQ5YrjlQPS0S82sOEQiWgARIsKQicJ0ESAQgawoR8JoAk9J5FOubb5yZeOxhzBi+pvZ6Zo1vIwE2rWSRAu6A0HjkatQoV54HllVt0aJFYlI6d0CYZKzmcjY+CN77xOeBRQrWr19vJrv99tsxZswYJZ17j14zhEFAAiQMaF7dIgHiFVmNKwIRJnBhmdUyZYA+fZL1xjvCK9B0bhBgp/Nu3QDmftCuvdbpdO5i6Vy+8WYi+o4dO8wUzAV56aWX1Cndjfj5aAzmA3Xv3h3sF0PjjhibDTL5XCYCNhKQALEoKhIgFgVDrohAcgn88INz5v/4cWck/p47I7L4IcAcIO5+0TJmdBpV5s/v+vp/+uknNGzYEEePHjVj8y04cwBk8UOAOx3MA6KlT58eEyZMQMGCBeMHgFbqOwISIBaFTALEomDIFRFwg8BHHwFs+sU34TRWpeH5f1nsE3jnHSfPg5YiBcCE8Qcf9GzdH330kWkwx9wQWt++fVGGO2+ymCfw9ttvo1evXgmPWgpTnOBBD5+1mAeqBUaEgARIRDAHN4kESHCcdJUI+IoAu6QnVCsypVfZB+Luu321BDkbIoHVq4E2bYBTp5wbW7UC6tcPcZDQL588ebJpTEhj6dWRI0eaZoWy2CWwZs0akwfEJpW0559/HjVr1ozdBWtlMUNAAsSiUEqAWBQMuSICbhIYPBiYM8cZMXNm5yhO3rxuzqCxbCHw00/OcbvDhx2PKlUCunSJSP4Pdz/69++PhQlV2DJlymSO4uT34NiXLbjj2Y8tW7aYo3YHDhwwGKpUqYJOnTop/yeeHwofrV0CxKJgSYBYFAy5IgJuEmDDOB7F+vhjZ9RrrnFEiLoSu0k5+mP98QfQoAGQUALVHLmi+OTOV4Ts9OnT5ijWJ598YmZk52vujKgDdoQCEKFpdu7cafJ+AuV27733XgwbNgypIvisRWipmiZGCUiAWBRYCRCLgiFXRMBtAkwQZjlWJqfTuAPCpNGsWd2eSeNFg8DBg87Ox+bNzuyFCzsJ6BkyRNwbJqOzUzob0tHy5ctnEpSzZMkScV80ofsE/vrrLzRq1Ai/vqrGZzll5mEnpGFDmQi4BMCEiAWBUoCxKJgyBUR8IIAG9E1agT8/rszepEiTk8IfXDwgnbkxqS4bNkSSOi/gH/9y9nhypEjcj5cMBPL8/IN+W+/Wb+hT0hmB+SIQqCKGoQYnBiisvmzZvju+++M6vLkyePEZc5ovisxSBmLSkCBCRAIgA52CkkQIIlpetEwMcE+IGQImTPHmcR99wDvPKKK43pfEzFv66fOAE89xzwxRfOGtjjg+Lj+uujvqZt27YZEbJv376ER+0evPLKK0irpphRj004DjDRnEnmq1atMrezx8ekSZOQO3fucIbTPSIQVQISIFHFf/7kEiAWBUOuiICXBJiozONYPLZDe+wxoF8/IGVKL2fV2G4TOH0a6NQJ+PBDZ2QWGBg3DihQwO2Zwh5v06ZN5jjWoUOHzBiPPPIIBgwYoFyBsIlG50bm9nTt2hUffPCBcYAFBrjzcfPNN0fHIc0qAskkIAGSTIBu3i4B4iZNjSUClhP45hugRYtzjQqfesrpGyERYnngEtxjYYEXXgCWLnX+In165zhd0aLW+f/NN9+gZcuWOHbsmPGtbNmyeOGFF5BSz5p1sbqYQ+xy3rNnTyxbtsz8M3eweJyuePHivvBfTorAxQhIgFj0XEiAWBQMuSICkSDAoxQ8vsM36TQ2KezeXSIkEuyTMwfFx4ABQEK5W6RJAwwfbnV/ly+++ALPPvssTp48aVZeqVIldO7cWSIkOc9BBO6l+GBTySVLlpjZ0qRJg6FDh4JVr2Qi4GcCEiAWRU8CxKJgyBURiBSBFSuAzp0BfqilVagAdO0qERIp/qHOwzjxuNyiRc6d3EUYNAh4+OFQR4r49StXrjR9IvihllaxYkV06dJFIiTikQhuQvZ14XG5BQsWmBtYYnfw4MHqch4cPl1lOQEJEIsCJAFiUTDkighEksD77zuiIyBC2LyOokRHZCIZhcvPxfj07QskvI028endGyhT5vL3WnIFj/HwOE9AhJQvXx7dunWTCLEkPgE3GB+KjXnz5iXo3JRGjJQqVcoyT+WOCIRHQAIkPG6e3CUB4glWDSoC/iDw3ntAt24SIbZGi+KDYuOttxwPKT4oRkqXttXjS/q1fPly9OjRI1GEPPXUU+bPygmxI5RMOO/Tpw/eSnjWUqRIYf5cxkdC1w6S8sJmAhIgFkVHAsSiYMgVEYgGgXffdXJAAjsh/HDLD72pU0fDG80ZIMAcnRdfPJdwTvHBY1isXuZTe++998zOR2AnhInpvXr1UnWsKMeTOToUg+9zV9To3JSmYADjIxOBWCIgAWJRNCVALAqGXBGBaBGgCGE1rEBi+v33AwMHOlWWZJEnwMpRXboAn3zizJ0qFdC/PxADR2FWrFhhckD4xp324IMPol+/fkivZy3yzxmAEydOmBydTxKetdSpU5t46NhVVMKhST0mIAHiMeBQhpcACYWWrhWBGCbw6adAx478ROIsslgxp1kh+0zIIkfgwAGnShlLJtNY7YriwwcJ58FC+vDDD40ICVTHuuOOO0yVpaxZswY7hK5zgQD7tHTo0AFffvmlGY2ldpkDcj9fQMhEIAYJSIBYFFQJEIuCIVdEINoE1qwBnn0WOHLE8aRgQafU65VXRtuz+Jj/zz+BVq2AzZud9WbMCAwdCtx1V8ytnx9627VrhyMJz1r+/PkxcuRIXHXVVTG3VhsXtGvXLrRp0wY/yzcS9DhgymY/1dMfis2chfPkWHgARIdLhfdFYJEIuCIVdEwAYCP/zgfAj+6y/Hm6uvdkRI/vw2eBe7Pvz6K9C6NbBjh7PG7NmBkSOBW26J2TVv3LgRrVu3xr59+8wac+fOjREjRuDGG2+M2TXbsDCKDooPihBatmzZMGzYMNx22202uCcfRMAzAhIgnqENfWAJkNCZ6Q4RiHkCv/zifBjeudNZKt/EMydEjci8Cf0XXwCdOgGHDjnj584NvPoqkCePN/NZNOrWrVvRqlUrbN++3XiVOXNmU/q1ZMmSFnkZO66sXr3aHLs6fPiwWdR1111ndp7yxMGzFjtR1ErCJSABEi45D+6TAPEAqoYUgVggsGePk4uwYYOzGlZhYp8Q9guRuUdg/nynqWCgClmBAsCIEXF17G337t3mjVwRA1AAABhrSURBVPyPP/6Y8KilRPv27VG1alX3OGskLFy4EIMGDcKpU6cMjcKFC5tjVzly5BAdEYgLAhIgFoVZAsSiYMgVEbCNAKsxsTrWypXnPKtWzckTYXK0LHwC/BDIJP85c86N8eCDTp8P7jjFmTEXhKVgP/roo8SVP/300yZPhJWZZOETYLI/k8spQALG6mMvvfSSyf2QiUC8EJAAsSjSEiAWBUOuiICNBPhmnm/kp08/593ttztHspScHl7EmGzOMrvr1p27v25dJ/cmjjvRsz/IqFGjMHny5EQuxYsXR/+/ZEzZ87wWMf5XXv37kXHjh2xLsmzVrNmTbRt21b9V+L82YjH5UuAWBR1CRCLgiFXRMBmAosWOaLj5EnHS34g5J/vuMNmr+3zjZXGeJRt717HN77dpxgpX94+X6Pk0dtvv42+ffsmluml+GBvijvvvDNKHvlz2jVr1pjGj39S8CaU2eWfn3zySX8uSF6LQDIJSIAkE6Cbt0uAuElTY4lAjBP4/nugQwcgoXqOeVvfrBlQv35cv7kPKurcSZo6FRg16ly+R65cTv5HkSJBDRFPF61fvx6dO3dOrNTE7tzNmzdHvXr1TKdu2aUJcCdpwoQJeP311xO7zufKlQtDhgxBoUKFhE4E4paABIhFoZcAsSgYckUE/ECAJVO7dgUSmpcZl4sXB/r0cUr2yv5OgNXEevYEuPsRsHvucfI9WG5XdlECLM/bvXt3fMEqYQlWokQJvPDCC7haz9pFmXG3g7k0X3311XnMuKOkY2z6jxbvBCRALHoCJEAsCoZcEQG/EDh9Ghg3Dpg06dzbfHaxpjB57DG/rCIyfr77LtCv37kSuylSAA0bAk2batcoiAjwbf748ePN2/yzZ8+aO1iql7sjZcqUCWKE+LiEbJYtW2aSzQ8cOGAWzZ2ipk2bokGDBto1io/HQKu8DAEJEIseEQkQi4IhV0TAbwT4Rp9Vsv7445znpUoBHTsqQZ1ljAcPBt5/xwbvrXnThF3jGQhEWDn9F69eiUeyeLN/nPf0xPi3gvI8tEc+bIfPjhh4lM2VGeVa6YxC8TARFwCEiAWPQkSIBYFAy5IgJ+JMC3rXzDn/SDdpYsTg+Rp54C+MY/noxv6RcvdrrHHzx4buWPP+4kn5ONLCwCBw8eNH0s3nnnncT7s2bNanqIlCtXLu7e8nN36K233sLw4cPx119/JTJ5/PHHTeUrdjiXiYAInCMgAWLR0yABYlEw5IoI+JUAP3S/957zxp85IgErVgxo3x4oWNCvKwvNbzbSGzLk/FyPK65wEvcpQGSuEHj33XdNt/TAUSMOescdd6BLly7Ily+fK3PYPsimTZswcOBAMFk/YNmzZzcMSnEXUiYCIvA3AhIgFj0UEiAWBUOuiIDfCezfDwwdCixdmuSVUwqgYkWgefPYTbhmSd3RowGWKk7IUzAAWO6UO0EUITJXCTBBnV28lyZ51pjzUKFCBTRr1ixmj2XxuBXzYRYsWJBY4YpgS5cubY6jUYTIREAELk5AAsSiJ0MCxKJgyBURiBUCq1Y5uyHbtp1bUebMQK1aQM2aQKZMsbHSw4edTuZsnHfkyLk1XXed09ujZMnYWKfFq1i9erVpVLgtybOWMWNGU663Ro0a4O9jwQ4fPozp06ebr6NHjyYu6cYbbzTHre6+++5YWKbWIAKeEpAA8RRvaINLgITGS1eLgAgESeDECWD2bGD8+PM/nLNaVp06QLVqgF8/HFJ4cG0zZgAJFYcMFa6ncWOgenUgbdogQemy5BI4fvw4Zs2ahYkTJ+JIEiHIHIhatWqhatWqpnKWH+3QoUNmt2Pq1Knn5XmkT58ezzzzDNjVPE2aNH5cmnwWgYgTkABxETlL76VIRpKnBIiLwdBQIiACfyfAalA8nrRkybmSvbyKydg8mkUh4peeDqz2NX8+sGDB+cKDjfEqVHCaMubIoacgSgQudTyJ4oMipEqVKmBDPj/Yrl27MHv2bMyfP/88UZUqVSpUrlwZjRo1Ul8PPwRSPlpFIC4FyG+/WbexLChEqt2sFnQypUr8fDDD4cdnA0bNqBx48ZYxeMOYZoESJjgdJsIiEBoBH77zdkN4Zl9dgUPGD+8P/ooULmyU57Wti7X9HXtWueoFcucXuj7E08AjRoBefKExkNXe0bg119/Nbsh7IvBSlHnHrWU5mcuhQgbGibn5Z0XztNXHilbvHix+Xxw6tSpxGnoK6tbMb+FP7dlIiACoROISwHSvn17UypvxowZpoNrunTpUKhQISNGwjV2g33xxRcTmzOFM44ESDjUdI8IiEDYBLZuBSZOBJYvB06ePH8Y7oSULet83XRT2FO4cuPmzQDLvdLPHTvOHzJVKsdHNhS8/npXptMg7hNgXsjkyZNNqdrTbJ6ZxK677jqTuM1eIjfffHPUxAhPMfz8889YsWKF8XPHBc8aj1f93/9H+rUqYM8ErnuPyQaMa4IxKUAYSdSfoP53/+51qwJUBcQ6mBREAEIk2AR7N4lGnevPNL9wb84IetBx5wvljO1+tz7sxZYWPF/4X4K7yL7/8nUjOnM5OTaVKarQY6eclGfPxONMbb7yBhQsXYg+fuwuMidz/ve/cc8996BYsWLmBaGXxpyVb7/9Fp999pnZ6eAJiQuN1axY0at69eo6auVlMDR2XBGIOwHCb25JhcdDDz2Ejz76KPEIFoUEK1vUrVvX7JJcccUVZhuW97Cs3ldffWW2kfnNkZ1N+WtAfASeHHaI5d+FatoBCZWYrhcBEXCVAD/482jT2287H/6THnEKTMSE7kKFgNtuc74KFABy5w7/uBbfhm/fDvz0E/Ddd87X998Dx4/fWk8EsZqViypy/4KXgshV+FqsKQEeKSJ3cIpRAI/Vy8klDZtWhQtWtScULjlllvMF39OssRvOMaf3RQYP/30EzZu3Ig1a9bg+++/P+94VWBcHrO69957jfCgIFJyeTjEdY8IXJpA3AmQtWvXonv37uYbD9/CcLuV26mBHBAKBwqLwoULY/Dgwdi9ezeefPJJ5M+fH4888ojJ8zhx4gT69u2LH374wQgTdoTlfRMmTMB/tf8w0ynHOhEiD6ryoCImANAfbTWLYMWLkS+Oabi4uRgLMUAjz+dM01AHcm+MVKRxQrgTfYFBQUOIcOAXzzza+dOwEeA0tyvv5v6+eHTQodNg987DElllvzgLjnCBPWP/jgA7Cp4bp16/7xKDNFybXXXgse22ISO49OZ8mSBZkSyklTOFBosFQuv9iVfOfOneZr+/bt5uf3pYzC5s477zQ/65mf4pckefcioZFEIHIE4k6AEG39+vXNmxcmx/FXfrNJKkCYy/Hee+/hMf6wA/D555+bNyGffvop7r/fvN3mzdvxtixY9G6dWtcf/31ibsgPEP6TzZ06FDw62L2+++/m7/mN0F+g5WJgAiIgBUE+H2NH9woIpgrcsEZftd9ZF4HxUvgKxnVBV33TQN6SoA/QykSAl8X5ou4PTkrWVHUcIeDx71sS4Z3e70az10C11xzjdnBk4VOQALkEgKEb0uYoE5j7e+8efOabdpq1aqhbNmyePTRR89rqhRsDsiFx7VCD5nuEAEREAEREAEREAERiDYB7sRdLG8o2n75YX4JkEsIkAt3MjZt2mSOXbEyxv79+434qF27tskTYROiYAVIMDsgfHD4UMuiR4DVT7iNr92o6MWAMysO0eWfdHbFQrGwh4Adnuj/hB1xiObPCu2AhP8MSIAEKUACiLkdzKT0adOmYfTo0RgwYAA6deoUtAD5p1ApByT8B9ntOxULt4mGN57iEB43L+5SLLygGt6YikV43Ny+S3Fwm2j44ykW4bOL1p0SIEEIEHY/bd68uSnVR7UbMJbmY0PDV199FX369EHPnj3VByRaT7LL8+qbmctAwxxOcQgTnAe3KRYeQA1zSMUiTHAu36Y4uAw0GcMpFsmAF6VbJUCCECDcZmVVrAIFCqBz586m6sacOXPw+uuvm8odTGIfOXIk2rRpg5kzZ6JkyZK4KYzGXfoPFKX/BReZVrGwIxaKgx1xoBeKhWJhDwE7PNH/CTvioO9P9sQhFE8kQIIQIAT65ZdfmvK9rHZw5MgRFClSBF27dkXFihUNb5b3Y71wlhBkqd5Ro0aFEgdzrb6ZhYzMsxsUC8/QhjSw4hASLk8vViw8xRvS4IpFSLg8u1hx8AxtyAMrFiEji/oNcSlAok79Eg7oP5A9kVEs7IiF4mBHHPSCxJ44KBb2xELfnxQLewj4zxMJEItipm9m9gRDsbAjFoqDHXHQh1574qBY2BMLfX9SLOwh4D9PJEAsihlL9B44cMDkmDz/PMWeRZ/rigWdsRccbAjDvRCsVAs7CFghyf6P2FHHPT9yZ44hOKJBEgotHStCIiACIiACIiACIiACIhAsghIgCQLn24WAREQAREQAREQAREQAREIhYAESCi0dK0IiIAIiIAIiIAIiIAIiECyCEiAJAufbhYBERABERABERABERABEQiFgARIKLQ8vHbZsmWmz8iGDRtw1VVXoVmzZqbpYYoUKTycVUP/E4Ft27bhtttuw6JFi/Dwww8LVgQJnD171jT6fPXVV7FlyxbkypUL5cqVQ+/evU2RBlnkCJw+fRqDBw/G+PHj8fvvv5uGrB06dEDt2rUj54Rm+huBSpUqYc2aNfj1119FJ8IE2AssS5YsOHPmzHkzp0uXDseOHYuwN5ru888/R5cuXbB69WpkzpwZZcqUMd+z+HNDZi8BCRALYrNq1SrzAbdatWqoVasWPv30U/Tr1w99+vRBt27dLPAw/lz43/+h8cffxybNm3CypUrJUAi/AgMGjTINPrkB91HH30UP/8M3r06IHbb78d7733noR5BOPRqVMnvPLKK+b70V133YWlS5eailgzZsxAzZo1I+iJpgoQmD59OurUqYMbbrhBAiQKjwU/8N57772YNWsWbrzxxkQPUqZMibvvvjsKHsXvlF9/TUeeOAB83OiTZs2pik0xchNN90EfraS2UtAAsSC2PCD7r59+4x6Dxh/6LOb+q5du5AhQwYLvIwPF/hGa8qUKWjfvr1Z8N69eyVAIhx6xiBnzpzmw+1rr72WOPu8efNQtWpVfPnll+aDsMx7AocOHTJvEVu3bo2BAwcmTsgXJsePH8d/tf753QDOcR4AesIkWKIFOmTEiVKpUESBSejzFjxqBt27bg/480adJEwQNNGSBQqlQpHD161Ly45f8H2sKFC018Pv74YyNEZHYSkACJclz4Q5xHSl588UVz5Cpg/JDFNynLly9H6dKlo+xl/Ey/bt06lCxZEi1atMBjjz2GJ598UgIkwuHfv3+/2e2oXr067r/sTZv/nmG9xxxx2YPXu22S2UeU/g1KlT+P7773HNNdfg6quvTpyQ35N2795tjgDJIkugbNmy5mdG+vTp8eGHH0qARBa/mY1HpL/44gusXbs2CrNrygCBPXv2mCPrfGnIHUGZvwhIgEQ5Xj/88AMKFSqEBQsWgGd6A8YdkRw5cmDkyJFo1apVlL2Mn+m548Hzvexwyx/ujzzyiASIJeHv1auXyQH57rvvULhwYUu8ih83mJfzxx9/YNKkSeZoKHN0GjVqFD8ALFgp83DInqKQu7QSINEJCl9SnTx50vyM5jEf5n48/fTTGDJkiMkNkUWGAI9HcweEObRTp07FkiVLwO9TFSpUMJ+dsmfPHhlHNEtYBCRAwsLm3k08wnDfffeZc+184x4wvnnk1u5LL71kzsLLIk9AAiTyzC81I3/I8wfNE088gTfeeMMex+LIE+Z8BBLP+RZ+zpw5JuFTFhkCzEtjUQwKwMqVK6N+/foSIJFBf94sPCJKkcHjPjyWyJchPLHAUwzMUfvoo4/AXBCZ9wTmzp1rdsNz585tfjbUqFEDP/30k8kBueWWW/DZZ58pFt6HIewZJEDCRufOjfwPwgSq999/3yRRXShA+vfvf97RLHdm1SjBEJAACYaS99d88skneOqpp3DdddeBv+dbR1nkCbAQAPMPWJihZ8+e5ugD89Z4FEjmLQG+1eULKjLnEUSaBIi3zC81OqvC8fsQjyXyQ27AAgKdRRr4YVjmPYFAMQb+fODuR8D4f4RihDsjzLGV2UlAAiTKceFWOhMKmTRVsWLFRG8CR7CYiN68efMoexmf00uARD/u/EHCD1oFCxY0+VD8oS+LPoEVK1aYFyb8AMDKfTJvCbAcNd+wf/vtt7jyyivNZDz+xrftFIZ846637t7G4HKjM3eNR3700vBypNz798WLF5vjVmPHjkWTJk0SBw7EYsCAAWBBH5mdBCRAohwX1gznMQZ+02LJ0YAFktD5Ifihhx6KspfxOb0ESHTjzjru/OHx4IMPgj9osmXLFl2H4nB2VuF75513zBvdpDX1Dx48aBKh9WErMg8Fq45RbFzKmB/1wgsvRMaZOJ+FvXACuxzMFQzYjh07zFEg5kY1btw4zilFZvnsm8YjcCNGjDCV+gL2559/mu9Xw4cPN6V5ZXYSkACxIC6BMnI85x5oPMgPXuPGjTNHHlSGNzpBkgCJDnfOyjdarDTDsrvTpk1D2rRpo+dMHM/MJpD58uX7Wy5aoCSyjptE5uHgsTeKvqTGHRH2QODRE37w5ZfMewKB/xOs1MeiGAEbNmwY2rVrZ5oJc8dW5j0BHk3MmzevefZ5nD1gEyZMMCKQVfqKFSvmvSOaISwCEiBhYXP3Jh5n4PleJhY2bNjQVNVg8jkT3JLuirg7q0a7HAEJkMsR8ubfd+7caX6o8A0Wj/ikTp36vIn4gZhn4WWRIVCvXj2TcM4PvCVKlMBXX32Fvn37muIZ3B0JvDSJjDeaJUBAOSDRexbq1q1r/k8wF4oVsQLNg3kMiNWXZJEjMH/+fPOiilXIKDo2btxoCvcw94P/JrOXgASIJbFhZR9uo/NNF5NtW7Zsad6myKJHQAIkOuwnTpz4j+VdWQWIH75kkSHAXkUsL8oyl6zEdO2115pqWN27dzflR2XRISABEh3unJVHp3lElLuzW7duNT+zn3nmGfPCMNAML3rexd/Mb731ltmNWr9+vSlSwrw0viTR9ye7nwUJELvjI+9EQAREQAREQAREQAREIKYISIDEVDi1GBEQAREQAREQAREQARGwm4AEiN3xkXciIAIiIAIiIAIiIAIiEFMEJEBiKpxajAiIgAiIgAiIgAiIgAjYTUACxO74yDsREAEREAEREAEREAERiCkCEiAxFU4tRgREQAREQAREQAREQATsJiABYnd85J0IiIAIiIAIiIAIiIAIxBQBCZCYCqcWIwIiIAIiIAIiIAIiIAJ2E5AAsTs+8k4EREAEREAEREAEREAEYoqABEhMhVOLEQEREAEREAEREAEREAG7CUiA2B0feScCIiACIiACIiACIiACMUVAAiSmwqnFiIAIiIAIiIAIiIAIiIDdBCRA7I6PvBMBERAB3xFYsmQJypcvj169euGFF14w/v/4448oVqwYqlSpgilTpvhuTXJYBERABETAPQISIO6x1EgiIAIiIAIJBOrVq4fZs2fjm2++wc0334wHHngAO3fuNH/OmjWrOImACIiACMQxAQmQOA6+li4CIiACXhHYv38/ihQpYsRHmTJl0K1bN3z44YdGiMhEQAREQATim4AESHzHX6sXAREQAc8ILFu2DE888QRSpkyJLl26oG/fvp7NpYFFQAREQAT8Q0ACxD+xkqciIAIi4CsCJ0+eRL58+bBt2zZ8/vnnuOeee3zlv5wVAREQARHwhoAEiDdcNaoIiIAIxD2BHj16YNCgQUaEpEqVCl9/TXSpk0b91wEQAREQATinYAESLw/AVq/CIiACHhA4KuvvsK9996L7t27m4pYJUqUQPv27dG/f38PZtOQIiACIiACfiIgAeKnaMlXERABEfABgePHj6N48eJIkSIF1qxZY3Y9OnTogFdeeQWfffaZjmL5IIZyUQREQAS8JCAB4iVdjS0CIiACcUigY8eOePnll43YKFmypCFw5MgRUxWLYmTdunVInz59HJLRkkVABERABEhAAkTPgQiIgAiIgAiIgAiIgAiIQMQISIBEDLUmEgEREAEREAEREAEREAERkADRMyACIiACIiACIiACIiACIhAxAhIgEUOtiURABERABERABERABERABCRA9AyIgAiIgAiIgAiIgAiIgAhEjIAESMRQayIREAEREAEREAEREAEREAEJED0DIiACIiACIiACIiACIiACESMgARIx1JpIBERABERABERABERABERAAkTPgAiIgAiIgAiIgAiIgAiIQMQI/D+bjqt73X1GlAAAAABJRU5ErkJggg==" width="800">
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Text(0.5, 0, 'x')</code></pre>
</div>
</div>
</section>
<section id="plot-with-error-bars" class="level1">
<h1>Plot with error bars</h1>
<p>Reading data:</p>
<div id="913fef04" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">cat3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.loadtxt(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data/cat3.dat'</span>)</span></code></pre></div>
</div>
<p>1st column will be used as x-location</p>
<p>2nd column: observed value.</p>
<p>3rd column: lower bound (95% CI)</p>
<p>4th column: upper bound (95% CI)</p>
<p>Data looks like:</p>
<div id="90acb4c5" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>cat data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>cat3.dat</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#percent, 1: Refold, 2: WT, 3: S, 4:F 
1   38  29  47
2   27  18  36
3   35  26  44
4   9   4   15</code></pre>
</div>
</div>
<div id="fe152783" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">fig2, ax2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb9-2">ax2.plot(cat3[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], cat3[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*'</span>, markersize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>)</span>
<span id="cb9-3">cat3_yerr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [cat3[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>cat3[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], cat3[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>cat3[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb9-4">plt.errorbar(cat3[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], cat3[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], yerr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cat3_yerr, fmt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>, elinewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, capsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, capthick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb9-5">plt.xticks([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>], [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Refold'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'WT'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SLOW'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'FAST'</span>], fontweight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)</span>
<span id="cb9-6">plt.yticks(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">51</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)))</span>
<span id="cb9-7">plt.ylim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">51</span>)</span>
<span id="cb9-8">plt.xlim(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.2</span>)</span>
<span id="cb9-9">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Percent of folded trajs'</span>, fontweight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>)</span>
<span id="cb9-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plt.savefig('CAT3_all_variants.png', dpi=1200)</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
/* Put everything inside the global mpl namespace */
/* global mpl */
window.mpl = {};

mpl.get_websocket_type = function () {
    if (typeof WebSocket !== 'undefined') {
        return WebSocket;
    } else if (typeof MozWebSocket !== 'undefined') {
        return MozWebSocket;
    } else {
        alert(
            'Your browser does not have WebSocket support. ' +
                'Please try Chrome, Safari or Firefox ≥ 6. ' +
                'Firefox 4 and 5 are also supported but you ' +
                'have to enable WebSockets in about:config.'
        );
    }
};

mpl.figure = function (figure_id, websocket, ondownload, parent_element) {
    this.id = figure_id;

    this.ws = websocket;

    this.supports_binary = this.ws.binaryType !== undefined;

    if (!this.supports_binary) {
        var warnings = document.getElementById('mpl-warnings');
        if (warnings) {
            warnings.style.display = 'block';
            warnings.textContent =
                'This browser does not support binary websocket messages. ' +
                'Performance may be slow.';
        }
    }

    this.imageObj = new Image();

    this.context = undefined;
    this.message = undefined;
    this.canvas = undefined;
    this.rubberband_canvas = undefined;
    this.rubberband_context = undefined;
    this.format_dropdown = undefined;

    this.image_mode = 'full';

    this.root = document.createElement('div');
    this.root.setAttribute('style', 'display: inline-block');
    this._root_extra_style(this.root);

    parent_element.appendChild(this.root);

    this._init_header(this);
    this._init_canvas(this);
    this._init_toolbar(this);

    var fig = this;

    this.waiting = false;

    this.ws.onopen = function () {
        fig.send_message('supports_binary', { value: fig.supports_binary });
        fig.send_message('send_image_mode', {});
        if (fig.ratio !== 1) {
            fig.send_message('set_device_pixel_ratio', {
                device_pixel_ratio: fig.ratio,
            });
        }
        fig.send_message('refresh', {});
    };

    this.imageObj.onload = function () {
        if (fig.image_mode === 'full') {
            // Full images could contain transparency (where diff images
            // almost always do), so we need to clear the canvas so that
            // there is no ghosting.
            fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height);
        }
        fig.context.drawImage(fig.imageObj, 0, 0);
    };

    this.imageObj.onunload = function () {
        fig.ws.close();
    };

    this.ws.onmessage = this._make_on_message_function(this);

    this.ondownload = ondownload;
};

mpl.figure.prototype._init_header = function () {
    var titlebar = document.createElement('div');
    titlebar.classList =
        'ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix';
    var titletext = document.createElement('div');
    titletext.classList = 'ui-dialog-title';
    titletext.setAttribute(
        'style',
        'width: 100%; text-align: center; padding: 3px;'
    );
    titlebar.appendChild(titletext);
    this.root.appendChild(titlebar);
    this.header = titletext;
};

mpl.figure.prototype._canvas_extra_style = function (_canvas_div) {};

mpl.figure.prototype._root_extra_style = function (_canvas_div) {};

mpl.figure.prototype._init_canvas = function () {
    var fig = this;

    var canvas_div = (this.canvas_div = document.createElement('div'));
    canvas_div.setAttribute(
        'style',
        'border: 1px solid #ddd;' +
            'box-sizing: content-box;' +
            'clear: both;' +
            'min-height: 1px;' +
            'min-width: 1px;' +
            'outline: 0;' +
            'overflow: hidden;' +
            'position: relative;' +
            'resize: both;'
    );

    function on_keyboard_event_closure(name) {
        return function (event) {
            return fig.key_event(event, name);
        };
    }

    canvas_div.addEventListener(
        'keydown',
        on_keyboard_event_closure('key_press')
    );
    canvas_div.addEventListener(
        'keyup',
        on_keyboard_event_closure('key_release')
    );

    this._canvas_extra_style(canvas_div);
    this.root.appendChild(canvas_div);

    var canvas = (this.canvas = document.createElement('canvas'));
    canvas.classList.add('mpl-canvas');
    canvas.setAttribute('style', 'box-sizing: content-box;');

    this.context = canvas.getContext('2d');

    var backingStore =
        this.context.backingStorePixelRatio ||
        this.context.webkitBackingStorePixelRatio ||
        this.context.mozBackingStorePixelRatio ||
        this.context.msBackingStorePixelRatio ||
        this.context.oBackingStorePixelRatio ||
        this.context.backingStorePixelRatio ||
        1;

    this.ratio = (window.devicePixelRatio || 1) / backingStore;

    var rubberband_canvas = (this.rubberband_canvas = document.createElement(
        'canvas'
    ));
    rubberband_canvas.setAttribute(
        'style',
        'box-sizing: content-box; position: absolute; left: 0; top: 0; z-index: 1;'
    );

    // Apply a ponyfill if ResizeObserver is not implemented by browser.
    if (this.ResizeObserver === undefined) {
        if (window.ResizeObserver !== undefined) {
            this.ResizeObserver = window.ResizeObserver;
        } else {
            var obs = _JSXTOOLS_RESIZE_OBSERVER({});
            this.ResizeObserver = obs.ResizeObserver;
        }
    }

    this.resizeObserverInstance = new this.ResizeObserver(function (entries) {
        var nentries = entries.length;
        for (var i = 0; i < nentries; i++) {
            var entry = entries[i];
            var width, height;
            if (entry.contentBoxSize) {
                if (entry.contentBoxSize instanceof Array) {
                    // Chrome 84 implements new version of spec.
                    width = entry.contentBoxSize[0].inlineSize;
                    height = entry.contentBoxSize[0].blockSize;
                } else {
                    // Firefox implements old version of spec.
                    width = entry.contentBoxSize.inlineSize;
                    height = entry.contentBoxSize.blockSize;
                }
            } else {
                // Chrome <84 implements even older version of spec.
                width = entry.contentRect.width;
                height = entry.contentRect.height;
            }

            // Keep the size of the canvas and rubber band canvas in sync with
            // the canvas container.
            if (entry.devicePixelContentBoxSize) {
                // Chrome 84 implements new version of spec.
                canvas.setAttribute(
                    'width',
                    entry.devicePixelContentBoxSize[0].inlineSize
                );
                canvas.setAttribute(
                    'height',
                    entry.devicePixelContentBoxSize[0].blockSize
                );
            } else {
                canvas.setAttribute('width', width * fig.ratio);
                canvas.setAttribute('height', height * fig.ratio);
            }
            canvas.setAttribute(
                'style',
                'width: ' + width + 'px; height: ' + height + 'px;'
            );

            rubberband_canvas.setAttribute('width', width);
            rubberband_canvas.setAttribute('height', height);

            // And update the size in Python. We ignore the initial 0/0 size
            // that occurs as the element is placed into the DOM, which should
            // otherwise not happen due to the minimum size styling.
            if (fig.ws.readyState == 1 && width != 0 && height != 0) {
                fig.request_resize(width, height);
            }
        }
    });
    this.resizeObserverInstance.observe(canvas_div);

    function on_mouse_event_closure(name) {
        return function (event) {
            return fig.mouse_event(event, name);
        };
    }

    rubberband_canvas.addEventListener(
        'mousedown',
        on_mouse_event_closure('button_press')
    );
    rubberband_canvas.addEventListener(
        'mouseup',
        on_mouse_event_closure('button_release')
    );
    rubberband_canvas.addEventListener(
        'dblclick',
        on_mouse_event_closure('dblclick')
    );
    // Throttle sequential mouse events to 1 every 20ms.
    rubberband_canvas.addEventListener(
        'mousemove',
        on_mouse_event_closure('motion_notify')
    );

    rubberband_canvas.addEventListener(
        'mouseenter',
        on_mouse_event_closure('figure_enter')
    );
    rubberband_canvas.addEventListener(
        'mouseleave',
        on_mouse_event_closure('figure_leave')
    );

    canvas_div.addEventListener('wheel', function (event) {
        if (event.deltaY < 0) {
            event.step = 1;
        } else {
            event.step = -1;
        }
        on_mouse_event_closure('scroll')(event);
    });

    canvas_div.appendChild(canvas);
    canvas_div.appendChild(rubberband_canvas);

    this.rubberband_context = rubberband_canvas.getContext('2d');
    this.rubberband_context.strokeStyle = '#000000';

    this._resize_canvas = function (width, height, forward) {
        if (forward) {
            canvas_div.style.width = width + 'px';
            canvas_div.style.height = height + 'px';
        }
    };

    // Disable right mouse context menu.
    this.rubberband_canvas.addEventListener('contextmenu', function (_e) {
        event.preventDefault();
        return false;
    });

    function set_focus() {
        canvas.focus();
        canvas_div.focus();
    }

    window.setTimeout(set_focus, 100);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'mpl-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'mpl-button-group';
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'mpl-button-group';
            continue;
        }

        var button = (fig.buttons[name] = document.createElement('button'));
        button.classList = 'mpl-widget';
        button.setAttribute('role', 'button');
        button.setAttribute('aria-disabled', 'false');
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));

        var icon_img = document.createElement('img');
        icon_img.src = '_images/' + image + '.png';
        icon_img.srcset = '_images/' + image + '_large.png 2x';
        icon_img.alt = tooltip;
        button.appendChild(icon_img);

        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    var fmt_picker = document.createElement('select');
    fmt_picker.classList = 'mpl-widget';
    toolbar.appendChild(fmt_picker);
    this.format_dropdown = fmt_picker;

    for (var ind in mpl.extensions) {
        var fmt = mpl.extensions[ind];
        var option = document.createElement('option');
        option.selected = fmt === mpl.default_extension;
        option.innerHTML = fmt;
        fmt_picker.appendChild(option);
    }

    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message';
    toolbar.appendChild(status_bar);
    this.message = status_bar;
};

mpl.figure.prototype.request_resize = function (x_pixels, y_pixels) {
    // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client,
    // which will in turn request a refresh of the image.
    this.send_message('resize', { width: x_pixels, height: y_pixels });
};

mpl.figure.prototype.send_message = function (type, properties) {
    properties['type'] = type;
    properties['figure_id'] = this.id;
    this.ws.send(JSON.stringify(properties));
};

mpl.figure.prototype.send_draw_message = function () {
    if (!this.waiting) {
        this.waiting = true;
        this.ws.send(JSON.stringify({ type: 'draw', figure_id: this.id }));
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    var format_dropdown = fig.format_dropdown;
    var format = format_dropdown.options[format_dropdown.selectedIndex].value;
    fig.ondownload(fig, format);
};

mpl.figure.prototype.handle_resize = function (fig, msg) {
    var size = msg['size'];
    if (size[0] !== fig.canvas.width || size[1] !== fig.canvas.height) {
        fig._resize_canvas(size[0], size[1], msg['forward']);
        fig.send_message('refresh', {});
    }
};

mpl.figure.prototype.handle_rubberband = function (fig, msg) {
    var x0 = msg['x0'] / fig.ratio;
    var y0 = (fig.canvas.height - msg['y0']) / fig.ratio;
    var x1 = msg['x1'] / fig.ratio;
    var y1 = (fig.canvas.height - msg['y1']) / fig.ratio;
    x0 = Math.floor(x0) + 0.5;
    y0 = Math.floor(y0) + 0.5;
    x1 = Math.floor(x1) + 0.5;
    y1 = Math.floor(y1) + 0.5;
    var min_x = Math.min(x0, x1);
    var min_y = Math.min(y0, y1);
    var width = Math.abs(x1 - x0);
    var height = Math.abs(y1 - y0);

    fig.rubberband_context.clearRect(
        0,
        0,
        fig.canvas.width / fig.ratio,
        fig.canvas.height / fig.ratio
    );

    fig.rubberband_context.strokeRect(min_x, min_y, width, height);
};

mpl.figure.prototype.handle_figure_label = function (fig, msg) {
    // Updates the figure title.
    fig.header.textContent = msg['label'];
};

mpl.figure.prototype.handle_cursor = function (fig, msg) {
    fig.rubberband_canvas.style.cursor = msg['cursor'];
};

mpl.figure.prototype.handle_message = function (fig, msg) {
    fig.message.textContent = msg['message'];
};

mpl.figure.prototype.handle_draw = function (fig, _msg) {
    // Request the server to send over a new figure.
    fig.send_draw_message();
};

mpl.figure.prototype.handle_image_mode = function (fig, msg) {
    fig.image_mode = msg['mode'];
};

mpl.figure.prototype.handle_history_buttons = function (fig, msg) {
    for (var key in msg) {
        if (!(key in fig.buttons)) {
            continue;
        }
        fig.buttons[key].disabled = !msg[key];
        fig.buttons[key].setAttribute('aria-disabled', !msg[key]);
    }
};

mpl.figure.prototype.handle_navigate_mode = function (fig, msg) {
    if (msg['mode'] === 'PAN') {
        fig.buttons['Pan'].classList.add('active');
        fig.buttons['Zoom'].classList.remove('active');
    } else if (msg['mode'] === 'ZOOM') {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.add('active');
    } else {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.remove('active');
    }
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Called whenever the canvas gets updated.
    this.send_message('ack', {});
};

// A function to construct a web socket function for onmessage handling.
// Called in the figure constructor.
mpl.figure.prototype._make_on_message_function = function (fig) {
    return function socket_on_message(evt) {
        if (evt.data instanceof Blob) {
            var img = evt.data;
            if (img.type !== 'image/png') {
                /* FIXME: We get "Resource interpreted as Image but
                 * transferred with MIME type text/plain:" errors on
                 * Chrome.  But how to set the MIME type?  It doesn't seem
                 * to be part of the websocket stream */
                img.type = 'image/png';
            }

            /* Free the memory for the previous frames */
            if (fig.imageObj.src) {
                (window.URL || window.webkitURL).revokeObjectURL(
                    fig.imageObj.src
                );
            }

            fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL(
                img
            );
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        } else if (
            typeof evt.data === 'string' &&
            evt.data.slice(0, 21) === 'data:image/png;base64'
        ) {
            fig.imageObj.src = evt.data;
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }

        var msg = JSON.parse(evt.data);
        var msg_type = msg['type'];

        // Call the  "handle_{type}" callback, which takes
        // the figure and JSON message as its only arguments.
        try {
            var callback = fig['handle_' + msg_type];
        } catch (e) {
            console.log(
                "No handler for the '" + msg_type + "' message type: ",
                msg
            );
            return;
        }

        if (callback) {
            try {
                // console.log("Handling '" + msg_type + "' message: ", msg);
                callback(fig, msg);
            } catch (e) {
                console.log(
                    "Exception inside the 'handler_" + msg_type + "' callback:",
                    e,
                    e.stack,
                    msg
                );
            }
        }
    };
};

// from https://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas
mpl.findpos = function (e) {
    //this section is from http://www.quirksmode.org/js/events_properties.html
    var targ;
    if (!e) {
        e = window.event;
    }
    if (e.target) {
        targ = e.target;
    } else if (e.srcElement) {
        targ = e.srcElement;
    }
    if (targ.nodeType === 3) {
        // defeat Safari bug
        targ = targ.parentNode;
    }

    // pageX,Y are the mouse positions relative to the document
    var boundingRect = targ.getBoundingClientRect();
    var x = e.pageX - (boundingRect.left + document.body.scrollLeft);
    var y = e.pageY - (boundingRect.top + document.body.scrollTop);

    return { x: x, y: y };
};

/*
 * return a copy of an object with only non-object keys
 * we need this to avoid circular references
 * https://stackoverflow.com/a/24161582/3208463
 */
function simpleKeys(original) {
    return Object.keys(original).reduce(function (obj, key) {
        if (typeof original[key] !== 'object') {
            obj[key] = original[key];
        }
        return obj;
    }, {});
}

mpl.figure.prototype.mouse_event = function (event, name) {
    var canvas_pos = mpl.findpos(event);

    if (name === 'button_press') {
        this.canvas.focus();
        this.canvas_div.focus();
    }

    var x = canvas_pos.x * this.ratio;
    var y = canvas_pos.y * this.ratio;

    this.send_message(name, {
        x: x,
        y: y,
        button: event.button,
        step: event.step,
        guiEvent: simpleKeys(event),
    });

    /* This prevents the web browser from automatically changing to
     * the text insertion cursor when the button is pressed.  We want
     * to control all of the cursor setting manually through the
     * 'cursor' event from matplotlib */
    event.preventDefault();
    return false;
};

mpl.figure.prototype._key_event_extra = function (_event, _name) {
    // Handle any extra behaviour associated with a key event
};

mpl.figure.prototype.key_event = function (event, name) {
    // Prevent repeat events
    if (name === 'key_press') {
        if (event.key === this._key) {
            return;
        } else {
            this._key = event.key;
        }
    }
    if (name === 'key_release') {
        this._key = null;
    }

    var value = '';
    if (event.ctrlKey && event.key !== 'Control') {
        value += 'ctrl+';
    }
    else if (event.altKey && event.key !== 'Alt') {
        value += 'alt+';
    }
    else if (event.shiftKey && event.key !== 'Shift') {
        value += 'shift+';
    }

    value += 'k' + event.key;

    this._key_event_extra(event, name);

    this.send_message(name, { key: value, guiEvent: simpleKeys(event) });
    return false;
};

mpl.figure.prototype.toolbar_button_onclick = function (name) {
    if (name === 'download') {
        this.handle_save(this, null);
    } else {
        this.send_message('toolbar_button', { name: name });
    }
};

mpl.figure.prototype.toolbar_button_onmouseover = function (tooltip) {
    this.message.textContent = tooltip;
};

///////////////// REMAINING CONTENT GENERATED BY embed_js.py /////////////////
// prettier-ignore
var _JSXTOOLS_RESIZE_OBSERVER=function(A){var t,i=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakMap,o=new Set;function s(e){if(!(this instanceof s))throw new TypeError("Constructor requires 'new' operator");i.set(this,e)}function h(){throw new TypeError("Function is not a constructor")}function c(e,t,i,n){e=0 in arguments?Number(arguments[0]):0,t=1 in arguments?Number(arguments[1]):0,i=2 in arguments?Number(arguments[2]):0,n=3 in arguments?Number(arguments[3]):0,this.right=(this.x=this.left=e)+(this.width=i),this.bottom=(this.y=this.top=t)+(this.height=n),Object.freeze(this)}function d(){t=requestAnimationFrame(d);var s=new WeakMap,p=new Set;o.forEach((function(t){r.get(t).forEach((function(i){var r=t instanceof window.SVGElement,o=a.get(t),d=r?0:parseFloat(o.paddingTop),f=r?0:parseFloat(o.paddingRight),l=r?0:parseFloat(o.paddingBottom),u=r?0:parseFloat(o.paddingLeft),g=r?0:parseFloat(o.borderTopWidth),m=r?0:parseFloat(o.borderRightWidth),w=r?0:parseFloat(o.borderBottomWidth),b=u+f,F=d+l,v=(r?0:parseFloat(o.borderLeftWidth))+m,W=g+w,y=r?0:t.offsetHeight-W-t.clientHeight,E=r?0:t.offsetWidth-v-t.clientWidth,R=b+v,z=F+W,M=r?t.width:parseFloat(o.width)-R-E,O=r?t.height:parseFloat(o.height)-z-y;if(n.has(t)){var k=n.get(t);if(k[0]===M&&k[1]===O)return}n.set(t,[M,O]);var S=Object.create(h.prototype);S.target=t,S.contentRect=new c(u,d,M,O),s.has(i)||(s.set(i,[]),p.add(i)),s.get(i).push(S)}))})),p.forEach((function(e){i.get(e).call(e,s.get(e),e)}))}return s.prototype.observe=function(i){if(i instanceof window.Element){r.has(i)||(r.set(i,new Set),o.add(i),a.set(i,window.getComputedStyle(i)));var n=r.get(i);n.has(this)||n.add(this),cancelAnimationFrame(t),t=requestAnimationFrame(d)}},s.prototype.unobserve=function(i){if(i instanceof window.Element&&r.has(i)){var n=r.get(i);n.has(this)&&(n.delete(this),n.size||(r.delete(i),o.delete(i))),n.size||r.delete(i),o.size||cancelAnimationFrame(t)}},A.DOMRectReadOnly=c,A.ResizeObserver=s,A.ResizeObserverEntry=h,A}; // eslint-disable-line
mpl.toolbar_items = [["Home", "Reset original view", "fa fa-home icon-home", "home"], ["Back", "Back to previous view", "fa fa-arrow-left icon-arrow-left", "back"], ["Forward", "Forward to next view", "fa fa-arrow-right icon-arrow-right", "forward"], ["", "", "", ""], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "fa fa-arrows icon-move", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "fa fa-square-o icon-check-empty", "zoom"], ["", "", "", ""], ["Download", "Download plot", "fa fa-floppy-o icon-save", "download"]];

mpl.extensions = ["eps", "jpeg", "pgf", "pdf", "png", "ps", "raw", "svg", "tif"];

mpl.default_extension = "png";/* global mpl */

var comm_websocket_adapter = function (comm) {
    // Create a "websocket"-like object which calls the given IPython comm
    // object with the appropriate methods. Currently this is a non binary
    // socket, so there is still some room for performance tuning.
    var ws = {};

    ws.binaryType = comm.kernel.ws.binaryType;
    ws.readyState = comm.kernel.ws.readyState;
    function updateReadyState(_event) {
        if (comm.kernel.ws) {
            ws.readyState = comm.kernel.ws.readyState;
        } else {
            ws.readyState = 3; // Closed state.
        }
    }
    comm.kernel.ws.addEventListener('open', updateReadyState);
    comm.kernel.ws.addEventListener('close', updateReadyState);
    comm.kernel.ws.addEventListener('error', updateReadyState);

    ws.close = function () {
        comm.close();
    };
    ws.send = function (m) {
        //console.log('sending', m);
        comm.send(m);
    };
    // Register the callback with on_msg.
    comm.on_msg(function (msg) {
        //console.log('receiving', msg['content']['data'], msg);
        var data = msg['content']['data'];
        if (data['blob'] !== undefined) {
            data = {
                data: new Blob(msg['buffers'], { type: data['blob'] }),
            };
        }
        // Pass the mpl event to the overridden (by mpl) onmessage function.
        ws.onmessage(data);
    });
    return ws;
};

mpl.mpl_figure_comm = function (comm, msg) {
    // This is the function which gets called when the mpl process
    // starts-up an IPython Comm through the "matplotlib" channel.

    var id = msg.content.data.id;
    // Get hold of the div created by the display call when the Comm
    // socket was opened in Python.
    var element = document.getElementById(id);
    var ws_proxy = comm_websocket_adapter(comm);

    function ondownload(figure, _format) {
        window.open(figure.canvas.toDataURL());
    }

    var fig = new mpl.figure(id, ws_proxy, ondownload, element);

    // Call onopen now - mpl needs it, as it is assuming we've passed it a real
    // web socket which is closed, not our websocket->open comm proxy.
    ws_proxy.onopen();

    fig.parent_element = element;
    fig.cell_info = mpl.find_output_cell("<div id='" + id + "'></div>");
    if (!fig.cell_info) {
        console.error('Failed to find cell for figure', id, fig);
        return;
    }
    fig.cell_info[0].output_area.element.on(
        'cleared',
        { fig: fig },
        fig._remove_fig_handler
    );
};

mpl.figure.prototype.handle_close = function (fig, msg) {
    var width = fig.canvas.width / fig.ratio;
    fig.cell_info[0].output_area.element.off(
        'cleared',
        fig._remove_fig_handler
    );
    fig.resizeObserverInstance.unobserve(fig.canvas_div);

    // Update the output cell to use the data from the current canvas.
    fig.push_to_output();
    var dataURL = fig.canvas.toDataURL();
    // Re-enable the keyboard manager in IPython - without this line, in FF,
    // the notebook keyboard shortcuts fail.
    IPython.keyboard_manager.enable();
    fig.parent_element.innerHTML =
        '<img src="' + dataURL + '" width="' + width + '">';
    fig.close_ws(fig, msg);
};

mpl.figure.prototype.close_ws = function (fig, msg) {
    fig.send_message('closing', msg);
    // fig.ws.close()
};

mpl.figure.prototype.push_to_output = function (_remove_interactive) {
    // Turn the data on the canvas into data in the output cell.
    var width = this.canvas.width / this.ratio;
    var dataURL = this.canvas.toDataURL();
    this.cell_info[1]['text/html'] =
        '<img src="' + dataURL + '" width="' + width + '">';
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Tell IPython that the notebook contents must change.
    IPython.notebook.set_dirty(true);
    this.send_message('ack', {});
    var fig = this;
    // Wait a second, then push the new image to the DOM so
    // that it is saved nicely (might be nice to debounce this).
    setTimeout(function () {
        fig.push_to_output();
    }, 1000);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'btn-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'btn-group';
    var button;
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'btn-group';
            continue;
        }

        button = fig.buttons[name] = document.createElement('button');
        button.classList = 'btn btn-default';
        button.href = '#';
        button.title = name;
        button.innerHTML = '<i class="fa ' + image + ' fa-lg"></i>';
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));
        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    // Add the status bar.
    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message pull-right';
    toolbar.appendChild(status_bar);
    this.message = status_bar;

    // Add the close button to the window.
    var buttongrp = document.createElement('div');
    buttongrp.classList = 'btn-group inline pull-right';
    button = document.createElement('button');
    button.classList = 'btn btn-mini btn-primary';
    button.href = '#';
    button.title = 'Stop Interaction';
    button.innerHTML = '<i class="fa fa-power-off icon-remove icon-large"></i>';
    button.addEventListener('click', function (_evt) {
        fig.handle_close(fig, {});
    });
    button.addEventListener(
        'mouseover',
        on_mouseover_closure('Stop Interaction')
    );
    buttongrp.appendChild(button);
    var titlebar = this.root.querySelector('.ui-dialog-titlebar');
    titlebar.insertBefore(buttongrp, titlebar.firstChild);
};

mpl.figure.prototype._remove_fig_handler = function (event) {
    var fig = event.data.fig;
    if (event.target !== this) {
        // Ignore bubbled events from children.
        return;
    }
    fig.close_ws(fig, {});
};

mpl.figure.prototype._root_extra_style = function (el) {
    el.style.boxSizing = 'content-box'; // override notebook setting of border-box.
};

mpl.figure.prototype._canvas_extra_style = function (el) {
    // this is important to make the div 'focusable
    el.setAttribute('tabindex', 0);
    // reach out to IPython and tell the keyboard manager to turn it's self
    // off when our div gets focus

    // location in version 3
    if (IPython.notebook.keyboard_manager) {
        IPython.notebook.keyboard_manager.register_events(el);
    } else {
        // location in version 2
        IPython.keyboard_manager.register_events(el);
    }
};

mpl.figure.prototype._key_event_extra = function (event, _name) {
    // Check for shift+enter
    if (event.shiftKey && event.which === 13) {
        this.canvas_div.blur();
        // select the cell after this one
        var index = IPython.notebook.find_cell_index(this.cell_info[0]);
        IPython.notebook.select(index + 1);
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    fig.ondownload(fig, null);
};

mpl.find_output_cell = function (html_output) {
    // Return the cell and output element which can be found *uniquely* in the notebook.
    // Note - this is a bit hacky, but it is done because the "notebook_saving.Notebook"
    // IPython event is triggered only after the cells have been serialised, which for
    // our purposes (turning an active figure into a static one), is too late.
    var cells = IPython.notebook.get_cells();
    var ncells = cells.length;
    for (var i = 0; i < ncells; i++) {
        var cell = cells[i];
        if (cell.cell_type === 'code') {
            for (var j = 0; j < cell.output_area.outputs.length; j++) {
                var data = cell.output_area.outputs[j];
                if (data.data) {
                    // IPython >= 3 moved mimebundle to data attribute of output
                    data = data.data;
                }
                if (data['text/html'] === html_output) {
                    return [cell, data, j];
                }
            }
        }
    }
};

// Register the function which deals with the matplotlib target/channel.
// The kernel may be null if the page has been refreshed.
if (IPython.notebook.kernel !== null) {
    IPython.notebook.kernel.comm_manager.register_target(
        'matplotlib',
        mpl.mpl_figure_comm
    );
}

</script>
</div>
<div class="cell-output cell-output-display">
<img src="https://vuqv.github.io/posts/python/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAEsCAYAAAA1u0HIAAAAAXNSR0IArs4c6QAAIABJREFUeF7tnQd0VVXa/l9IILQQWkgCoigivYwC0pSmICgOZQRFHfx0GFAYRfoAShWkhBEEBz50AClKE0GaoCKdAZEiKCjSDISSSAudhP969vc/15twb3L2yc295577vGuxIOTss/f+vXvv5+ye6/bt27eFRgIkQAIkQAIkENQEclHQg9p/TDwJkAAJkAAJKAIUdBYEEiABEiABEnAAAQq6A5zILJAACZAACZAABZ1lgARIgARIgAQcQICC7gAnMgskQAIkQAIkQEFnGSABEiABEiABBxCgoDvAicwCCZAACZAACVDQWQZIgARIgARIwAEEKOgOcCKzQAIkQAIkQAIUdJYBEiABEiABEnAAAQq6A5zILJAACZAACZAABZ1lgARIgARIgAQcQICC7gAnMgskQAIkQAIkQEFnGSABEiABEiABBxCgoDvAicwCCZAACZAACVDQWQZIgARIgARIwAEEKOgOcCKzQAIkQAIkQAIUdJYBEiABEiABEnAAAQq6A5zILJAACZAACZAABZ1lgARIgARIgAQcQICC7gAnMgskQAIkQAIkQEFnGSABEiABEiABBxCgoDvAicwCCZAACZAACVDQWQZIgARIgARIwAEEKOgOcCKzQAIkQAIkQAIUdJYBEiABEiABEnAAAQq6A5zILJAACZAACZAABZ1lgARIgARIgAQcQICC7gAnMgskQAIkQAIkQEFnGSABEiABEiABBxCgoDvAicwCCZAACZAACVDQWQZIgARIgARIwAEEKOgOcCKzQAIkQAIkQAIUdJYBEiABEiABEnAAgYAL+pUrVyQyMlLS0tLS4YyIiJBr166p/zt48KD06tVLNm3aJOHh4dKmTRuJj4+XIkWKWHZBrVq15NSpUxIbGyvfffed5fcwIAmQAAmQAAnYgUDABX3btm1Sr149+eSTT6Rs2bIuJrlz55Y6derI+fPnpWrVqlKqVCkZPHiwnD59Wvr16ye1a9eWNWvWWGZ41113yYkTJ6R06dKSkJBg+T0MSAIkQAIkQAJ2IBBwQZ86daq88cYbkpKSInny5LmDyejRo2XkyJFy9OhRiY6OVr9ftWqVtGrVSjZu3CgNGza0xJGCbgkbA5EACZAACdiUQMAFvVu3bvLf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" width="500">
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>Text(0, 0.5, 'Percent of folded trajs')</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>Python</category>
  <category>Visualization</category>
  <guid>https://vuqv.github.io/posts/python/Beautiful-plot-with-Matplotlib.html</guid>
  <pubDate>Sat, 24 Dec 2022 00:00:00 GMT</pubDate>
  <media:content url="https://vuqv.github.io/posts/python/Demo_matplotlib.png" medium="image" type="image/png" height="90" width="144"/>
</item>
<item>
  <title>Problems regarding ipywidgets has no attribute ‘version_info’</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/python/Problems-regarding-ipywidgets.html</link>
  <description><![CDATA[ 





<p>With the recent update of <code>ipywidgets</code>, Pyemma, MDAnalysis and some other package encounter problems with <code>ipywidgets</code>.</p>
<p>The dirty solution is install version <code>ipywidgets&lt;8</code>. version 7.7 may help and wait till developers of <code>ipywidgets</code> fix it.</p>



 ]]></description>
  <category>Python</category>
  <guid>https://vuqv.github.io/posts/python/Problems-regarding-ipywidgets.html</guid>
  <pubDate>Sun, 11 Dec 2022 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Some Linux commands frequently used</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/linux-tips/linux_tips.html</link>
  <description><![CDATA[ 





<p>This post contains some <code>bash</code> code-snippet to make my daily work easier.</p>
<section id="loop-through-array" class="level1">
<h1>Loop through array</h1>
<p>In case of looping through an continous list of number:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash numberLines lineAnchors code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DO SOMETHING</span></span>
<span id="cb1-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<p>If the list to loop is not continous, used the following form:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash numberLines lineAnchors code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb2-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">arr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span> 3 4 9 10<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${arr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb2-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span>       </span>
<span id="cb2-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#DONE SOMETHING HERE</span></span>
<span id="cb2-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<p>Note that <code>arr</code> definition is without whitespace.</p>
</section>
<section id="counting-number-of-lines-in-file" class="level1">
<h1>Counting number of lines in file</h1>
<p>Sometime, after perform a long analysis of many simulations. We want to make sure if the analysis is done automatically, instead of looking into single file one-by-one, we can use <code>bash</code> script to do so.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash numberLines lineAnchors code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb3-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-4">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#echo "$i"</span></span>
<span id="cb3-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nl</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span>/G_traj_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${i}</span>.dat<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$nl</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-eq</span> 400008 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-7">                <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"traj </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> :  </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$nl</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> --- DONE"</span></span>
<span id="cb3-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb3-9">                <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"traj </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> :  </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$nl</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> --- Has not been DONE"</span></span>
<span id="cb3-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<p>In this example, we loop through all simulations (1 to 100) and use command: <code>wc -l &lt; $i/G_traj_${i}.dat</code> to count the number of lines in file. we assign the output from this command to <code>nl</code> variable by packing previous command by <code>$(command)</code></p>
</section>
<section id="search-and-replace-in-file" class="level1">
<h1>Search and replace in file</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash numberLines lineAnchors code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb4-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cur_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span></span>
<span id="cb4-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">..</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb4-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb4-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/net/people/plgqvuvan/plggligroup/qvuvan/10proj/synthesize/cat3/wt/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/traj/1/prot_l213_dissociation_final.cor"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb4-6">                <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"copy cor and vel file for run </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-7">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-rf</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span></span>
<span id="cb4-8">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> /net/people/plgqvuvan/plggligroup/qvuvan/10proj/synthesize/cat3/wt/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span>/traj/1/prot_l213_dissociation_final.cor <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span>/</span>
<span id="cb4-9">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> /net/people/plgqvuvan/plggligroup/qvuvan/10proj/synthesize/cat3/wt/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span>/traj/1/prot_l213_dissociation_final.vel <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span>/</span>
<span id="cb4-10">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> template/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span>/</span>
<span id="cb4-11">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s/SETINDEX/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${i}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/g"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${i}</span>/job_plgrid_gpu.sh</span>
<span id="cb4-12">                <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s/SETINDEX/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${i}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/g"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${i}</span>/control.cntrl</span>
<span id="cb4-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb4-14">                <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"simulation </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$i</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> is not finished"</span></span>
<span id="cb4-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb4-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<ul>
<li>line 5: check if file <code>prot_l213_dissociation_final.cor</code> in specified directory existed. If yes, then run the code block.</li>
<li>line 11-12: <code>sed</code> command used to search and replace pattern <code>SETINDEX</code> in file <code>${i}/job_plgrid_gpu.sh</code> by value of variable <code>$i</code></li>
</ul>
</section>
<section id="sync-data-between-local-and-cluster-computer" class="level1">
<h1>Sync data between local and cluster computer</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash numberLines lineAnchors code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rsync</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-avzhP</span> plgqvuvan@pro.cyfronet.pl:/net/people/plgqvuvan/plggligroup/qvuvan/10proj/post_trans/cat3/stride_by5/combine_trajs/ post_trans/</span></code></pre></div>
<p>The above command sync the data from cluster pro.cyfronet.pl to local computer. To exclude files (e.g xtc file), add this: –exclude=*.xtc</p>
</section>
<section id="install-package-on-roar-cluster-without-root-permission" class="level1">
<h1>Install package on Roar cluster without Root permission</h1>
<p>Roar cluster runs RedHat Linux version 8.9</p>
<p>To install rpm file without root permission: <code>rpm2cpio the_file_name.rpm | cpio -idv</code></p>
<p>Example on install ATOM Code editor:</p>
<pre><code>1. `rpm2cpio atom.x86_64.rpm | cpio -idv`
This will extract rpm file to folder name ./usr . Move this folder to desired folder, e.g ~/programs:
2. `mv usr ~/programs/Atom`
3. Create Desktop link to application:
    Go to ~/.local/share/applications/
    create a desktop file: `Atom.desktop` with content:
    ```
    [Desktop Entry]
    Name=Atom Editor
    Comment=Code Editing. Redefined.
    GenericName=Text Editor
    Exec=/storage/home/qzv5006/programs/Atom/bin/atom %F
    Icon=/storage/home/qzv5006/programs/Atom/share/icons/hicolor/32x32/apps/atom.png
    Type=Application
    StartupNotify=false
    StartupWMClass=Code
    Categories=TextEditor;Development;IDE;
    MimeType=application/x-code-workspace;
    Actions=new-empty-window;
    Keywords=vscode;
    
    [Desktop Action new-empty-window]
    Name=New Empty Window
    Name[de]=Neues leeres Fenster
    Name[es]=Nueva ventana vacÃ­a
    Name[fr]=Nouvelle fenÃªtre vide
    Name[it]=Nuova finestra vuota
    Name[ja]=\u65b0\u3057\u3044\u7a7a\u306e\u30a6\u30a3\u30f3\u30c9\u30a6
    Name[ko]=\uc0c8 \ube48 \ucc3d
    Name[ru]=\u041d\u043e\u0432\u043e\u0435 \u043f\u0443\u0441\u0442\u043e\u0435 \u043e\u043a\u043d\u043e
    Name[zh_CN]=\u65b0\u5efa\u7a7a\u7a97\u53e3
    Name[zh_TW]=\u958b\u65b0\u7a7a\u8996\u7a97
    Exec=/storage/home/qzv5006/programs/Atom/bin/atom --new-window %F
    Icon=/storage/home/qzv5006/programs/Atom/share/icons/hicolor/32x32/apps/atom.png
    ```
4. Give executable permission for Desktop file: `chmod +x Atom.desktop`</code></pre>
<div id="7b660e76a67111d9" class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"></code></pre></div>
</div>


</section>

 ]]></description>
  <category>Linux</category>
  <guid>https://vuqv.github.io/posts/linux-tips/linux_tips.html</guid>
  <pubDate>Fri, 09 Dec 2022 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Openmm Coarse-grained Simulations</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/Create-env-for-openmm-cg-simulations/Openmm-coarse-grained-simulations.html</link>
  <description><![CDATA[ 





<section id="ares-supercomputer" class="level1">
<h1>Ares supercomputer</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition plgrid</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name cryosparc-master</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes 1</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --ntasks-per-node 1</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem 15GB</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time 72:00:00</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -C localfs</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -A plgrisa-cpu</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --dependency=singleton</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --output cryosparc-master-log-%J.txt</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --signal=B:2@240</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Job run"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> test.txt</span></code></pre></div>
</section>
<section id="prepare-environment-for-simulations" class="level1">
<h1>Prepare environment for simulations</h1>
<section id="install-packages" class="level2">
<h2 class="anchored" data-anchor-id="install-packages">Install packages</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> openmm=7.7 parmed mdtraj</span></code></pre></div>
<p>Notes on cluster information:</p>
<pre><code>* local machine: (py310) openMM 7.7+ cudatoolkit 11.6
* Plgrid: (py310) openMM 7.7+ cudatoolkit 10.2
* ACI: (base) OpenMM 7.7+ cudatoolkit 11.7
* Ares: openMM 7.7 + cudatoolkit 11.6 ( GPU Tesla V100)</code></pre>
<section id="job-with-gpu" class="level3">
<h3 class="anchored" data-anchor-id="job-with-gpu">Job with GPU</h3>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name ares_gpu</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes 1</span></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition plgrid-gpu-v100</span></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --gres=gpu:1</span></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --ntasks-per-node 1</span></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem 15GB</span></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time 48:00:00</span></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -C localfs</span></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -A plgrisa-gpu</span></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --dependency=singleton</span></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --output cryosparc-master-log-%J.txt</span></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --signal=B:2@240</span></span>
<span id="cb4-14"></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## prometheus</span></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#source /net/people/plgqvuvan/anaconda3/etc/profile.d/conda.sh</span></span>
<span id="cb4-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## ares</span></span>
<span id="cb4-18"></span>
<span id="cb4-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_SUBMIT_DIR</span></span>
<span id="cb4-20"></span>
<span id="cb4-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> init bash</span>
<span id="cb4-22"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> /net/people/plgrid/plgqvuvan/plggligroup/qvv5013/anaconda3/etc/profile.d/conda.sh</span>
<span id="cb4-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate py310</span>
<span id="cb4-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> add cuda/11.6.0</span>
<span id="cb4-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NVIDIA-DRIVER version:"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">nvidia-smi</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span></span>
<span id="cb4-26"></span>
<span id="cb4-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> single_run_extend.py <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> control.cntrl</span></code></pre></div>
</section>
</section>
<section id="interactive-mode-on-ares" class="level2">
<h2 class="anchored" data-anchor-id="interactive-mode-on-ares">interactive mode on ares:</h2>
<ul>
<li>using GPU: <code>srun -p plgrid-gpu-v100 --nodes=1 --ntasks=1 --mem=5GB --time=0-1 --pty bash</code></li>
<li>using CPU: <code>srun -p plgrid --nodes=1 --ntasks=1 --mem=5GB --time=0-1 --pty bash</code></li>
</ul>


</section>
</section>

 ]]></description>
  <category>HPC</category>
  <category>Slurm</category>
  <category>OpenMM</category>
  <guid>https://vuqv.github.io/posts/Create-env-for-openmm-cg-simulations/Openmm-coarse-grained-simulations.html</guid>
  <pubDate>Fri, 09 Dec 2022 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Slurm scripts and commands to submit jobs on clusters</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/Running-jobs-on-clusters/running-jobs-on-cluster.html</link>
  <description><![CDATA[ 





<section id="ares-supercomputer" class="level1">
<h1>Ares supercomputer</h1>
<section id="cpu-job-script" class="level4">
<h4 class="anchored" data-anchor-id="cpu-job-script">CPU job script</h4>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash numberLines lineAnchors code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition plgrid</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name cryosparc-master</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes 1</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --ntasks-per-node 1</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem 15GB</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time 72:00:00</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -C localfs</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -A plgrisa-cpu</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --dependency=singleton</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --output cryosparc-master-log-%J.txt</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --signal=B:2@240</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Job run"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> test.txt</span></code></pre></div>
</section>
<section id="gpu-job-script" class="level4">
<h4 class="anchored" data-anchor-id="gpu-job-script">GPU Job script</h4>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash numberLines lineAnchors code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name ispe_0</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes 1</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition plgrid-gpu-v100</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --gres=gpu:1</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --ntasks-per-node 1</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem 15GB</span></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time 48:00:00</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -C localfs</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -A plgrisa-gpu</span></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --dependency=singleton</span></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --output=output.out</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --error=error.err</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --signal=B:2@240</span></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## ares</span></span>
<span id="cb2-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> init bash</span>
<span id="cb2-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> /net/people/plgrid/plgqvuvan/plggligroup/qvv5013/anaconda3/etc/profile.d/conda.sh</span>
<span id="cb2-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate py310</span>
<span id="cb2-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_SUBMIT_DIR</span></span>
<span id="cb2-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pwd</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">`</span></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb2-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> single_run.py <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> control.cntrl</span></code></pre></div>
</section>
<section id="interactive-mode-on-ares" class="level2">
<h2 class="anchored" data-anchor-id="interactive-mode-on-ares">Interactive mode on Ares</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">srun</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> plgrid <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-N</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ntasks-per-node</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>8 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 8 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--time</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0-8 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> plgrisa-cpu <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--pty</span> /bin/bash <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span></span></code></pre></div>
<p>To request for 1 node (-N 1), 8 threads and 8hrs</p>
</section>
</section>
<section id="prometheus-supercomputer" class="level1">
<h1>Prometheus supercomputer</h1>
<section id="cpu-job" class="level4">
<h4 class="anchored" data-anchor-id="cpu-job">CPU job</h4>
</section>
<section id="gpu-job-scripts" class="level4">
<h4 class="anchored" data-anchor-id="gpu-job-scripts">GPU job scripts</h4>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash numberLines lineAnchors code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash -l</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -J pGcat_SETINDEX</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -N 1</span></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --ntasks-per-node=1</span></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem-per-cpu=5GB</span></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=72:00:00</span></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -A plgribo3gpu</span></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --gres=gpu</span></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH -p plgrid-gpu</span></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --output=output.out</span></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --error=error.err</span></span>
<span id="cb4-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_SUBMIT_DIR</span></span>
<span id="cb4-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">srun</span> /bin/hostname</span>
<span id="cb4-14"></span>
<span id="cb4-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">perl</span> calc_entanglement_number.pl <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> ../../setup/3cla_m_clean_ca.cor <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> ../../SETINDEX/cat3_SETINDEX_prod.dcd <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ./</span></code></pre></div>


</section>
</section>

 ]]></description>
  <category>HPC</category>
  <category>Slurm</category>
  <guid>https://vuqv.github.io/posts/Running-jobs-on-clusters/running-jobs-on-cluster.html</guid>
  <pubDate>Sat, 26 Nov 2022 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Amino acid table</title>
  <dc:creator>Quyen Vu</dc:creator>
  <link>https://vuqv.github.io/posts/Amino-acid-table/</link>
  <description><![CDATA[ 





<section id="amino-acids-table-with-their-properties" class="level1">
<h1>Amino acids table with their properties</h1>
<p>21 amino acids make up proteins.</p>
<p><img src="https://vuqv.github.io/posts/Amino-acid-table/ProteinogenicAminoAcids.svg.png" class="img-fluid" alt="List of 20 amino acids and classification according to side-chain"></p>
<p>(Source: <a href="https://en.wikipedia.org/wiki/Amino_acid">Wikipedia</a>)</p>


</section>

 ]]></description>
  <category>Protein</category>
  <guid>https://vuqv.github.io/posts/Amino-acid-table/</guid>
  <pubDate>Fri, 25 Nov 2022 00:00:00 GMT</pubDate>
  <media:content url="https://vuqv.github.io/posts/Amino-acid-table/ProteinogenicAminoAcids.svg.png" medium="image" type="image/png" height="115" width="144"/>
</item>
</channel>
</rss>
